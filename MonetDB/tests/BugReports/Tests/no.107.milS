setoid(oid(20000000));

# [t_i, n_i]
w.histogram.print;

#split w in twee tabellen
docid := new( void, oid );
tid := new( void, str );
docid.insert( [w~].reverse );
docid.print;
tid.insert( [~w] );
tid.print;

docid.seqbase( 1000@0 );
docid.print;
tid.seqbase( 1000@0 );
tid.print;
tid.reverse.print;
tidx:=tid.copy;
tidx.print;
tidy:=([oid](tid)).copy;
tidy.print;
print( docid, tid );

module( "xtables" );
CTgroup( docid, tid ).print;

# t_i, tf_ij
join( tidx.reverse, CTgroup( docid, tid ).histogram).print;
join( tidy.reverse, CTgroup( docid, tid ).histogram).print;
join( tid.reverse, CTgroup( docid, tid ).histogram).print;
# d_j, max tf_j
djtfij := new( oid, int );
djtfij.insert( join( docid.reverse, CTgroup( docid, tid ).histogram ) );

{max}(djtfij).print;

# This way it works. However, if I do not do an explicit new and insert,
# then the server crashes as follows:

djtfijx :=join( docid.reverse, CTgroup( docid, tid ).histogram );
{max}(djtfijx).print;
quit;
