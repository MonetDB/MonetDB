%define name MonetDB-java
%define version @VERSION@
%define release 1

# buildsystem is set to 1 when building an rpm from within the build
# directory; it should be set to 0 (or not set) when building a proper
# rpm
%{!?buildsystem: %define buildsystem 0}

Name: %{name}
Version: %{version}
Release: %{release}
Summary: MonetDB - Monet Database Management System - Java interface

Group: Applications/Databases
License: MPL - http://monetdb.cwi.nl/Legal/MonetDBLicense-1.1.html
URL: http://monetdb.cwi.nl/
Source: http://downloads.sourceforge.net/monetdb/MonetDB-java-%{version}.tar.gz
BuildRoot: %(mktemp -ud %{_tmppath}/%{name}-%{version}-%{release}-XXXXXX)
BuildArch: noarch

Requires: java
%if !%{?buildsystem}
BuildRequires: ant, java
%endif


%package devel
Summary: MonetDB Java development package
Group: Applications/Databases
Requires: %{name} = %{version}-%{release}
Requires: ant, java


%description
MonetDB is a database management system that is developed from a
main-memory perspective with use of a fully decomposed storage model,
automatic index management, extensibility of data types and search
accelerators, SQL- and XML- frontends.

This package contains the JDBC driver and mjclient, a client program
written in Java that uses the JDBC driver to communicate with the
database server.

This package also cotains the XRPC Wrapper, with which one can run
 distributed XQuery queries on different XQuery processing engine.
The XRPC Wrapper comes with three Java Archives
- xrpcapi.jar: the XRPC Java API, which includes functions for
  -- creating XRPC request messages,
  -- parsing XRPC response messages, 
  -- send and/or receive XRPC messages using HTTP connection, and
  -- XRPC specific exception classes
- xrpcwrapper.jar: the XRPC Wrapper, which is a stand-alone program that
  can be plugged in on top of an XQuery engine to handle non-nested XRPC
  requests (i.e. requests that do not trigger another XRPC request).
- xrpcclient.jar: an example client program, which (i) can be used to
  test the XRPC Wrapper, and (ii) shows how to write an XRPC Java
  client.


%description devel
MonetDB is a database management system that is developed from a
main-memory perspective with use of a fully decomposed storage model,
automatic index management, extensibility of data types and search
accelerators, SQL- and XML- frontends.

This package contains the files needed to develop with
MonetDB-java.


%prep
rm -rf $RPM_BUILD_ROOT

%setup -q -n MonetDB-java-%{version}

%build

%configure

make

%install
rm -rf $RPM_BUILD_ROOT

make install DESTDIR=$RPM_BUILD_ROOT

# cleanup stuff we don't want to install
rm -rf $RPM_BUILD_ROOT%{_datadir}/MonetDB/Tests
find $RPM_BUILD_ROOT -name .incs.in -print -o -name \*.la -print | xargs rm -f

%clean
rm -fr $RPM_BUILD_ROOT


%files
%defattr(-,root,root)
%{_bindir}/mjclient
%dir %{_datadir}/MonetDB/lib
%{_datadir}/MonetDB/lib/*jar

%files devel
%defattr(-,root,root)
%{_bindir}/monetdb-java-config


%changelog
* Mon Jun 25 2007 Sjoerd Mullender <sjoerd@acm.org> - @VERSION@-1
- Built.

