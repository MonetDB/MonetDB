# what is the overhead of MAL in multiplex situations
b:= bat.new(:oid,:int);
c:= bat.new(:oid,:int);
t0:= alarm.usec();
barrier (v,i):= language.newRange(0:int);
	o:= calc.oid(i);
	r:= mmath.rand();
	rl:= calc.int(r);
	il:= mmath.rand();
	bat.insert(b,o,il);
	bat.insert(c,o,rl);
	redo (v,i):= language.nextElement(1:int,10000000:int);
exit (v,i);
t1:= alarm.usec();
t2:= alarm.usec();
b:= algebra.select(b,nil:int,rl);
c:= algebra.select(c,nil:int,il);
x:= algebra.subjoin(b,c);
t3:= alarm.usec();
b:= algebra.select(b,nil:int,rl);
c:= algebra.select(c,nil:int,il);
y:= algebra.subjoin(b,c);
t4:= alarm.usec();
d1:= t2-t0;
d2:= t3-t2;
d3:= t4-t3;
io.printf("make tables %d \n",d1);
io.printf("join 10Mx10M %d\n",d2);
io.printf("join 10Mx10M %d\n",d3);
