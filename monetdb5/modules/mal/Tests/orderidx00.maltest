statement ok
include orderidx

statement ok
bv:= bat.new(:int)

statement ok
bat.append(bv,959217167 )

statement ok
bat.append(bv,1920220901 )

statement ok
bat.append(bv,1303856962 )

statement ok
bat.append(bv,1667896496 )

statement ok
bat.append(bv,1080090866 )

statement ok
bat.append(bv,527076325 )

statement ok
bat.append(bv,266430612 )

statement ok
bat.append(bv,1674978691 )

statement ok
bat.append(bv,1863672321 )

statement ok
bat.append(bv,58690783 )

query TI rowsort
io.print(bv)
----
20 values hashing to ce33b451dc3107b0a14802a72c02a204

statement ok
bat.orderidx(bv,3)

statement ok
ord := bat.getorderidx(bv)

query TT rowsort
io.print(ord)
----
20 values hashing to e2172d93610a6a03dcf6b767f3a34371

statement ok
seq := algebra.projection(ord,bv)

query TI rowsort
io.print(seq)
----
20 values hashing to ce33b451dc3107b0a14802a72c02a204

statement ok
(k,l):= algebra.sort(bv,0:bit,0:bit,1:bit)

query TIT rowsort
io.print(k,l)
----
30 values hashing to 77437592cd7c3ad93f5d9c0f4c4ffe1d

