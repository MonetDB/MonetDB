# Calendar compressions


d:= bat.new(:date);
bat.append(d,"2014-08-14":date);
bat.append(d,"2014-08-14":date);
bat.append(d,"2014-08-14":date);
bat.append(d,"2014-08-14":date);
bat.append(d,"2014-08-15":date);
bat.append(d,"2015-07-11":date);
bat.append(d,"2015-07-12":date);
bat.append(d,"2016-12-31":date);
d:= bat.append(d,d);

io.print(d);
mosaic.compress(d,"calendar");
#mosaic.dump(xd);
mosaic.decompress(d);
io.print(d);

bs:= bat.new(:timestamp);
bat.append(bs,"2014-08-14 12:00:00":timestamp);
bat.append(bs,"2014-08-14 12:00:00":timestamp);
bat.append(bs,"2014-08-14 12:00:00":timestamp);
bat.append(bs,"2014-08-14 12:00:00":timestamp);
bat.append(bs,"2014-08-14 12:00:00":timestamp);
bat.append(bs,"2014-08-14 12:01:00":timestamp);
bat.append(bs,"2014-08-14 12:02:00":timestamp);
bs:= bat.append(bs,bs);

io.print(bs);
mosaic.compress(bs,"calendar");
#mosaic.dump(bs);
mosaic.decompress(bs);
io.print(bs);
