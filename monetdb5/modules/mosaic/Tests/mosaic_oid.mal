a:= bat.new(:oid);
bat.append(a,1000:oid);
bat.append(a,1001:oid);
bat.append(a,999:oid);
bat.append(a,1002:oid);
bat.append(a,998:oid);
bat.append(a,1010:oid);
bat.append(a,990:oid);
bat.append(a,995:oid);
bat.append(a,1005:oid);
bat.append(a,1002:oid);
bat.append(a,1000:oid);
bat.append(a,1001:oid);
bat.append(a,999:oid);
bat.append(a,1002:oid);
bat.append(a,18446744073709551610:oid);
bat.append(a,1000:oid);
bat.append(a,1000:oid);
bat.append(a,1000:oid);
bat.append(a,1000:oid);
bat.append(a,1001:oid);
bat.append(a,1001:oid);
bat.append(a,1001:oid);
bat.append(a,1001:oid);
bat.append(a,1002:oid);
bat.append(a,1002:oid);
bat.append(a,1002:oid);
bat.append(a,1002:oid);
bat.append(a,998:oid);
bat.append(a,998:oid);
bat.append(a,998:oid);
bat.append(a,998:oid);
bat.append(a,999:oid);
bat.append(a,999:oid);
bat.append(a,999:oid);
bat.append(a,999:oid);
bat.append(a,1002:oid);
bat.append(a,1002:oid);
bat.append(a,1002:oid);
bat.append(a,1002:oid);
bat.append(a,1010:oid);
bat.append(a,1010:oid);
bat.append(a,1010:oid);
bat.append(a,1010:oid);
bat.append(a,990:oid);
bat.append(a,990:oid);
bat.append(a,990:oid);
bat.append(a,990:oid);
bat.append(a,995:oid);
bat.append(a,995:oid);
bat.append(a,995:oid);
bat.append(a,995:oid);
bat.append(a,1005:oid);
bat.append(a,1005:oid);
bat.append(a,1005:oid);
bat.append(a,1005:oid);
bat.append(a,18446744073709551610:oid);
bat.append(a,998:oid);
bat.append(a,1010:oid);
bat.append(a,990:oid);
bat.append(a,995:oid);
bat.append(a,1005:oid);
bat.append(a,1002:oid);
bat.append(a,1000:oid);
bat.append(a,1001:oid);
bat.append(a,999:oid);
bat.append(a,1002:oid);
bat.append(a,998:oid);
bat.append(a,1010:oid);
bat.append(a,990:oid);
bat.append(a,995:oid);
bat.append(a,1005:oid);
bat.append(a,1002:oid);
mosaic.compress(a,"{compression_type}");
c:= mosaic.decompress(a);
eq  := batcalc.==(a,  c, true:bit);
io.print(a, c, eq);

sa:= algebra.select(a,nil:oid, nil:oid,false,false,false);
sc:= mosaic.select (c,nil:oid, nil:oid,false,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,nil:oid, nil:oid,false,false,true);
sc:= mosaic.select (c,nil:oid, nil:oid,false,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,1000:oid, nil:oid,false,false,false);
sc:= mosaic.select (c,1000:oid, nil:oid,false,false,false);
tsa:= algebra.thetaselect(a,1000:oid, ">");
tsc:= mosaic.thetaselect (c,1000:oid, ">");
eq1  := batcalc.==(sa,  sc);
eq2  := batcalc.==(tsa, tsc);
eq3  := batcalc.==(sc, tsc);
io.print(sa, sc, tsa, tsc, eq1, eq2, eq3);

sa:= algebra.select(a,nil:oid, 1000:oid,false,false,false);
sc:= mosaic.select (c,nil:oid, 1000:oid,false,false,false);
tsa:= algebra.thetaselect(a,1000:oid, "<");
tsc:= mosaic.thetaselect (c,1000:oid, "<");
eq1  := batcalc.==(sa,  sc);
eq2  := batcalc.==(tsa, tsc);
eq3  := batcalc.==(sc, tsc);
io.print(sa, sc, tsa, tsc, eq1, eq2, eq3);

sa:= algebra.select(a,900:oid, nil:oid,false,false,false);
sc:= mosaic.select (c,900:oid, nil:oid,false,false,false);
tsa:= algebra.thetaselect(a,900:oid, ">");
tsc:= mosaic.thetaselect (c,900:oid, ">");
eq1  := batcalc.==(sa,  sc);
eq2  := batcalc.==(tsa, tsc);
eq3  := batcalc.==(sc, tsc);
io.print(sa, sc, tsa, tsc, eq1, eq2, eq3);

sa:= algebra.select(a,nil:oid, 900:oid,false,false,false);
sc:= mosaic.select (c,nil:oid, 900:oid,false,false,false);
tsa:= algebra.thetaselect(a,900:oid, "<");
tsc:= mosaic.thetaselect (c,900:oid, "<");
eq1  := batcalc.==(sa,  sc);
eq2  := batcalc.==(tsa, tsc);
eq3  := batcalc.==(sc, tsc);
io.print(sa, sc, tsa, tsc, eq1, eq2, eq3);

sa:= algebra.select(a,900:oid, nil:oid,true,false,false);
sc:= mosaic.select (c,900:oid, nil:oid,true,false,false);
tsa:= algebra.thetaselect(a,900:oid, ">=");
tsc:= mosaic.thetaselect (c,900:oid, ">=");
eq1  := batcalc.==(sa,  sc);
eq2  := batcalc.==(tsa, tsc);
eq3  := batcalc.==(sc, tsc);
io.print(sa, sc, tsa, tsc, eq1, eq2, eq3);

sa:= algebra.select(a,nil:oid, 900:oid,false,true,false);
sc:= mosaic.select (c,nil:oid, 900:oid,false,true,false);
tsa:= algebra.thetaselect(a,900:oid, "<=");
tsc:= mosaic.thetaselect (c,900:oid, "<=");
eq1  := batcalc.==(sa,  sc);
eq2  := batcalc.==(tsa, tsc);
eq3  := batcalc.==(sc, tsc);
io.print(sa, sc, tsa, tsc, eq1, eq2, eq3);

sa:= algebra.select(a,1000:oid, nil:oid,true,false,false);
sc:= mosaic.select (c,1000:oid, nil:oid,true,false,false);
tsa:= algebra.thetaselect(a,1000:oid, ">=");
tsc:= mosaic.thetaselect (c,1000:oid, ">=");
eq1  := batcalc.==(sa,  sc);
eq2  := batcalc.==(tsa, tsc);
eq3  := batcalc.==(sc, tsc);
io.print(sa, sc, tsa, tsc, eq1, eq2, eq3);

sa:= algebra.select(a,nil:oid, 1000:oid,false,true,false);
sc:= mosaic.select (c,nil:oid, 1000:oid,false,true,false);
tsa:= algebra.thetaselect(a,1000:oid, "<=");
tsc:= mosaic.thetaselect (c,1000:oid, "<=");
eq1  := batcalc.==(sa,  sc);
eq2  := batcalc.==(tsa, tsc);
eq3  := batcalc.==(sc, tsc);
io.print(sa, sc, tsa, tsc, eq1, eq2, eq3);

sa:= algebra.select(a,1000:oid, 1000:oid,true,true,false);
sc:= mosaic.select (c,1000:oid, 1000:oid,true,true,false);
tsa:= algebra.thetaselect(a,1000:oid, "==");
tsc:= mosaic.thetaselect (c,1000:oid, "==");
eq1  := batcalc.==(sa,  sc);
eq2  := batcalc.==(tsa, tsc);
eq3  := batcalc.==(sc, tsc);
io.print(sa, sc, tsa, tsc, eq1, eq2, eq3);

sa:= algebra.select(a,1000:oid, 1000:oid,true,true,true);
sc:= mosaic.select (c,1000:oid, 1000:oid,true,true,true);
tsa:= algebra.thetaselect(a,1000:oid, "!=");
tsc:= mosaic.thetaselect (c,1000:oid, "!=");
eq1  := batcalc.==(sa,  sc);
eq2  := batcalc.==(tsa, tsc);
eq3  := batcalc.==(sc, tsc);
io.print(sa, sc, tsa, tsc, eq1, eq2, eq3);


sa:= algebra.select(a,1003:oid, 1003:oid,true,true,false);
sc:= mosaic.select (c,1003:oid, 1003:oid,true,true,false);
tsa:= algebra.thetaselect(a,1003:oid, "==");
tsc:= mosaic.thetaselect (c,1003:oid, "==");
eq1  := batcalc.==(sa,  sc);
eq2  := batcalc.==(tsa, tsc);
eq3  := batcalc.==(sc, tsc);
io.print(sa, sc, tsa, tsc, eq1, eq2, eq3);

sa:= algebra.select(a,1003:oid, 1003:oid,true,true,true);
sc:= mosaic.select (c,1003:oid, 1003:oid,true,true,true);
tsa:= algebra.thetaselect(a,1003:oid, "!=");
tsc:= mosaic.thetaselect (c,1003:oid, "!=");
eq1  := batcalc.==(sa,  sc);
eq2  := batcalc.==(tsa, tsc);
eq3  := batcalc.==(sc, tsc);
io.print(sa, sc, tsa, tsc, eq1, eq2, eq3);

sa:= algebra.select(a,900:oid, 900:oid,true,true,false);
sc:= mosaic.select (c,900:oid, 900:oid,true,true,false);
tsa:= algebra.thetaselect(a,900:oid, "==");
tsc:= mosaic.thetaselect (c,900:oid, "==");
eq1  := batcalc.==(sa,  sc);
eq2  := batcalc.==(tsa, tsc);
eq3  := batcalc.==(sc, tsc);
io.print(sa, sc, tsa, tsc, eq1, eq2, eq3);

sa:= algebra.select(a,900:oid, 900:oid,true,true,true);
sc:= mosaic.select (c,900:oid, 900:oid,true,true,true);
tsa:= algebra.thetaselect(a,900:oid, "!=");
tsc:= mosaic.thetaselect (c,900:oid, "!=");
eq1  := batcalc.==(sa,  sc);
eq2  := batcalc.==(tsa, tsc);
eq3  := batcalc.==(sc, tsc);
io.print(sa, sc, tsa, tsc, eq1, eq2, eq3);

sa:= algebra.select(a,1100:oid, 1100:oid,true,true,false);
sc:= mosaic.select (c,1100:oid, 1100:oid,true,true,false);
tsa:= algebra.thetaselect(a,1100:oid, "==");
tsc:= mosaic.thetaselect (c,1100:oid, "==");
eq1  := batcalc.==(sa,  sc);
eq2  := batcalc.==(tsa, tsc);
eq3  := batcalc.==(sc, tsc);
io.print(sa, sc, tsa, tsc, eq1, eq2, eq3);

sa:= algebra.select(a,1100:oid, 1100:oid,true,true,true);
sc:= mosaic.select (c,1100:oid, 1100:oid,true,true,true);
tsa:= algebra.thetaselect(a,1100:oid, "!=");
tsc:= mosaic.thetaselect (c,1100:oid, "!=");
eq1  := batcalc.==(sa,  sc);
eq2  := batcalc.==(tsa, tsc);
eq3  := batcalc.==(sc, tsc);
io.print(sa, sc, tsa, tsc, eq1, eq2, eq3);

# Should give empty result
sa:= algebra.select(a,1000:oid, 1000:oid,false,true,false);
sc:= mosaic.select (c,1000:oid, 1000:oid,false,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,1000:oid, 1000:oid,true,false,false);
sc:= mosaic.select (c,1000:oid, 1000:oid,true,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,1000:oid, 1000:oid,false,false,false);
sc:= mosaic.select (c,1000:oid, 1000:oid,false,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

# Should give all non-nil value
sa:= algebra.select(a,1000:oid, 1000:oid,false,true,true);
sc:= mosaic.select (c,1000:oid, 1000:oid,false,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,1000:oid, 1000:oid,true,false,true);
sc:= mosaic.select (c,1000:oid, 1000:oid,true,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,1000:oid, 1000:oid,false,false,true);
sc:= mosaic.select (c,1000:oid, 1000:oid,false,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,1005:oid, 991:oid,true,true,false);
sc:= mosaic.select (c,1005:oid, 991:oid,true,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,1005:oid, 991:oid,true,true,true);
sc:= mosaic.select (c,1005:oid, 991:oid,true,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,991:oid, 1005:oid,true,true,false);
sc:= mosaic.select (c,991:oid, 1005:oid,true,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1005:oid,true,true,false);
sc:= mosaic.select (c,999:oid, 1005:oid,true,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,991:oid, 1008:oid,true,true,false);
sc:= mosaic.select (c,991:oid, 1008:oid,true,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1008:oid,true,true,false);
sc:= mosaic.select (c,999:oid, 1008:oid,true,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,991:oid, 1005:oid,false,true,false);
sc:= mosaic.select (c,991:oid, 1005:oid,false,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1005:oid,false,true,false);
sc:= mosaic.select (c,999:oid, 1005:oid,false,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,991:oid, 1008:oid,false,true,false);
sc:= mosaic.select (c,991:oid, 1008:oid,false,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1008:oid,false,true,false);
sc:= mosaic.select (c,999:oid, 1008:oid,false,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,991:oid, 1005:oid,true,false,false);
sc:= mosaic.select (c,991:oid, 1005:oid,true,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1005:oid,true,false,false);
sc:= mosaic.select (c,999:oid, 1005:oid,true,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,991:oid, 1008:oid,true,false,false);
sc:= mosaic.select (c,991:oid, 1008:oid,true,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1008:oid,true,false,false);
sc:= mosaic.select (c,999:oid, 1008:oid,true,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,991:oid, 1005:oid,false,false,false);
sc:= mosaic.select (c,991:oid, 1005:oid,false,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1005:oid,false,false,false);
sc:= mosaic.select (c,999:oid, 1005:oid,false,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,991:oid, 1008:oid,false,false,false);
sc:= mosaic.select (c,991:oid, 1008:oid,false,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1008:oid,false,false,false);
sc:= mosaic.select (c,999:oid, 1008:oid,false,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,991:oid, 1005:oid,true,true,true);
sc:= mosaic.select (c,991:oid, 1005:oid,true,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1005:oid,true,true,true);
sc:= mosaic.select (c,999:oid, 1005:oid,true,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,991:oid, 1008:oid,true,true,true);
sc:= mosaic.select (c,991:oid, 1008:oid,true,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1008:oid,true,true,true);
sc:= mosaic.select (c,999:oid, 1008:oid,true,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,991:oid, 1005:oid,false,true,true);
sc:= mosaic.select (c,991:oid, 1005:oid,false,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1005:oid,false,true,true);
sc:= mosaic.select (c,999:oid, 1005:oid,false,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,991:oid, 1008:oid,false,true,true);
sc:= mosaic.select (c,991:oid, 1008:oid,false,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1008:oid,false,true,true);
sc:= mosaic.select (c,999:oid, 1008:oid,false,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,991:oid, 1005:oid,true,false,true);
sc:= mosaic.select (c,991:oid, 1005:oid,true,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1005:oid,true,false,true);
sc:= mosaic.select (c,999:oid, 1005:oid,true,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,991:oid, 1008:oid,true,false,true);
sc:= mosaic.select (c,991:oid, 1008:oid,true,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1008:oid,true,false,true);
sc:= mosaic.select (c,999:oid, 1008:oid,true,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,991:oid, 1005:oid,false,false,true);
sc:= mosaic.select (c,991:oid, 1005:oid,false,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1005:oid,false,false,true);
sc:= mosaic.select (c,999:oid, 1005:oid,false,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,991:oid, 1008:oid,false,false,true);
sc:= mosaic.select (c,991:oid, 1008:oid,false,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1008:oid,false,false,true);
sc:= mosaic.select (c,999:oid, 1008:oid,false,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1005:oid,true,true,false);
sc:= mosaic.select (c,980:oid, 1005:oid,true,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1005:oid,true,true,false);
sc:= mosaic.select (c,980:oid, 1005:oid,true,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1008:oid,true,true,false);
sc:= mosaic.select (c,980:oid, 1008:oid,true,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1008:oid,true,true,false);
sc:= mosaic.select (c,999:oid, 1008:oid,true,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1005:oid,false,true,false);
sc:= mosaic.select (c,980:oid, 1005:oid,false,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1005:oid,false,true,false);
sc:= mosaic.select (c,980:oid, 1005:oid,false,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1008:oid,false,true,false);
sc:= mosaic.select (c,980:oid, 1008:oid,false,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1008:oid,false,true,false);
sc:= mosaic.select (c,980:oid, 1008:oid,false,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1005:oid,true,false,false);
sc:= mosaic.select (c,980:oid, 1005:oid,true,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1005:oid,true,false,false);
sc:= mosaic.select (c,980:oid, 1005:oid,true,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1008:oid,true,false,false);
sc:= mosaic.select (c,980:oid, 1008:oid,true,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1008:oid,true,false,false);
sc:= mosaic.select (c,980:oid, 1008:oid,true,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1005:oid,false,false,false);
sc:= mosaic.select (c,980:oid, 1005:oid,false,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1005:oid,false,false,false);
sc:= mosaic.select (c,980:oid, 1005:oid,false,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1008:oid,false,false,false);
sc:= mosaic.select (c,980:oid, 1008:oid,false,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1008:oid,false,false,false);
sc:= mosaic.select (c,980:oid, 1008:oid,false,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1005:oid,true,true,true);
sc:= mosaic.select (c,980:oid, 1005:oid,true,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1005:oid,true,true,true);
sc:= mosaic.select (c,980:oid, 1005:oid,true,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1008:oid,true,true,true);
sc:= mosaic.select (c,980:oid, 1008:oid,true,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1008:oid,true,true,true);
sc:= mosaic.select (c,980:oid, 1008:oid,true,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1005:oid,false,true,true);
sc:= mosaic.select (c,980:oid, 1005:oid,false,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1005:oid,false,true,true);
sc:= mosaic.select (c,980:oid, 1005:oid,false,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1008:oid,false,true,true);
sc:= mosaic.select (c,980:oid, 1008:oid,false,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1008:oid,false,true,true);
sc:= mosaic.select (c,980:oid, 1008:oid,false,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1005:oid,true,false,true);
sc:= mosaic.select (c,980:oid, 1005:oid,true,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1005:oid,true,false,true);
sc:= mosaic.select (c,980:oid, 1005:oid,true,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1008:oid,true,false,true);
sc:= mosaic.select (c,980:oid, 1008:oid,true,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1008:oid,true,false,true);
sc:= mosaic.select (c,980:oid, 1008:oid,true,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1005:oid,false,false,true);
sc:= mosaic.select (c,980:oid, 1005:oid,false,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1005:oid,false,false,true);
sc:= mosaic.select (c,980:oid, 1005:oid,false,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1008:oid,false,false,true);
sc:= mosaic.select (c,980:oid, 1008:oid,false,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1008:oid,false,false,true);
sc:= mosaic.select (c,980:oid, 1008:oid,false,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,991:oid, 1020:oid,true,true,false);
sc:= mosaic.select (c,991:oid, 1020:oid,true,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1020:oid,true,true,false);
sc:= mosaic.select (c,999:oid, 1020:oid,true,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,991:oid, 1020:oid,true,true,false);
sc:= mosaic.select (c,991:oid, 1020:oid,true,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1020:oid,true,true,false);
sc:= mosaic.select (c,999:oid, 1020:oid,true,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,991:oid, 1020:oid,false,true,false);
sc:= mosaic.select (c,991:oid, 1020:oid,false,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1020:oid,false,true,false);
sc:= mosaic.select (c,999:oid, 1020:oid,false,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,991:oid, 1020:oid,false,true,false);
sc:= mosaic.select (c,991:oid, 1020:oid,false,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1020:oid,false,true,false);
sc:= mosaic.select (c,999:oid, 1020:oid,false,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,991:oid, 1020:oid,true,false,false);
sc:= mosaic.select (c,991:oid, 1020:oid,true,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1020:oid,true,false,false);
sc:= mosaic.select (c,999:oid, 1020:oid,true,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,991:oid, 1020:oid,true,false,false);
sc:= mosaic.select (c,991:oid, 1020:oid,true,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1020:oid,true,false,false);
sc:= mosaic.select (c,999:oid, 1020:oid,true,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,991:oid, 1020:oid,false,false,false);
sc:= mosaic.select (c,991:oid, 1020:oid,false,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1020:oid,false,false,false);
sc:= mosaic.select (c,999:oid, 1020:oid,false,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,991:oid, 1020:oid,false,false,false);
sc:= mosaic.select (c,991:oid, 1020:oid,false,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1020:oid,false,false,false);
sc:= mosaic.select (c,999:oid, 1020:oid,false,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,991:oid, 1020:oid,true,true,true);
sc:= mosaic.select (c,991:oid, 1020:oid,true,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1020:oid,true,true,true);
sc:= mosaic.select (c,999:oid, 1020:oid,true,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,991:oid, 1020:oid,true,true,true);
sc:= mosaic.select (c,991:oid, 1020:oid,true,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1020:oid,true,true,true);
sc:= mosaic.select (c,999:oid, 1020:oid,true,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,991:oid, 1020:oid,false,true,true);
sc:= mosaic.select (c,991:oid, 1020:oid,false,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1020:oid,false,true,true);
sc:= mosaic.select (c,999:oid, 1020:oid,false,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,991:oid, 1020:oid,false,true,true);
sc:= mosaic.select (c,991:oid, 1020:oid,false,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1020:oid,false,true,true);
sc:= mosaic.select (c,999:oid, 1020:oid,false,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,991:oid, 1020:oid,true,false,true);
sc:= mosaic.select (c,991:oid, 1020:oid,true,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1020:oid,true,false,true);
sc:= mosaic.select (c,999:oid, 1020:oid,true,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,991:oid, 1020:oid,true,false,true);
sc:= mosaic.select (c,991:oid, 1020:oid,true,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1020:oid,true,false,true);
sc:= mosaic.select (c,999:oid, 1020:oid,true,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,991:oid, 1020:oid,false,false,true);
sc:= mosaic.select (c,991:oid, 1020:oid,false,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1020:oid,false,false,true);
sc:= mosaic.select (c,999:oid, 1020:oid,false,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,991:oid, 1020:oid,false,false,true);
sc:= mosaic.select (c,991:oid, 1020:oid,false,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1020:oid,false,false,true);
sc:= mosaic.select (c,999:oid, 1020:oid,false,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1020:oid,true,true,false);
sc:= mosaic.select (c,980:oid, 1020:oid,true,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1020:oid,true,true,false);
sc:= mosaic.select (c,980:oid, 1020:oid,true,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1020:oid,true,true,false);
sc:= mosaic.select (c,980:oid, 1020:oid,true,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,999:oid, 1020:oid,true,true,false);
sc:= mosaic.select (c,999:oid, 1020:oid,true,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1020:oid,false,true,false);
sc:= mosaic.select (c,980:oid, 1020:oid,false,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1020:oid,false,true,false);
sc:= mosaic.select (c,980:oid, 1020:oid,false,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1020:oid,false,true,false);
sc:= mosaic.select (c,980:oid, 1020:oid,false,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1020:oid,false,true,false);
sc:= mosaic.select (c,980:oid, 1020:oid,false,true,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1020:oid,true,false,false);
sc:= mosaic.select (c,980:oid, 1020:oid,true,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1020:oid,true,false,false);
sc:= mosaic.select (c,980:oid, 1020:oid,true,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1020:oid,true,false,false);
sc:= mosaic.select (c,980:oid, 1020:oid,true,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1020:oid,true,false,false);
sc:= mosaic.select (c,980:oid, 1020:oid,true,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1020:oid,false,false,false);
sc:= mosaic.select (c,980:oid, 1020:oid,false,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1020:oid,false,false,false);
sc:= mosaic.select (c,980:oid, 1020:oid,false,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1020:oid,false,false,false);
sc:= mosaic.select (c,980:oid, 1020:oid,false,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1020:oid,false,false,false);
sc:= mosaic.select (c,980:oid, 1020:oid,false,false,false);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1020:oid,true,true,true);
sc:= mosaic.select (c,980:oid, 1020:oid,true,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1020:oid,true,true,true);
sc:= mosaic.select (c,980:oid, 1020:oid,true,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1020:oid,true,true,true);
sc:= mosaic.select (c,980:oid, 1020:oid,true,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1020:oid,true,true,true);
sc:= mosaic.select (c,980:oid, 1020:oid,true,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1020:oid,false,true,true);
sc:= mosaic.select (c,980:oid, 1020:oid,false,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1020:oid,false,true,true);
sc:= mosaic.select (c,980:oid, 1020:oid,false,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1020:oid,false,true,true);
sc:= mosaic.select (c,980:oid, 1020:oid,false,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1020:oid,false,true,true);
sc:= mosaic.select (c,980:oid, 1020:oid,false,true,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1020:oid,true,false,true);
sc:= mosaic.select (c,980:oid, 1020:oid,true,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1020:oid,true,false,true);
sc:= mosaic.select (c,980:oid, 1020:oid,true,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1020:oid,true,false,true);
sc:= mosaic.select (c,980:oid, 1020:oid,true,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1020:oid,true,false,true);
sc:= mosaic.select (c,980:oid, 1020:oid,true,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1020:oid,false,false,true);
sc:= mosaic.select (c,980:oid, 1020:oid,false,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1020:oid,false,false,true);
sc:= mosaic.select (c,980:oid, 1020:oid,false,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1020:oid,false,false,true);
sc:= mosaic.select (c,980:oid, 1020:oid,false,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

sa:= algebra.select(a,980:oid, 1020:oid,false,false,true);
sc:= mosaic.select (c,980:oid, 1020:oid,false,false,true);
eq  := batcalc.==(sa,  sc);
io.print(sa, sc, eq);

b:= bat.new(:oid);
bat.append(b,1000:oid);
bat.append(b,1001:oid);
bat.append(b,999:oid);
bat.append(b,1003:oid);
bat.append(b,nil:oid);
bat.append(b,997:oid);
bat.append(b,1010:oid);
bat.append(b,nil:oid);
bat.append(b,nil:oid);
bat.append(b,nil:oid);
bat.append(b,991:oid);
bat.append(b,992:oid);
bat.append(b,993:oid);
bat.append(b,1000:oid);

(l,r)       := algebra.join(a,b,nil:bat,nil:bat, false, 0:lng);
(r, o, g)   := algebra.sort(r, false:bit, false:bit, false:bit);
(l, o, g)   := algebra.sort(l, o, g, false:bit, false:bit, false:bit);

(lc,rc)     := mosaic.join (c,b,nil:bat,nil:bat, false, 0:lng);
(rc, o, g)  := algebra.sort(rc, false:bit, false:bit, false:bit);
(lc, o, g)  := algebra.sort(lc, o, g, false:bit, false:bit, false:bit);
eq  := batcalc.==(l, lc, true:bit);
io.print(l, lc, eq);
eq  := batcalc.==(r, rc, true:bit);
io.print(r, rc, eq);

(l,r)       := algebra.join(a,b,nil:bat,nil:bat, true, 0:lng);
(r, o, g)   := algebra.sort(r, false:bit, false:bit, false:bit);
(l, o, g)   := algebra.sort(l, o, g, false:bit, false:bit, false:bit);

(lc,rc)     := mosaic.join (c,b,nil:bat,nil:bat, true, 0:lng);
(rc, o, g)  := algebra.sort(rc, false:bit, false:bit, false:bit);
(lc, o, g)  := algebra.sort(lc, o, g, false:bit, false:bit, false:bit);
eq  := batcalc.==(l, lc, true:bit);
io.print(l, lc, eq);
eq  := batcalc.==(r, rc, true:bit);
io.print(r, rc, eq);

(l,r)       := algebra.join(b, a,nil:bat,nil:bat, false, 0:lng);
(r, o, g)   := algebra.sort(r, false:bit, false:bit, false:bit);
(l, o, g)   := algebra.sort(l, o, g, false:bit, false:bit, false:bit);

(lc,rc)     := mosaic.join (b, c,nil:bat,nil:bat, false, 0:lng);
(rc, o, g)  := algebra.sort(rc, false:bit, false:bit, false:bit);
(lc, o, g)  := algebra.sort(lc, o, g, false:bit, false:bit, false:bit);
eq  := batcalc.==(l, lc, true:bit);
io.print(l, lc, eq);
eq  := batcalc.==(r, rc, true:bit);
io.print(r, rc, eq);

(l,r)       := algebra.join(b, a,nil:bat,nil:bat, true, 0:lng);
(r, o, g)   := algebra.sort(r, false:bit, false:bit, false:bit);
(l, o, g)   := algebra.sort(l, o, g, false:bit, false:bit, false:bit);

(lc,rc)     := mosaic.join (b, c,nil:bat,nil:bat, true, 0:lng);
(rc, o, g)  := algebra.sort(rc, false:bit, false:bit, false:bit);
(lc, o, g)  := algebra.sort(lc, o, g, false:bit, false:bit, false:bit);
eq  := batcalc.==(l, lc, true:bit);
io.print(l, lc, eq);
eq  := batcalc.==(r, rc, true:bit);
io.print(r, rc, eq);

(l,r)       := algebra.join(a,b,nil:bat,nil:bat, false, 0:lng);
(r, o, g)   := algebra.sort(r, false:bit, false:bit, false:bit);
(l, o, g)   := algebra.sort(l, o, g, false:bit, false:bit, false:bit);

(lc,rc)     := mosaic.join (c,b,nil:bat,nil:bat, false, 0:lng, true:bit);
(rc, o, g)  := algebra.sort(rc, false:bit, false:bit, false:bit);
(lc, o, g)  := algebra.sort(lc, o, g, false:bit, false:bit, false:bit);
eq  := batcalc.==(l, lc, true:bit);
io.print(l, lc, eq);
eq  := batcalc.==(r, rc, true:bit);
io.print(r, rc, eq);

(l,r)       := algebra.join(a,b,nil:bat,nil:bat, true, 0:lng);
(r, o, g)   := algebra.sort(r, false:bit, false:bit, false:bit);
(l, o, g)   := algebra.sort(l, o, g, false:bit, false:bit, false:bit);

(lc,rc)     := mosaic.join (c,b,nil:bat,nil:bat, true, 0:lng, true:bit);
(rc, o, g)  := algebra.sort(rc, false:bit, false:bit, false:bit);
(lc, o, g)  := algebra.sort(lc, o, g, false:bit, false:bit, false:bit);
eq  := batcalc.==(l, lc, true:bit);
io.print(l, lc, eq);
eq  := batcalc.==(r, rc, true:bit);
io.print(r, rc, eq);

(l,r)       := algebra.join(b, a,nil:bat,nil:bat, false, 0:lng);
(r, o, g)   := algebra.sort(r, false:bit, false:bit, false:bit);
(l, o, g)   := algebra.sort(l, o, g, false:bit, false:bit, false:bit);

(lc,rc)     := mosaic.join (b, c,nil:bat,nil:bat, false, 0:lng, true:bit);
(rc, o, g)  := algebra.sort(rc, false:bit, false:bit, false:bit);
(lc, o, g)  := algebra.sort(lc, o, g, false:bit, false:bit, false:bit);
eq  := batcalc.==(l, lc, true:bit);
io.print(l, lc, eq);
eq  := batcalc.==(r, rc, true:bit);
io.print(r, rc, eq);

(l,r)       := algebra.join(b, a,nil:bat,nil:bat, true, 0:lng);
(r, o, g)   := algebra.sort(r, false:bit, false:bit, false:bit);
(l, o, g)   := algebra.sort(l, o, g, false:bit, false:bit, false:bit);

(lc,rc)     := mosaic.join (b, c,nil:bat,nil:bat, true, 0:lng, true:bit);
(rc, o, g)  := algebra.sort(rc, false:bit, false:bit, false:bit);
(lc, o, g)  := algebra.sort(lc, o, g, false:bit, false:bit, false:bit);
eq  := batcalc.==(l, lc, true:bit);
io.print(l, lc, eq);
eq  := batcalc.==(r, rc, true:bit);
io.print(r, rc, eq);

tsa:= mosaic.thetaselect(a,900:oid, ">");
tsap    := algebra.projection(tsa, a);
tsapc   := mosaic.projection(tsa, c);
eq  := batcalc.==(tsap, tsapc, true:bit);
io.print(tsap, tsapc, eq);

sa:= algebra.select(a,900:oid, nil:oid,false,false,false);
sap    := algebra.projection(tsa, a);
sapc   := mosaic.projection(tsa, c);
eq  := batcalc.==(sap, sapc, true:bit);
io.print(sap, sapc, eq);

pl  := algebra.projection(l, a);
plc := mosaic.projection(l, c);
eq  := batcalc.==(pl, plc, true:bit);
io.print(pl, plc, eq);
