# >Number:         145
include "mil_algebra_procs";
include "mil_insert";
include "mil_system_procs";
# >Category:       Module_libgdk
# >Synopsis:       bug in BATmergejoin (gdk_relop.mx)
# >Confidential:   no
# >Severity:       critical
# >Priority:       high
# >Responsible:    boncz (Peter Boncz)
# >State:          closed
# >Class:          sw-bug
# >Submitter-Id:   unknown
# >Arrival-Date:   Mon Mar  9 14:28:12 1998
# >Originator:     manegold@cwi.nl
# >Organization:
# >Release:        980101
# >Environment:
# all (although the error only occurs on IRIX with GNU=OFF)
# >Description:
# Tests 'FIX.suite_02/test_70` and 'suite_02/test_70`
# fail, actually, join() fails with a segfault in 
# BATmirror, as BATmirror is called with a 
# non-initialized BAT 'bn` in line 122 of gdk_relop.mx:
# 'BATflipflop(bn)`.
# I think this call is superfluous (or "at least" wrong).
# 
# I don't know, why this error does not occur when
# Mserver is compiled with GNU tools...
# 
# 	stefan
# 

setoid(oid(10000000));
module("unix","ascii_io");
# initialize the database
var t:= new(int,int);
t.rename("k10_unique1");
t.persists(true);
t.import(getenv("TSTTRGDIR")+"/no.145.k10_unique1"));
t.count().print();
var z:= new(int,int);
z.rename("k10_unique2");
z.persists(true);
z.import(sprintf(getenv("TSTTRGDIR")+"/no.145.k10_unique2"));
z.count().print();
var w:= new(int,int);
w.rename("k100_unique1");
w.persists(true);
w.import(sprintf(getenv("TSTTRGDIR")+"/no.145.k100_unique1"));
w.count().print();
commit();
#quit;
