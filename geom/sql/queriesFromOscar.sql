CREATE TABLE ahn_flat (x float, y float, z float);
copy 20165862 records into ahn_flat from '/net/essen.ins.cwi.nl/export/scratch2/goncalve/geo_data/20M/tileslaz/ahn_bench000020.txt' using delimiters ',';

CREATE TABLE query_polygons (
 id integer, 
 geom Geometry);

INSERT INTO query_polygons VALUES (1,ST_GeomFromText('POLYGON ((85670.0 446469.0, 85670.0 446416.0, 85721.0 446416.0, 85721.0 446469.0, 85670.0 446469.0))',28992));
create table query_results_01(like ahn_flat);
insert into query_results_01 select * from ahn_flat where x between 85670.0 and 85721.0 and y between 446416.0 and 446469.0;

INSERT INTO query_polygons VALUES (2,ST_GeomFromText('POLYGON ((85054.0 447447.0, 85054.0 447224.0, 85276.0 447224.0, 85276.0 447447.0, 85054.0 447447.0))',28992));
create table query_results_02(like ahn_flat);
insert into query_results_02 select * from ahn_flat where x between 85054.0 and 85276.0 and y between 447224.0 and 447447.0;

INSERT INTO query_polygons VALUES (3,ST_GeomFromText('POLYGON ((85365.0 446574.0, 85366.31 446574.04, 85367.61 446574.17, 85368.9 446574.38, 85370.18 446574.68, 85371.43 446575.06, 85372.65 446575.52, 85373.85 446576.06, 85375.0 446576.68, 85376.11 446577.37, 85377.18 446578.13, 85378.19 446578.96, 85379.14 446579.86, 85380.04 446580.81, 85380.87 446581.82, 85381.63 446582.89, 85382.32 446584.0, 85382.94 446585.15, 85383.48 446586.35, 85383.94 446587.57, 85384.32 446588.82, 85384.62 446590.1, 85384.83 446591.39, 85384.96 446592.69, 85385.0 446594.0, 85384.96 446595.31, 85384.83 446596.61, 85384.62 446597.9, 85384.32 446599.18, 85383.94 446600.43, 85383.48 446601.65, 85382.94 446602.85, 85382.32 446604.0, 85381.63 446605.11, 85380.87 446606.18, 85380.04 446607.19, 85379.14 446608.14, 85378.19 446609.04, 85377.18 446609.87, 85376.11 446610.63, 85375.0 446611.32, 85373.85 446611.94, 85372.65 446612.48, 85371.43 446612.94, 85370.18 446613.32, 85368.9 446613.62, 85367.61 446613.83, 85366.31 446613.96, 85365.0 446614.0, 85363.69 446613.96, 85362.39 446613.83, 85361.1 446613.62, 85359.82 446613.32, 85358.57 446612.94, 85357.35 446612.48, 85356.15 446611.94, 85355.0 446611.32, 85353.89 446610.63, 85352.82 446609.87, 85351.81 446609.04, 85350.86 446608.14, 85349.96 446607.19, 85349.13 446606.18, 85348.37 446605.11, 85347.68 446604.0, 85347.06 446602.85, 85346.52 446601.65, 85346.06 446600.43, 85345.68 446599.18, 85345.38 446597.9, 85345.17 446596.61, 85345.04 446595.31, 85345.0 446594.0, 85345.04 446592.69, 85345.17 446591.39, 85345.38 446590.1, 85345.68 446588.82, 85346.06 446587.57, 85346.52 446586.35, 85347.06 446585.15, 85347.68 446584.0, 85348.37 446582.89, 85349.13 446581.82, 85349.96 446580.81, 85350.86 446579.86, 85351.81 446578.96, 85352.82 446578.13, 85353.89 446577.37, 85355.0 446576.68, 85356.15 446576.06, 85357.35 446575.52, 85358.57 446575.06, 85359.82 446574.68, 85361.1 446574.38, 85362.39 446574.17, 85363.69 446574.04, 85365.0 446574.0))',28992));
create table query_results_03(like ahn_flat);
insert into query_results_03 select * from ahn_flat where x between 85365.0-20.0 and 85365.0+20.0 and y between 446594.0-20.0 and 446594.0+20.0 and power(x - 85365.0,2) + power(y - 446594.0,2) < power(20.0,2);

INSERT INTO query_polygons VALUES (4,ST_GeomFromText('POLYGON ((85759.0 446913.0, 85760.91 446913.02, 85762.82 446913.06, 85764.73 446913.14, 85766.64 446913.25, 85768.55 446913.4, 85770.45 446913.57, 85772.35 446913.78, 85774.25 446914.02, 85776.14 446914.28, 85778.03 446914.59, 85779.91 446914.92, 85781.79 446915.28, 85783.66 446915.67, 85785.52 446916.1, 85787.38 446916.56, 85789.23 446917.04, 85791.07 446917.56, 85792.9 446918.11, 85794.72 446918.69, 85796.53 446919.3, 85798.33 446919.94, 85800.12 446920.6, 85801.9 446921.3, 85803.67 446922.03, 85805.43 446922.79, 85807.17 446923.57, 85808.9 446924.39, 85810.61 446925.23, 85812.31 446926.1, 85814.0 446927.0, 85815.67 446927.93, 85817.33 446928.89, 85818.97 446929.87, 85820.59 446930.88, 85822.19 446931.92, 85823.78 446932.98, 85825.35 446934.07, 85826.9 446935.19, 85828.44 446936.33, 85829.95 446937.5, 85831.45 446938.69, 85832.92 446939.9, 85834.37 446941.15, 85835.81 446942.41, 85837.22 446943.7, 85838.61 446945.01, 85839.98 446946.35, 85841.32 446947.7, 85842.65 446949.08, 85843.95 446950.48, 85845.22 446951.91, 85846.48 446953.35, 85847.71 446954.81, 85848.91 446956.3, 85850.09 446957.8, 85851.24 446959.33, 85852.37 446960.87, 85853.48 446962.43, 85854.55 446964.01, 85855.6 446965.61, 85856.63 446967.22, 85857.62 446968.85, 85858.59 446970.5, 85859.53 446972.16, 85860.45 446973.84, 85861.34 446975.54, 85862.19 446977.24, 85863.02 446978.97, 85863.82 446980.7, 85864.59 446982.45, 85865.34 446984.21, 85866.05 446985.99, 85866.73 446987.77, 85867.39 446989.57, 85868.01 446991.37, 85868.61 446993.19, 85869.17 446995.02, 85869.7 446996.85, 85870.2 446998.7, 85870.68 447000.55, 85871.12 447002.41, 85871.53 447004.28, 85871.91 447006.15, 85872.25 447008.03, 85872.57 447009.92, 85872.85 447011.81, 85873.11 447013.7, 85873.33 447015.6, 85873.52 447017.5, 85873.68 447019.41, 85873.81 447021.31, 85873.9 447023.22, 85873.96 447025.13, 85874.0 447027.04, 85874.0 447028.96, 85873.96 447030.87, 85873.9 447032.78, 85873.81 447034.69, 85873.68 447036.59, 85873.52 447038.5, 85873.33 447040.4, 85873.11 447042.3, 85872.85 447044.19, 85872.57 447046.08, 85872.25 447047.97, 85871.91 447049.85, 85871.53 447051.72, 85871.12 447053.59, 85870.68 447055.45, 85870.2 447057.3, 85869.7 447059.15, 85869.17 447060.98, 85868.61 447062.81, 85868.01 447064.63, 85867.39 447066.43, 85866.73 447068.23, 85866.05 447070.01, 85865.34 447071.79, 85864.59 447073.55, 85863.82 447075.3, 85863.02 447077.03, 85862.19 447078.76, 85861.34 447080.46, 85860.45 447082.16, 85859.53 447083.84, 85858.59 447085.5, 85857.62 447087.15, 85856.63 447088.78, 85855.6 447090.39, 85854.55 447091.99, 85853.48 447093.57, 85852.37 447095.13, 85851.24 447096.67, 85850.09 447098.2, 85848.91 447099.7, 85847.71 447101.19, 85846.48 447102.65, 85845.22 447104.09, 85843.95 447105.52, 85842.65 447106.92, 85841.32 447108.3, 85839.98 447109.65, 85838.61 447110.99, 85837.22 447112.3, 85835.81 447113.59, 85834.37 447114.85, 85832.92 447116.1, 85831.45 447117.31, 85829.95 447118.5, 85828.44 447119.67, 85826.9 447120.81, 85825.35 447121.93, 85823.78 447123.02, 85822.19 447124.08, 85820.59 447125.12, 85818.97 447126.13, 85817.33 447127.11, 85815.67 447128.07, 85814.0 447129.0, 85812.31 447129.9, 85810.61 447130.77, 85808.9 447131.61, 85807.17 447132.43, 85805.43 447133.21, 85803.67 447133.97, 85801.9 447134.7, 85800.12 447135.4, 85798.33 447136.06, 85796.53 447136.7, 85794.72 447137.31, 85792.9 447137.89, 85791.07 447138.44, 85789.23 447138.96, 85787.38 447139.44, 85785.52 447139.9, 85783.66 447140.33, 85781.79 447140.72, 85779.91 447141.08, 85778.03 447141.41, 85776.14 447141.72, 85774.25 447141.98, 85772.35 447142.22, 85770.45 447142.43, 85768.55 447142.6, 85766.64 447142.75, 85764.73 447142.86, 85762.82 447142.94, 85760.91 447142.98, 85759.0 447143.0, 85757.09 447142.98, 85755.18 447142.94, 85753.27 447142.86, 85751.36 447142.75, 85749.45 447142.6, 85747.55 447142.43, 85745.65 447142.22, 85743.75 447141.98, 85741.86 447141.72, 85739.97 447141.41, 85738.09 447141.08, 85736.21 447140.72, 85734.34 447140.33, 85732.48 447139.9, 85730.62 447139.44, 85728.77 447138.96, 85726.93 447138.44, 85725.1 447137.89, 85723.28 447137.31, 85721.47 447136.7, 85719.67 447136.06, 85717.88 447135.4, 85716.1 447134.7, 85714.33 447133.97, 85712.57 447133.21, 85710.83 447132.43, 85709.1 447131.61, 85707.39 447130.77, 85705.69 447129.9, 85704.0 447129.0, 85702.33 447128.07, 85700.67 447127.11, 85699.03 447126.13, 85697.41 447125.12, 85695.81 447124.08, 85694.22 447123.02, 85692.65 447121.93, 85691.1 447120.81, 85689.56 447119.67, 85688.05 447118.5, 85686.55 447117.31, 85685.08 447116.1, 85683.63 447114.85, 85682.19 447113.59, 85680.78 447112.3, 85679.39 447110.99, 85678.02 447109.65, 85676.68 447108.3, 85675.35 447106.92, 85674.05 447105.52, 85672.78 447104.09, 85671.52 447102.65, 85670.29 447101.19, 85669.09 447099.7, 85667.91 447098.2, 85666.76 447096.67, 85665.63 447095.13, 85664.52 447093.57, 85663.45 447091.99, 85662.4 447090.39, 85661.37 447088.78, 85660.38 447087.15, 85659.41 447085.5, 85658.47 447083.84, 85657.55 447082.16, 85656.66 447080.46, 85655.81 447078.76, 85654.98 447077.03, 85654.18 447075.3, 85653.41 447073.55, 85652.66 447071.79, 85651.95 447070.01, 85651.27 447068.23, 85650.61 447066.43, 85649.99 447064.63, 85649.39 447062.81, 85648.83 447060.98, 85648.3 447059.15, 85647.8 447057.3, 85647.32 447055.45, 85646.88 447053.59, 85646.47 447051.72, 85646.09 447049.85, 85645.75 447047.97, 85645.43 447046.08, 85645.15 447044.19, 85644.89 447042.3, 85644.67 447040.4, 85644.48 447038.5, 85644.32 447036.59, 85644.19 447034.69, 85644.1 447032.78, 85644.04 447030.87, 85644.0 447028.96, 85644.0 447027.04, 85644.04 447025.13, 85644.1 447023.22, 85644.19 447021.31, 85644.32 447019.41, 85644.48 447017.5, 85644.67 447015.6, 85644.89 447013.7, 85645.15 447011.81, 85645.43 447009.92, 85645.75 447008.03, 85646.09 447006.15, 85646.47 447004.28, 85646.88 447002.41, 85647.32 447000.55, 85647.8 446998.7, 85648.3 446996.85, 85648.83 446995.02, 85649.39 446993.19, 85649.99 446991.37, 85650.61 446989.57, 85651.27 446987.77, 85651.95 446985.99, 85652.66 446984.21, 85653.41 446982.45, 85654.18 446980.7, 85654.98 446978.97, 85655.81 446977.24, 85656.66 446975.54, 85657.55 446973.84, 85658.47 446972.16, 85659.41 446970.5, 85660.38 446968.85, 85661.37 446967.22, 85662.4 446965.61, 85663.45 446964.01, 85664.52 446962.43, 85665.63 446960.87, 85666.76 446959.33, 85667.91 446957.8, 85669.09 446956.3, 85670.29 446954.81, 85671.52 446953.35, 85672.78 446951.91, 85674.05 446950.48, 85675.35 446949.08, 85676.68 446947.7, 85678.02 446946.35, 85679.39 446945.01, 85680.78 446943.7, 85682.19 446942.41, 85683.63 446941.15, 85685.08 446939.9, 85686.55 446938.69, 85688.05 446937.5, 85689.56 446936.33, 85691.1 446935.19, 85692.65 446934.07, 85694.22 446932.98, 85695.81 446931.92, 85697.41 446930.88, 85699.03 446929.87, 85700.67 446928.89, 85702.33 446927.93, 85704.0 446927.0, 85705.69 446926.1, 85707.39 446925.23, 85709.1 446924.39, 85710.83 446923.57, 85712.57 446922.79, 85714.33 446922.03, 85716.1 446921.3, 85717.88 446920.6, 85719.67 446919.94, 85721.47 446919.3, 85723.28 446918.69, 85725.1 446918.11, 85726.93 446917.56, 85728.77 446917.04, 85730.62 446916.56, 85732.48 446916.1, 85734.34 446915.67, 85736.21 446915.28, 85738.09 446914.92, 85739.97 446914.59, 85741.86 446914.28, 85743.75 446914.02, 85745.65 446913.78, 85747.55 446913.57, 85749.45 446913.4, 85751.36 446913.25, 85753.27 446913.14, 85755.18 446913.06, 85757.09 446913.02, 85759.0 446913.0))',28992));
create table query_results_04(like ahn_flat);
insert into query_results_04 select * from ahn_flat where x between 85759.0-115.0 and 85759.0+115.0 and y between 447028.0-115.0 and 447028.0+115.0 and power(x - 85759.0,2) + power(y - 447028.0,2) < power(115.0,2);

INSERT INTO query_polygons VALUES (5,ST_GeomFromText('POLYGON ((85073.0 446371.0, 85069.0 446347.0, 85092.0 446334.0, 85133.0 446353.0, 85173.0 446396.0, 85201.0 446428.0, 85180.0 446458.0, 85103.0 446435.0, 85073.0 446371.0))',28992));
create table query_results_05(like ahn_flat);
--182861 affected row (27.1s)
INSERT INTO query_results_05 SELECT x,y,z FROM ahn_flat, query_polygons where (x between 85069.0 and 85201.0) and (y between 446334.0 and 446458.0) and id = 5 and st_contains(geom, ST_setSRID(ST_MakePoint(x,y), 28992));
--182861 affected row (30.7s)
INSERT INTO query_results_05 
   SELECT X,Y,Z FROM (
       SELECT * FROM ahn_flat where (x between 85069.0 and 85201.0) and (y between 446334.0 and 446458.0) ) a, query_polygons where id = 5 and st_contains(geom, ST_setSRID(ST_MakePoint(x,y), 28992));

INSERT INTO query_polygons VALUES (6,ST_GeomFromText('POLYGON ((85216.63 446928.37, 85214.96 446930.6, 85214.16 446931.12, 85212.61 446931.33, 85211.14 446931.12, 85210.37 446930.65, 85208.5 446928.85, 85207.27 446928.38, 85205.77 446928.32, 85203.93 446928.66, 85198.26 446930.28, 85196.62 446930.35, 85195.3 446929.98, 85193.92 446928.85, 85191.14 446925.28, 85190.39 446924.66, 85189.64 446924.32, 85188.19 446924.33, 85184.23 446925.71, 85182.47 446925.83, 85181.49 446925.47, 85179.31 446924.2, 85178.32 446923.95, 85177.74 446924.07, 85177.14 446924.43, 85174.47 446927.34, 85173.75 446927.86, 85173.04 446928.1, 85171.15 446928.1, 85170.39 446927.8, 85169.61 446927.14, 85166.91 446923.57, 85166.37 446923.22, 85165.87 446923.19, 85165.2 446923.79, 85163.74 446926.32, 85162.85 446926.97, 85160.97 446926.97, 85160.03 446926.74, 85159.13 446926.29, 85157.44 446924.7, 85155.92 446922.31, 85153.8 446917.91, 85152.67 446915.27, 85152.53 446913.29, 85153.3 446908.71, 85153.04 446906.97, 85152.26 446905.8, 85149.49 446903.35, 85148.52 446902.07, 85147.84 446900.42, 85147.39 446898.67, 85146.88 446895.61, 85147.01 446894.74, 85147.39 446894.14, 85148.9 446893.39, 85149.51 446892.79, 85149.95 446891.93, 85150.8 446887.75, 85151.54 446886.22, 85153.2 446884.6, 85155.31 446883.2, 85156.29 446882.83, 85158.79 446882.24, 85159.84 446881.7, 85160.5 446880.79, 85161.5 446878.29, 85162.1 446877.55, 85163.26 446877.04, 85165.97 446876.69, 85167.0 446876.41, 85167.96 446875.88, 85168.92 446875.08, 85172.52 446871.08, 85174.17 446870.0, 85177.65 446868.77, 85178.86 446868.66, 85179.83 446868.87, 85180.54 446869.44, 85181.94 446871.2, 85182.47 446871.51, 85182.83 446871.36, 85183.17 446870.89, 85184.18 446868.01, 85184.73 446866.98, 85186.67 446865.02, 85188.88 446863.59, 85190.76 446862.75, 85192.17 446862.31, 85193.31 446862.21, 85194.17 446862.46, 85194.66 446862.98, 85195.56 446864.63, 85196.05 446865.1, 85197.61 446865.41, 85199.45 446865.1, 85200.26 446864.41, 85201.66 446861.74, 85202.46 446860.95, 85203.01 446860.82, 85203.72 446860.9, 85207.01 446861.92, 85207.65 446861.91, 85208.12 446861.7, 85208.89 446860.75, 85209.63 446859.06, 85210.32 446856.18, 85210.29 446855.05, 85210.01 446854.16, 85209.53 446853.58, 85207.94 446852.48, 85207.37 446851.89, 85206.87 446850.89, 85206.24 446848.87, 85205.23 446845.59, 85204.45 446842.34, 85203.9 446839.16, 85203.6 446836.05, 85203.94 446831.34, 85203.86 446830.63, 85203.6 446830.39, 85202.94 446830.76, 85200.58 446833.03, 85197.05 446835.06, 85195.37 446835.69, 85193.79 446836.05, 85192.85 446836.05, 85191.76 446835.81, 85186.83 446833.92, 85185.68 446833.84, 85184.73 446834.16, 85182.47 446836.42, 85180.82 446837.4, 85179.0 446838.08, 85177.25 446838.39, 85175.68 446838.31, 85174.74 446837.95, 85172.75 446836.72, 85171.91 446836.42, 85170.68 446836.32, 85168.89 446836.42, 85166.34 446836.79, 85163.98 446837.43, 85161.92 446838.32, 85160.21 446839.44, 85158.19 446842.18, 85157.19 446842.84, 85155.31 446842.84, 85154.29 446842.37, 85152.13 446840.32, 85151.16 446839.82, 85150.43 446839.88, 85149.64 446840.28, 85146.36 446843.47, 85145.53 446844.05, 85144.75 446844.35, 85142.24 446844.68, 85141.33 446844.6, 85140.6 446844.35, 85139.63 446843.61, 85138.71 446842.46, 85138.23 446841.46, 85137.95 446840.23, 85137.95 446837.18, 85138.31 446835.95, 85139.81 446833.13, 85140.22 446831.9, 85140.25 446830.93, 85140.03 446829.97, 85139.58 446829.0, 85138.86 446828.0, 85137.09 446826.23, 85131.53 446821.59, 85130.19 446820.11, 85129.28 446818.69, 85128.0 446816.41, 85127.77 446815.3, 85128.09 446814.68, 85128.84 446814.1, 85132.3 446812.66, 85133.93 446812.28, 85138.77 446812.0, 85139.76 446811.54, 85140.22 446810.77, 85140.33 446809.73, 85140.22 446808.89, 85139.96 446808.47, 85139.46 446808.14, 85136.94 446807.45, 85136.07 446807.0, 85134.49 446805.25, 85133.43 446803.23, 85133.13 446801.5, 85133.31 446799.47, 85133.94 446797.31, 85134.94 446795.3, 85135.86 446794.02, 85136.82 446793.04, 85137.84 446792.52, 85140.56 446791.8, 85141.35 446791.15, 85141.52 446790.38, 85141.43 446789.33, 85141.1 446788.12, 85140.6 446787.0, 85139.92 446786.22, 85137.58 446784.36, 85136.38 446782.59, 85135.31 446780.23, 85134.47 446777.51, 85133.96 446774.77, 85133.84 446772.39, 85134.11 446770.49, 85134.73 446769.19, 85135.69 446768.52, 85136.95 446768.47, 85140.52 446769.18, 85142.1 446769.27, 85144.87 446768.49, 85145.88 446768.52, 85146.5 446769.07, 85147.66 446770.91, 85148.14 446771.16, 85148.48 446770.83, 85149.2 446769.3, 85149.65 446768.9, 85151.16 446768.9, 85152.93 446769.15, 85154.66 446769.67, 85156.33 446770.47, 85157.95 446771.54, 85158.33 446771.16, 85158.81 446769.53, 85159.48 446768.23, 85160.32 446767.26, 85161.34 446766.63, 85162.19 446766.53, 85164.36 446766.82, 85165.12 446766.63, 85165.59 446765.96, 85166.18 446763.81, 85166.63 446763.24, 85167.23 446763.04, 85168.97 446763.03, 85169.64 446762.86, 85170.32 446762.12, 85171.28 446759.55, 85171.91 446758.71, 85173.15 446758.4, 85176.51 446758.71, 85177.57 446758.33, 85177.99 446757.6, 85178.61 446755.4, 85179.08 446754.94, 85179.53 446755.1, 85180.81 446756.19, 85181.34 446756.45, 85181.7 446756.35, 85182.02 446755.99, 85183.21 446753.12, 85183.98 446752.3, 85184.82 446752.25, 85186.98 446752.78, 85187.75 446752.67, 85188.29 446752.14, 85189.19 446750.44, 85189.64 446750.03, 85190.51 446750.08, 85192.88 446751.38, 85193.79 446751.54, 85194.24 446751.28, 85194.64 446750.72, 85195.98 446747.39, 85196.81 446746.64, 85197.48 446746.57, 85199.18 446746.76, 85199.82 446746.64, 85200.35 446746.1, 85201.23 446744.37, 85201.71 446744.0, 85202.26 446744.09, 85203.76 446744.98, 85204.35 446745.13, 85205.0 446744.6, 85206.02 446742.07, 85206.61 446741.36, 85207.08 446741.27, 85207.66 446741.39, 85210.65 446743.02, 85211.9 446743.24, 85212.9 446742.68, 85214.96 446740.24, 85216.05 446739.47, 85218.84 446738.66, 85219.68 446738.72, 85220.2 446739.09, 85220.57 446740.23, 85220.84 446740.36, 85221.21 446740.12, 85222.85 446737.9, 85223.59 446737.21, 85224.74 446736.72, 85226.16 446736.44, 85230.38 446736.45, 85233.95 446737.31, 85235.29 446737.21, 85235.91 446736.76, 85237.25 446735.1, 85237.93 446734.57, 85238.54 446734.43, 85239.31 446734.53, 85242.74 446735.8, 85243.96 446735.7, 85245.85 446734.19, 85247.52 446733.89, 85249.24 446734.19, 85249.81 446734.58, 85250.97 446735.84, 85251.51 446736.08, 85252.09 446735.76, 85253.23 446734.27, 85253.77 446733.81, 85254.35 446733.68, 85255.05 446733.78, 85258.73 446735.63, 85259.54 446735.82, 85260.18 446735.7, 85260.9 446735.12, 85262.83 446732.68, 85263.93 446732.22, 85265.31 446732.25, 85267.02 446732.75, 85270.94 446734.49, 85272.63 446735.08, 85274.3 446735.28, 85275.65 446734.94, 85277.56 446733.37, 85278.29 446733.06, 85279.09 446733.36, 85280.84 446735.21, 85281.69 446735.7, 85282.64 446735.57, 85284.98 446734.49, 85285.46 446734.43, 85285.84 446734.57, 85286.97 446736.45, 85287.75 446736.68, 85289.91 446736.35, 85290.74 446736.45, 85291.47 446737.13, 85292.71 446739.32, 85293.38 446739.85, 85294.07 446739.9, 85296.02 446739.45, 85296.78 446739.47, 85297.24 446739.76, 85297.61 446740.3, 85298.65 446743.65, 85299.42 446744.75, 85300.29 446745.13, 85302.91 446745.49, 85303.95 446745.88, 85304.82 446746.63, 85305.64 446747.66, 85306.96 446750.41, 85307.09 446751.57, 85306.81 446754.72, 85306.97 446755.35, 85307.34 446755.69, 85309.6 446755.69, 85310.31 446755.92, 85310.94 446756.37, 85311.95 446757.95, 85312.59 446760.34, 85312.76 446763.26, 85312.44 446766.3, 85311.67 446768.91, 85310.57 446770.7, 85309.92 446771.24, 85309.23 446771.54, 85306.3 446771.43, 85305.45 446771.54, 85304.73 446771.96, 85304.13 446772.73, 85302.44 446777.17, 85301.92 446778.07, 85301.31 446778.71, 85299.8 446779.77, 85298.66 446780.21, 85297.88 446780.18, 85296.05 446779.56, 85295.27 446779.46, 85294.05 446779.89, 85291.55 446781.91, 85290.36 446782.48, 85289.21 446782.49, 85286.32 446781.86, 85285.63 446781.89, 85285.08 446782.1, 85283.57 446783.61, 85282.6 446783.8, 85279.82 446783.11, 85278.67 446783.23, 85277.16 446784.36, 85276.31 446784.38, 85274.48 446783.72, 85273.77 446783.61, 85273.0 446783.84, 85272.28 446784.43, 85269.47 446789.19, 85268.63 446790.03, 85267.73 446790.4, 85266.37 446790.54, 85265.47 446790.4, 85264.99 446790.03, 85264.1 446788.6, 85263.58 446788.14, 85262.68 446787.84, 85261.69 446787.76, 85260.83 446788.01, 85259.96 446788.68, 85257.92 446791.53, 85257.29 446793.19, 85256.67 446797.29, 85256.03 446798.7, 85255.41 446799.3, 85254.49 446799.82, 85249.72 446801.45, 85248.91 446802.08, 85248.49 446802.85, 85248.35 446804.17, 85248.49 446805.87, 85248.94 446807.69, 85249.66 446809.39, 85250.54 446810.69, 85251.51 446811.53, 85252.82 446811.72, 85256.43 446811.1, 85257.1 446811.21, 85257.54 446811.53, 85257.8 446812.18, 85258.04 446814.04, 85258.3 446814.54, 85258.97 446814.57, 85261.42 446813.16, 85262.0 446812.99, 85262.45 446813.04, 85262.95 446813.39, 85264.33 446814.92, 85265.29 446815.3, 85267.65 446815.66, 85268.48 446816.05, 85268.98 446816.63, 85269.87 446818.25, 85270.37 446818.69, 85271.22 446818.61, 85273.55 446817.06, 85274.52 446816.81, 85275.43 446817.35, 85277.11 446819.52, 85277.92 446820.2, 85278.74 446820.46, 85279.73 446820.46, 85284.81 446818.98, 85285.98 446818.88, 85286.97 446819.07, 85288.92 446820.37, 85289.61 446820.58, 85290.23 446820.22, 85291.51 446818.16, 85292.25 446817.56, 85293.14 446817.45, 85294.51 446817.56, 85295.38 446817.8, 85296.29 446818.32, 85299.82 446821.24, 85300.59 446821.6, 85301.31 446821.71, 85302.6 446821.31, 85305.78 446818.93, 85307.34 446818.32, 85309.26 446818.31, 85311.11 446818.69, 85312.36 446819.29, 85313.61 446820.27, 85314.89 446821.64, 85316.4 446823.6, 85317.24 446825.43, 85318.53 446830.46, 85319.08 446831.41, 85319.79 446831.9, 85320.39 446831.95, 85321.14 446831.77, 85324.79 446830.12, 85326.2 446830.01, 85329.22 446831.52, 85331.32 446832.17, 85333.16 446832.52, 85334.73 446832.55, 85336.01 446832.28, 85336.6 446831.92, 85337.19 446831.3, 85339.42 446828.01, 85339.98 446827.54, 85340.54 446827.37, 85341.33 446827.49, 85342.28 446827.93, 85345.07 446830.01, 85347.96 446832.74, 85349.09 446834.19, 85349.97 446835.67, 85350.28 446836.61, 85350.77 446839.47, 85351.06 446840.01, 85351.48 446840.2, 85353.37 446839.44, 85353.98 446839.58, 85354.64 446840.02, 85356.38 446842.08, 85357.54 446843.92, 85358.65 446846.61, 85359.17 446848.44, 85359.51 446850.55, 85359.78 446856.8, 85360.22 446863.05, 85360.19 446865.84, 85359.69 446868.4, 85358.65 446870.38, 85355.25 446873.4, 85354.43 446874.68, 85353.86 446876.42, 85353.04 446882.94, 85352.57 446884.97, 85351.68 446886.53, 85351.07 446887.03, 85350.35 446887.35, 85347.71 446887.73, 85346.67 446888.2, 85345.61 446888.95, 85343.18 446891.5, 85342.28 446893.21, 85340.86 446898.16, 85340.22 446899.06, 85339.41 446899.43, 85336.01 446898.67, 85335.38 446898.84, 85334.73 446899.23, 85332.29 446901.7, 85331.11 446902.44, 85330.07 446902.64, 85327.37 446902.64, 85326.2 446902.82, 85324.78 446903.58, 85321.93 446906.11, 85320.54 446906.97, 85316.4 446908.1, 85315.35 446908.73, 85313.07 446910.55, 85311.87 446911.12, 85307.72 446911.12, 85306.92 446911.46, 85306.11 446912.11, 85303.13 446915.64, 85302.41 446916.15, 85301.68 446916.4, 85300.74 446916.43, 85297.53 446916.03, 85296.4 446916.32, 85295.26 446917.0, 85290.72 446921.57, 85289.58 446922.38, 85288.48 446922.82, 85287.49 446922.92, 85286.32 446922.8, 85281.16 446921.52, 85280.02 446921.48, 85279.05 446921.68, 85277.92 446922.25, 85274.9 446924.32, 85271.78 446925.56, 85267.73 446926.59, 85263.92 446927.4, 85261.69 446927.34, 85260.6 446926.83, 85258.24 446925.03, 85257.17 446924.7, 85256.56 446924.84, 85255.9 446925.23, 85253.62 446927.41, 85252.64 446928.1, 85250.32 446928.97, 85247.65 446929.45, 85244.71 446929.54, 85241.7 446929.23, 85238.0 446927.97, 85236.79 446927.72, 85235.68 446927.77, 85234.44 446928.11, 85229.33 446930.49, 85228.3 446930.73, 85227.36 446930.74, 85225.68 446930.21, 85222.07 446928.16, 85220.57 446927.72, 85218.75 446927.57, 85217.56 446927.72, 85216.63 446928.37), (85236.04 446910.37, 85236.72 446911.17, 85237.17 446912.25, 85238.3 446915.27, 85239.39 446914.21, 85240.57 446913.38, 85242.95 446912.31, 85245.24 446911.77, 85246.85 446911.88, 85247.39 446912.18, 85247.74 446912.63, 85248.11 446914.14, 85248.34 446914.24, 85248.66 446914.12, 85250.34 446912.66, 85251.13 446912.25, 85253.02 446912.25, 85253.73 446912.66, 85255.12 446914.18, 85255.66 446914.52, 85256.08 446914.39, 85256.39 446913.79, 85257.35 446909.23, 85257.77 446908.51, 85258.3 446908.1, 85259.81 446907.73, 85260.78 446908.06, 85262.51 446909.59, 85263.2 446909.99, 85264.26 446909.97, 85265.33 446909.24, 85266.43 446907.84, 85268.73 446903.97, 85269.81 446902.44, 85271.03 446901.32, 85272.26 446900.93, 85273.49 446901.16, 85276.41 446902.32, 85277.54 446902.44, 85278.42 446902.1, 85279.21 446901.29, 85281.91 446895.85, 85282.71 446894.79, 85283.57 446894.14, 85284.84 446893.79, 85288.11 446893.51, 85289.23 446893.01, 85289.64 446892.35, 85289.78 446891.38, 85289.14 446886.88, 85289.23 446885.09, 85289.56 446883.48, 85289.99 446882.83, 85291.5 446882.45, 85291.91 446882.03, 85292.05 446881.34, 85291.26 446877.41, 85291.27 446876.61, 85291.5 446876.04, 85292.28 446875.4, 85294.8 446874.36, 85295.65 446873.77, 85296.05 446872.93, 85296.0 446871.78, 85295.51 446870.3, 85293.29 446865.32, 85293.08 446863.91, 85293.38 446862.83, 85294.23 446861.97, 85296.78 446860.29, 85297.53 446859.44, 85298.04 446857.89, 85298.14 446855.97, 85297.83 446853.97, 85297.16 446852.27, 85296.14 446850.99, 85294.14 446849.25, 85291.77 446847.1, 85291.03 446846.71, 85290.36 446846.61, 85289.7 446846.88, 85288.23 446847.96, 85287.72 446848.12, 85287.37 446847.97, 85287.07 446847.56, 85286.14 446844.52, 85285.46 446843.59, 85284.32 446843.41, 85281.64 446843.93, 85280.56 446843.97, 85279.6 446843.68, 85277.22 446842.51, 85276.58 446842.38, 85276.03 446842.46, 85274.14 446843.97, 85273.8 446843.9, 85273.45 446843.58, 85272.16 446841.21, 85271.5 446840.57, 85270.91 446840.52, 85270.2 446840.76, 85267.39 446842.7, 85266.22 446843.22, 85265.13 446843.28, 85263.84 446843.01, 85259.59 446841.17, 85258.22 446840.72, 85257.02 446840.63, 85256.03 446840.95, 85255.28 446841.64, 85253.78 446843.72, 85253.02 446844.35, 85251.82 446844.6, 85248.68 446844.21, 85247.36 446844.35, 85246.04 446844.88, 85245.09 446845.48, 85244.57 446846.14, 85243.72 446847.95, 85243.21 446848.5, 85242.35 446848.72, 85240.11 446848.62, 85239.44 446848.87, 85239.02 446849.73, 85238.68 446852.65, 85237.22 446855.99, 85236.47 446856.97, 85235.66 446857.55, 85234.63 446857.68, 85231.78 446857.11, 85230.76 446857.17, 85230.18 446857.66, 85229.91 446858.56, 85230.34 446864.64, 85230.14 446866.0, 85229.63 446866.98, 85228.5 446868.11, 85227.55 446868.41, 85224.8 446868.25, 85223.97 446868.49, 85223.7 446868.97, 85223.69 446869.7, 85224.61 446873.15, 85224.72 446874.53, 85223.71 446877.6, 85223.59 446878.68, 85223.93 446879.63, 85225.25 446881.66, 85225.48 446882.45, 85225.32 446883.04, 85224.82 446883.67, 85221.63 446886.2, 85221.29 446886.79, 85221.33 446887.35, 85221.86 446888.31, 85222.46 446888.86, 85224.03 446888.75, 85224.35 446888.86, 85224.46 446889.32, 85224.35 446890.37, 85224.11 446891.27, 85223.57 446892.14, 85222.64 446893.09, 85219.32 446895.87, 85218.61 446896.88, 85218.31 446897.92, 85218.31 446899.43, 85218.82 446899.92, 85221.07 446900.45, 85221.7 446900.93, 85221.7 446903.2, 85222.38 446903.69, 85224.7 446904.0, 85225.48 446904.33, 85225.82 446904.79, 85226.03 446905.46, 85226.15 446909.23, 85226.31 446909.92, 85226.61 446910.37, 85227.18 446910.64, 85227.99 446910.66, 85232.05 446909.64, 85233.78 446909.61, 85235.25 446909.95, 85236.04 446910.37))',28992));
create table query_results_06(like ahn_flat);
--387134 affected row (3m 25s)
INSERT INTO query_results_06 
   SELECT X,Y,Z FROM (
       SELECT * FROM ahn_flat where (x between 85127.77 and 85360.22) and (y between 446732.22 and 446931.33) ) a, query_polygons where id = 6 and st_contains(geom, ST_setSRID(ST_MakePoint(x,y), 28992));
--387134 affected row (3m 25s)
INSERT INTO query_results_06 SELECT X,Y,Z FROM ahn_flat, query_polygons where (x between 85127.77 and 85360.22) and (y between 446732.22 and 446931.33) and id = 6 and st_contains(geom, ST_setSRID(ST_MakePoint(x,y), 28992));

INSERT INTO query_polygons VALUES (7,ST_GeomFromText('POLYGON ((85940.0 447186.0, 85622.0 447461.0, 85618.0 447456.0, 85936.0 447181.0, 85940.0 447186.0))',28992));
create table query_results_07(like ahn_flat);
INSERT INTO query_results_07 
   SELECT X,Y,Z FROM (
       SELECT * FROM ahn_flat where (x between 85618.0 and 85940.0) and (y between 447181.0 and 447461.0) ) a, query_polygons where id = 7 and st_contains(geom, ST_setSRID(ST_MakePoint(x,y), 28992));

INSERT INTO query_results_07 
   SELECT X,Y,Z FROM ahn_flat, query_polygons where (x between 85618.0 and 85940.0) and (y between 447181.0 and 447461.0) and id = 7 and st_contains(geom, ST_setSRID(ST_MakePoint(x,y), 28992));


--DROP TABLE ahn_flat;
--DROP TABLE query_polygons;
--DROP TABLE query_results_01;
--DROP TABLE query_results_03;
--DROP TABLE query_results_04;
--DROP TABLE query_results_05;
--DROP TABLE query_results_06;
--DROP TABLE query_results_07;
--DROP TABLE query_results_06;
