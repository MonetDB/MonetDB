@echo off

if not "%1"=="" goto skip
call %0 -r
goto end

:skip

setlocal

set builddir=@MONETDB_BUILD@
set srcdir=@MONETDB_SOURCE@

set MOD_PATH=%builddir%\src\applications\datacell\.libs;%builddir%\src\compiler\.libs;%builddir%\src\mil\.libs;%builddir%\src\modules\atoms\.libs;%builddir%\src\modules\kernel\.libs;%builddir%\src\modules\mal\.libs;%builddir%\src\modules\mil\.libs;%builddir%\src\optimizer\.libs;%builddir%\src\scheduler\.libs

set PATH=%builddir%\src\tools;%PATH%
set PATH=%MOD_PATH%;%builddir%\src\mal;%PATH%

set PYTHONPATH=@MONETDB_PREFIX@\share\MonetDB\python

REM execute Mtest.py in the source directory
pushd %srcdir%

call python "@MONETDB_PREFIX@\bin\Mtest.py" "--monet_mod_path=%MOD_PATH%" "--TSTSRCBASE=%srcdir%" "--TSTBLDBASE=%builddir%" "--TSTTRGBASE=%builddir%" "--dbfarm=%builddir%\dbfarm" %*

popd
endlocal

:end
