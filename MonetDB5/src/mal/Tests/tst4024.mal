# testing the heuristic rules
# relations r(H,T) and s(H,T)
function qry();
r:= new(:int,:int);
insert(r,5,1);
insert(r,6,2);
insert(r,7,3);
insert(r,8,4);
sc:= copy(r);
s:= reverse(sc);

print(r);
print(s);

# traditional push select through join
# r.T=s.H and s.T<6
t:= join(r,s);
z:= select(t,0,6);
print(z);

# alternative instruction
# s.H=r.H and s.T<2
a:= semijoin(s,r);
z:= select(a,0,2);
print(z);
setDebug();
SPoptimizer();
end qry;
