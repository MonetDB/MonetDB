# check reference counting and multiplex
function dir():void;
        d:= bbp.getRefCount();
        dl:=bbp.getLRefCount();
        dn:= bbp.getNames();
        io.print(dn,d,dl);
end dir;

function createBAT(name:str):bat;
	res:= bat.new(:int,:int);
	bat.setName(res,name);
	i:= calc.getBATidentifier(res);
	return i;
end createBAT;
m:= bat.new(:oid,:str);
bat.insert(m,10:oid,"ten");
bat.insert(m,20:oid,"twenty");
dir();
r:bat[:oid,:bat]:= optimizer.multiplex("user","createBAT",m);
dir();
io.print(r);
