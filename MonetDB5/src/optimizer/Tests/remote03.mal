include sql;
factory sql_cache.s0_0():void;
    mserver.reconnect("test1","127.0.0.1",40000,"monetdb","monetdb","mal");
    Z9:bat[:void,:int]  := sql.bind("sys","t1","id","test1",0);
    mserver.reconnect("test1","127.0.0.1",40000,"monetdb","monetdb","mal");
    Z17:bat[:void,:int]  := sql.bind("sys","t1","id","test1",1);
    Z20 := bat.setWriteMode(Z17);
    Z22 := algebra.kunion(Z9,Z20);
    mserver.reconnect("test1","127.0.0.1",40000,"monetdb","monetdb","mal");
    Z26:bat[:oid,:int]  := sql.bind("sys","t1","id","test1",3);
    Z29 := bat.setWriteMode(Z26);
    Z31 := algebra.kdifference(Z22,Z29);
    Z33 := algebra.kunion(Z31,Z29);
    mserver.reconnect("test1","127.0.0.1",40000,"monetdb","monetdb","mal");
    Z37:bat[:void,:oid]  := sql.bind_dbat("sys","t1","test1",0);
    Z39 := bat.reverse(Z37);
    Z41 := algebra.kdifference(Z33,Z39);
    Z43 := calc.oid(0@0);
    Z46 := algebra.markT(Z41,Z43);
    Z48 := bat.reverse(Z46);
    Z50 := algebra.join(Z48,Z33);
    mserver.reconnect("test1","127.0.0.1",40000,"monetdb","monetdb","mal");
    Z59:bat[:void,:str]  := sql.bind("sys","t1","name","test1",0);
    mserver.reconnect("test1","127.0.0.1",40000,"monetdb","monetdb","mal");
    Z67:bat[:void,:str]  := sql.bind("sys","t1","name","test1",1);
    Z70 := bat.setWriteMode(Z67);
    Z72 := algebra.kunion(Z59,Z70);
    mserver.reconnect("test1","127.0.0.1",40000,"monetdb","monetdb","mal");
    Z76:bat[:oid,:str]  := sql.bind("sys","t1","name","test1",3);
    Z79 := bat.setWriteMode(Z76);
barrier Z99:= true;
    Z81 := algebra.kdifference(Z72,Z79);
    Z83 := algebra.kunion(Z81,Z79);
    Z85 := algebra.join(Z48,Z83);
    Z87 := sql.resultSet(2,1,Z50);
    sql.rsColumn(Z87,"sys.t1","id","int",32,0,Z50);
    sql.rsColumn(Z87,"sys.t1","name","varchar",1024,0,Z85);
    sql.exportResult(Z87);
	yield Z99;
	redo Z99;
exit Z99;
end s0_0; 
mserver.disconnect(mid);
optimizer.remoteQueries("sql_cache","s0_0");
mdb.List("sql_cache","s0_0");
