# testing the optimization of the pocket calculator
function f3():void;
		t1:bat[:void,:int] := bbp.bind("A_bat");
        t3 := array.grid(4096,64,1,0);
        t2 := array.grid(64,64,64,0);
        t4:=batcalc.*(64,t3);
        t5:= batcalc.+(t2,t4);
        t6 := batcalc.oid(t5);
        t7 := algebra.join(t6,t1);
        t8:bat[:void,:int] := bbp.bind("B_bat");
        t9 := array.grid(4096,64,1,0);
        t10 := array.grid(1,64,4096,0);
        t11 := batcalc.*(64,t10);
        t12 := batcalc.+(t9,t11);
        t13 := batcalc.oid(t12);
        t14 := algebra.join(t13,t8);
        t15 := batcalc.*(t7,t14);
        t16 := array.grid(64,64,64,0);
        t17 := array.grid(1,64,4096,0);
        t18 := batcalc.*(64,t17);
        t19 := batcalc.+(t16,t18);
        t20 := batcalc.oid(t19);
        t21 := array.grid(1,4096,1,0);
        t22 := aggr.sum(t15,t20,t21);
        top := t22;
        bat_0 := array.grid(64,64,1,0);
        bat_1 := array.grid(1,64,64,0);
		io.table(bat_0,bat_1,top);
#       io.table(bat_0,bat_1,top);
end f3;
	optimizer.expressionAccumulation("user","f3");
	mdb.list("user","f3");
