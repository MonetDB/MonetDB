#testing the BAT partition table
a1:= bat.new(:void,:int);
bat.setSequenceBase(a1,0@0);
a2:= bat.new(:void,:int);
bat.setSequenceBase(a2,10@0);
a3:= bat.new(:void,:int);
bat.setSequenceBase(a3,20@0);

barrier (go,i):= mal.newRange(0);
	bat.insert(a1,nil,i);
	bat.insert(a2,nil,i);
	bat.insert(a3,nil,i);
	redo (go,i):= mal.nextElement(1,10);
exit (go,i);

# now really add it
partitions.deposit(a1);
partitions.deposit(a1,a2);
partitions.deposit(a1,a3);
partitions.dump();

#retrieve a range
barrier (idx,b):= partitions.newIterator(a1,12@0,24@0);
	io.print(idx);
	io.print(b);
	redo (idx,b):= partitions.hasMoreElements(a1,12@0,24@0);
exit (idx,b);
