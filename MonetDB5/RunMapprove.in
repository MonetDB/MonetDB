#!/bin/sh

builddir=@QMONETDB_BUILD@
# make sure srcdir contains absolute path name
srcdir=`cd '@srcdir@'; pwd`

# enhance various paths to find our stuff
PATH="${builddir}/src/testing:${builddir}/src/tools:${builddir}/src/mapi/clients/C:${builddir}/src/mapi/clients/python:$PATH"
PYTHONPATH="${builddir}/src/testing:${srcdir}/src/testing:${builddir}/src/common:${srcdir}/src/mapi/clients/python"
export PATH PYTHONPATH

# execute Mapprove.py in the source directory
cd "$srcdir"

# check python version
type -a @PYTHON@
@PYTHON@ -V

# execute the script
# if no arguments, do a recursive approve (Mapprove.py -r), else pass
# on the arguments
exec @PYTHON@ "${builddir}/src/testing/Mapprove.py" -5 --config="${builddir}/conf/monetdb5.conf" --TSTTRGBASE="${builddir}" "${@--r}"
