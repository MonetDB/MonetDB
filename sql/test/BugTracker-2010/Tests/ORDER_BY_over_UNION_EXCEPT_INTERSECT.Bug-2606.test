statement ok
create table t2606a (a int)

statement ok
insert into t2606a values (11)

statement ok
insert into t2606a values (21)

statement ok
insert into t2606a values (13)

statement ok
insert into t2606a values (23)

statement ok
insert into t2606a values (12)

statement ok
insert into t2606a values (22)

statement ok
create table t2606b (a int)

statement ok
insert into t2606b values (21)

statement ok
insert into t2606b values (31)

statement ok
insert into t2606b values (23)

statement ok
insert into t2606b values (33)

statement ok
insert into t2606b values (22)

statement ok
insert into t2606b values (32)

query I rowsort
select * from t2606a
----
11
12
13
21
22
23

query I rowsort
select * from t2606b
----
21
22
23
31
32
33

query T nosort
PLAN   select * from t2606a   union   select * from t2606b   order by a
----
project (
| distinct union (
| | project (
| | | group by (
| | | | table("sys"."t2606a") [ "t2606a"."a" ] COUNT 
| | | ) [ "t2606a"."a" ] [ "t2606a"."a" ]
| | ) [ "t2606a"."a" as "%1"."a" ],
| | project (
| | | group by (
| | | | table("sys"."t2606b") [ "t2606b"."a" ] COUNT 
| | | ) [ "t2606b"."a" ] [ "t2606b"."a" ]
| | ) [ "t2606b"."a" as "%2"."a" ]
| ) [ "%1"."a" as "%5"."a" ]
) [ "%5"."a" ] [ "%5"."a" ASC ]

query I rowsort
       select * from t2606a   union   select * from t2606b   order by a
----
11
12
13
21
22
23
31
32
33

query T nosort
PLAN ( select * from t2606a   union   select * from t2606b ) order by a
----
project (
| distinct union (
| | project (
| | | group by (
| | | | table("sys"."t2606a") [ "t2606a"."a" ] COUNT 
| | | ) [ "t2606a"."a" ] [ "t2606a"."a" ]
| | ) [ "t2606a"."a" as "%1"."a" ],
| | project (
| | | group by (
| | | | table("sys"."t2606b") [ "t2606b"."a" ] COUNT 
| | | ) [ "t2606b"."a" ] [ "t2606b"."a" ]
| | ) [ "t2606b"."a" as "%2"."a" ]
| ) [ "%1"."a" as "%5"."a" ]
) [ "%5"."a" ] [ "%5"."a" ASC ]

query I rowsort
     ( select * from t2606a   union   select * from t2606b ) order by a
----
11
12
13
21
22
23
31
32
33

query T nosort
PLAN ( select * from t2606a ) union ( select * from t2606b ) order by a
----
project (
| distinct union (
| | project (
| | | group by (
| | | | table("sys"."t2606a") [ "t2606a"."a" ] COUNT 
| | | ) [ "t2606a"."a" ] [ "t2606a"."a" ]
| | ) [ "t2606a"."a" as "%1"."a" ],
| | project (
| | | group by (
| | | | table("sys"."t2606b") [ "t2606b"."a" ] COUNT 
| | | ) [ "t2606b"."a" ] [ "t2606b"."a" ]
| | ) [ "t2606b"."a" as "%2"."a" ]
| ) [ "%1"."a" as "%5"."a" ]
) [ "%5"."a" ] [ "%5"."a" ASC ]

query I rowsort
     ( select * from t2606a ) union ( select * from t2606b ) order by a
----
11
12
13
21
22
23
31
32
33

query T nosort
PLAN   select * from t2606a   except   select * from t2606b   order by a
----
project (
| distinct except (
| | project (
| | | table("sys"."t2606a") [ "t2606a"."a" ] COUNT 
| | ) [ "t2606a"."a" as "%1"."a" ],
| | project (
| | | table("sys"."t2606b") [ "t2606b"."a" ] COUNT 
| | ) [ "t2606b"."a" as "%2"."a" ]
| ) [ "%1"."a" as "%5"."a" ]
) [ "%5"."a" ] [ "%5"."a" ASC ]

query I rowsort
       select * from t2606a   except   select * from t2606b   order by a
----
11
12
13

query T nosort
PLAN ( select * from t2606a   except   select * from t2606b ) order by a
----
project (
| distinct except (
| | project (
| | | table("sys"."t2606a") [ "t2606a"."a" ] COUNT 
| | ) [ "t2606a"."a" as "%1"."a" ],
| | project (
| | | table("sys"."t2606b") [ "t2606b"."a" ] COUNT 
| | ) [ "t2606b"."a" as "%2"."a" ]
| ) [ "%1"."a" as "%5"."a" ]
) [ "%5"."a" ] [ "%5"."a" ASC ]

query I rowsort
     ( select * from t2606a   except   select * from t2606b ) order by a
----
11
12
13

query T nosort
PLAN ( select * from t2606a ) except ( select * from t2606b ) order by a
----
project (
| distinct except (
| | project (
| | | table("sys"."t2606a") [ "t2606a"."a" ] COUNT 
| | ) [ "t2606a"."a" as "%1"."a" ],
| | project (
| | | table("sys"."t2606b") [ "t2606b"."a" ] COUNT 
| | ) [ "t2606b"."a" as "%2"."a" ]
| ) [ "%1"."a" as "%5"."a" ]
) [ "%5"."a" ] [ "%5"."a" ASC ]

query I rowsort
     ( select * from t2606a ) except ( select * from t2606b ) order by a
----
11
12
13

query T nosort
PLAN   select * from t2606a   intersect   select * from t2606b   order by a
----
project (
| distinct intersect (
| | project (
| | | table("sys"."t2606a") [ "t2606a"."a" ] COUNT 
| | ) [ "t2606a"."a" as "%1"."a" ],
| | project (
| | | table("sys"."t2606b") [ "t2606b"."a" ] COUNT 
| | ) [ "t2606b"."a" as "%2"."a" ]
| ) [ "%1"."a" as "%5"."a" ]
) [ "%5"."a" ] [ "%5"."a" ASC ]

query I rowsort
       select * from t2606a   intersect   select * from t2606b   order by a
----
21
22
23

query T nosort
PLAN ( select * from t2606a   intersect   select * from t2606b ) order by a
----
project (
| distinct intersect (
| | project (
| | | table("sys"."t2606a") [ "t2606a"."a" ] COUNT 
| | ) [ "t2606a"."a" as "%1"."a" ],
| | project (
| | | table("sys"."t2606b") [ "t2606b"."a" ] COUNT 
| | ) [ "t2606b"."a" as "%2"."a" ]
| ) [ "%1"."a" as "%5"."a" ]
) [ "%5"."a" ] [ "%5"."a" ASC ]

query I rowsort
     ( select * from t2606a   intersect   select * from t2606b ) order by a
----
21
22
23

query T nosort
PLAN ( select * from t2606a ) intersect ( select * from t2606b ) order by a
----
project (
| distinct intersect (
| | project (
| | | table("sys"."t2606a") [ "t2606a"."a" ] COUNT 
| | ) [ "t2606a"."a" as "%1"."a" ],
| | project (
| | | table("sys"."t2606b") [ "t2606b"."a" ] COUNT 
| | ) [ "t2606b"."a" as "%2"."a" ]
| ) [ "%1"."a" as "%5"."a" ]
) [ "%5"."a" ] [ "%5"."a" ASC ]

query I rowsort
     ( select * from t2606a ) intersect ( select * from t2606b ) order by a
----
21
22
23

query T nosort
PLAN select * from (select * from t2606a union select * from t2606b) as t order by a
----
project (
| distinct union (
| | project (
| | | group by (
| | | | table("sys"."t2606a") [ "t2606a"."a" ] COUNT 
| | | ) [ "t2606a"."a" ] [ "t2606a"."a" ]
| | ) [ "t2606a"."a" as "%1"."a" ],
| | project (
| | | group by (
| | | | table("sys"."t2606b") [ "t2606b"."a" ] COUNT 
| | | ) [ "t2606b"."a" ] [ "t2606b"."a" ]
| | ) [ "t2606b"."a" as "%2"."a" ]
| ) [ "%1"."a" as "t"."a" ]
) [ "t"."a" ] [ "t"."a" ASC ]

query I rowsort
     select * from (select * from t2606a union select * from t2606b) as t order by a
----
11
12
13
21
22
23
31
32
33

query T nosort
PLAN select * from (select * from t2606a except select * from t2606b) as t order by a
----
project (
| distinct except (
| | project (
| | | table("sys"."t2606a") [ "t2606a"."a" ] COUNT 
| | ) [ "t2606a"."a" as "%1"."a" ],
| | project (
| | | table("sys"."t2606b") [ "t2606b"."a" ] COUNT 
| | ) [ "t2606b"."a" as "%2"."a" ]
| ) [ "%1"."a" as "t"."a" ]
) [ "t"."a" ] [ "t"."a" ASC ]

query I rowsort
     select * from (select * from t2606a except select * from t2606b) as t order by a
----
11
12
13

query T nosort
PLAN select * from (select * from t2606a intersect select * from t2606b) as t order by a
----
project (
| distinct intersect (
| | project (
| | | table("sys"."t2606a") [ "t2606a"."a" ] COUNT 
| | ) [ "t2606a"."a" as "%1"."a" ],
| | project (
| | | table("sys"."t2606b") [ "t2606b"."a" ] COUNT 
| | ) [ "t2606b"."a" as "%2"."a" ]
| ) [ "%1"."a" as "t"."a" ]
) [ "t"."a" ] [ "t"."a" ASC ]

query I rowsort
     select * from (select * from t2606a intersect select * from t2606b) as t order by a
----
21
22
23

statement ok
drop table t2606b

statement ok
drop table t2606a

