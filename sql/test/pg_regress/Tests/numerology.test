statement ok
CREATE TABLE INT2_TBL(f1 smallint)

statement ok
INSERT INTO INT2_TBL(f1) VALUES ('0   ')

statement ok
INSERT INTO INT2_TBL(f1) VALUES ('  1234 ')

statement ok
INSERT INTO INT2_TBL(f1) VALUES ('    -1234')

statement ok
INSERT INTO INT2_TBL(f1) VALUES ('32767')

statement ok
INSERT INTO INT2_TBL(f1) VALUES ('-32767')

statement ok
CREATE TABLE INT4_TBL(f1 integer)

statement ok
INSERT INTO INT4_TBL(f1) VALUES ('   0  ')

statement ok
INSERT INTO INT4_TBL(f1) VALUES ('123456     ')

statement ok
INSERT INTO INT4_TBL(f1) VALUES ('    -123456')

statement ok
INSERT INTO INT4_TBL(f1) VALUES ('2147483647')

statement ok
INSERT INTO INT4_TBL(f1) VALUES ('-2147483647')

statement ok
CREATE TABLE FLOAT8_TBL(f1 double)

statement ok
INSERT INTO FLOAT8_TBL(f1) VALUES ('    0.0   ')

statement ok
INSERT INTO FLOAT8_TBL(f1) VALUES ('1004.30  ')

statement ok
INSERT INTO FLOAT8_TBL(f1) VALUES ('   -34.84')

statement ok
INSERT INTO FLOAT8_TBL(f1) VALUES ('1.2345678901234e+200')

statement ok
INSERT INTO FLOAT8_TBL(f1) VALUES ('1.2345678901234e-200')

statement ok
CREATE TABLE TEMP_FLOAT (f1 double)

statement ok
INSERT INTO TEMP_FLOAT (f1)
  SELECT cast(f1 as double) FROM INT4_TBL

statement ok
INSERT INTO TEMP_FLOAT (f1)
  SELECT cast(f1 as double) FROM INT2_TBL

query IR rowsort
SELECT 10 AS ten, f1 FROM TEMP_FLOAT
  ORDER BY f1
----
10
-1234.000
10
-123456.000
10
-2147483647.000
10
-32767.000
10
0.000
10
0.000
10
1234.000
10
123456.000
10
2147483647.000
10
32767.000

statement ok
CREATE TABLE TEMP_INT4 (f1 integer)

statement ok
INSERT INTO TEMP_INT4 (f1)
  SELECT cast(f1 as integer) FROM FLOAT8_TBL
  WHERE (f1 > -2147483647) AND (f1 < 2147483647)

statement ok
INSERT INTO TEMP_INT4 (f1)
  SELECT cast(f1 as integer) FROM INT2_TBL

query II rowsort
SELECT 9 AS nine, f1 FROM TEMP_INT4
  ORDER BY f1
----
9
-1234
9
-32767
9
-35
9
0
9
0
9
0
9
1004
9
1234
9
32767

statement ok
CREATE TABLE TEMP_INT2 (f1 smallint)

statement ok
INSERT INTO TEMP_INT2 (f1)
  SELECT cast(f1 as smallint) FROM FLOAT8_TBL
  WHERE (f1 >= -32767) AND (f1 <= 32767)

statement ok
INSERT INTO TEMP_INT2 (f1)
  SELECT cast(f1 as smallint) FROM INT4_TBL
  WHERE (f1 >= -32767) AND (f1 <= 32767)

query II rowsort
SELECT 5 AS five, f1 FROM TEMP_INT2
  ORDER BY f1
----
5
-35
5
0
5
0
5
0
5
1004

statement ok
CREATE TABLE TEMP_GROUP (f1 integer, f2 integer, f3 double)

statement ok
INSERT INTO TEMP_GROUP
  SELECT 1, (- i.f1), (- f.f1)
  FROM INT4_TBL i, FLOAT8_TBL f

statement ok
INSERT INTO TEMP_GROUP
  SELECT 2, i.f1, f.f1
  FROM INT4_TBL i, FLOAT8_TBL f

query I rowsort
SELECT DISTINCT f1 AS two FROM TEMP_GROUP
----
1
2

query IRR rowsort
SELECT f1 AS two, max(f3) AS max_float, min(f3) as min_float
  FROM TEMP_GROUP
  GROUP BY f1
  ORDER BY two, max_float, min_float
----
1
34.840
-123456789012339998178055383778200200677029538578556143779522728938091625064448320947338361845446375953513236661280206676435709550555887864880290298685218909703795934625015156010452441377150897232019456.000
2
123456789012339998178055383778200200677029538578556143779522728938091625064448320947338361845446375953513236661280206676435709550555887864880290298685218909703795934625015156010452441377150897232019456.000
-34.840

query IRR rowsort
SELECT f1 AS two, max(f3) AS max_float, min(f3) AS min_float
  FROM TEMP_GROUP
  GROUP BY two
  ORDER BY two, max_float, min_float
----
1
34.840
-123456789012339998178055383778200200677029538578556143779522728938091625064448320947338361845446375953513236661280206676435709550555887864880290298685218909703795934625015156010452441377150897232019456.000
2
123456789012339998178055383778200200677029538578556143779522728938091625064448320947338361845446375953513236661280206676435709550555887864880290298685218909703795934625015156010452441377150897232019456.000
-34.840

query IRR rowsort
SELECT f1 AS two, (max(f3) + 1) AS max_plus_1, (min(f3) - 1) AS min_minus_1
  FROM TEMP_GROUP
  GROUP BY f1
  ORDER BY two, min_minus_1
----
1
35.840
-123456789012339998178055383778200200677029538578556143779522728938091625064448320947338361845446375953513236661280206676435709550555887864880290298685218909703795934625015156010452441377150897232019456.000
2
123456789012339998178055383778200200677029538578556143779522728938091625064448320947338361845446375953513236661280206676435709550555887864880290298685218909703795934625015156010452441377150897232019456.000
-35.840

query IIR rowsort
SELECT f1 AS two,
       max(f2) + min(f2) AS max_plus_min,
       min(f3) - 1 AS min_minus_1
  FROM TEMP_GROUP
  GROUP BY f1
  ORDER BY two, min_minus_1
----
1
0
-123456789012339998178055383778200200677029538578556143779522728938091625064448320947338361845446375953513236661280206676435709550555887864880290298685218909703795934625015156010452441377150897232019456.000
2
0
-35.840

statement ok
DROP TABLE TEMP_INT2

statement ok
DROP TABLE TEMP_INT4

statement ok
DROP TABLE TEMP_FLOAT

statement ok
DROP TABLE TEMP_GROUP

statement ok
DROP TABLE FLOAT8_TBL

statement ok
DROP TABLE INT4_TBL

statement ok
DROP TABLE INT2_TBL

