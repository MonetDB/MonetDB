statement ok
start transaction

statement ok
create table analytics (aa int, bb int)

statement ok
insert into analytics values (15, 3), (3, 1), (2, 1), (5, 3), (NULL, 2), (3, 2), (4, 1), (6, 3), (8, 2), (NULL, 4)

query TTTT rowsort
select group_concat(aa, aa) over (partition by bb),
       group_concat(aa, aa) over (partition by bb order by bb asc),
       group_concat(aa, aa) over (partition by bb order by bb desc),
       group_concat(aa, aa) over (order by bb desc) from analytics
----
155566
155566
155566
155566
155566
155566
155566
155566
155566
155566
155566
155566
32244
32244
32244
1555663388332244
32244
32244
32244
1555663388332244
32244
32244
32244
1555663388332244
388
388
388
1555663388
388
388
388
1555663388
388
388
388
1555663388
NULL
NULL
NULL
NULL

query TTTT rowsort
select group_concat(bb, bb) over (partition by bb),
       group_concat(bb, bb) over (partition by bb order by bb asc),
       group_concat(bb, bb) over (partition by bb order by bb desc),
       group_concat(bb, bb) over (order by bb desc) from analytics
----
11111
11111
11111
4333333222222111111
11111
11111
11111
4333333222222111111
11111
11111
11111
4333333222222111111
22222
22222
22222
4333333222222
22222
22222
22222
4333333222222
22222
22222
22222
4333333222222
33333
33333
33333
4333333
33333
33333
33333
4333333
33333
33333
33333
4333333
4
4
4
4

query TTTT rowsort
select group_concat(aa, bb) over (partition by bb),
       group_concat(aa, bb) over (partition by bb order by bb asc),
       group_concat(aa, bb) over (partition by bb order by bb desc),
       group_concat(aa, bb) over (order by bb desc) from analytics
----
153536
153536
153536
153536
153536
153536
153536
153536
153536
153536
153536
153536
31214
31214
31214
1535362328131214
31214
31214
31214
1535362328131214
31214
31214
31214
1535362328131214
328
328
328
1535362328
328
328
328
1535362328
328
328
328
1535362328
NULL
NULL
NULL
NULL

query TTTT rowsort
select group_concat(bb, aa) over (partition by bb),
       group_concat(bb, aa) over (partition by bb order by bb asc),
       group_concat(bb, aa) over (partition by bb order by bb desc),
       group_concat(bb, aa) over (order by bb desc) from analytics
----
12141
12141
12141
4153536323282312141
12141
12141
12141
4153536323282312141
12141
12141
12141
4153536323282312141
23282
23282
23282
4153536323282
23282
23282
23282
4153536323282
23282
23282
23282
4153536323282
35363
35363
35363
41535363
35363
35363
35363
41535363
35363
35363
35363
41535363
4
4
4
4

query TTTT rowsort
select group_concat(aa, 1) over (partition by bb),
       group_concat(aa, 1) over (partition by bb order by bb asc),
       group_concat(aa, 1) over (partition by bb order by bb desc),
       group_concat(aa, 1) over (order by bb desc) from analytics
----
151516
151516
151516
151516
151516
151516
151516
151516
151516
151516
151516
151516
31214
31214
31214
1515161318131214
31214
31214
31214
1515161318131214
31214
31214
31214
1515161318131214
318
318
318
1515161318
318
318
318
1515161318
318
318
318
1515161318
NULL
NULL
NULL
NULL

query TTTT rowsort
select group_concat(bb, -100) over (partition by bb),
       group_concat(bb, -100) over (partition by bb order by bb asc),
       group_concat(bb, -100) over (partition by bb order by bb desc),
       group_concat(bb, -100) over (order by bb desc) from analytics
----
1-1001-1001
1-1001-1001
1-1001-1001
4-1003-1003-1003-1002-1002-1002-1001-1001-1001
1-1001-1001
1-1001-1001
1-1001-1001
4-1003-1003-1003-1002-1002-1002-1001-1001-1001
1-1001-1001
1-1001-1001
1-1001-1001
4-1003-1003-1003-1002-1002-1002-1001-1001-1001
2-1002-1002
2-1002-1002
2-1002-1002
4-1003-1003-1003-1002-1002-1002
2-1002-1002
2-1002-1002
2-1002-1002
4-1003-1003-1003-1002-1002-1002
2-1002-1002
2-1002-1002
2-1002-1002
4-1003-1003-1003-1002-1002-1002
3-1003-1003
3-1003-1003
3-1003-1003
4-1003-1003-1003
3-1003-1003
3-1003-1003
3-1003-1003
4-1003-1003-1003
3-1003-1003
3-1003-1003
3-1003-1003
4-1003-1003-1003
4
4
4
4

query TTTTTT rowsort
select group_concat(aa, aa) over (),
       group_concat(bb, bb) over (),
       group_concat(aa, bb) over (),
       group_concat(bb, aa) over (),
       group_concat(aa, 1) over (),
       group_concat(aa, 1) over () from analytics
----
1533225533446688
3111133222211332244
1513123523143628
33121532324163824
1513121513141618
1513121513141618
1533225533446688
3111133222211332244
1513123523143628
33121532324163824
1513121513141618
1513121513141618
1533225533446688
3111133222211332244
1513123523143628
33121532324163824
1513121513141618
1513121513141618
1533225533446688
3111133222211332244
1513123523143628
33121532324163824
1513121513141618
1513121513141618
1533225533446688
3111133222211332244
1513123523143628
33121532324163824
1513121513141618
1513121513141618
1533225533446688
3111133222211332244
1513123523143628
33121532324163824
1513121513141618
1513121513141618
1533225533446688
3111133222211332244
1513123523143628
33121532324163824
1513121513141618
1513121513141618
1533225533446688
3111133222211332244
1513123523143628
33121532324163824
1513121513141618
1513121513141618
1533225533446688
3111133222211332244
1513123523143628
33121532324163824
1513121513141618
1513121513141618
1533225533446688
3111133222211332244
1513123523143628
33121532324163824
1513121513141618
1513121513141618

query TTTTT rowsort
select group_concat(NULL, 2) over (),
       group_concat(2, NULL) over (),
       group_concat(aa, NULL) over (),
       group_concat(NULL, aa) over (),
       group_concat(NULL, NULL) over () from analytics
----
NULL
2222222222
153253468
NULL
NULL
NULL
2222222222
153253468
NULL
NULL
NULL
2222222222
153253468
NULL
NULL
NULL
2222222222
153253468
NULL
NULL
NULL
2222222222
153253468
NULL
NULL
NULL
2222222222
153253468
NULL
NULL
NULL
2222222222
153253468
NULL
NULL
NULL
2222222222
153253468
NULL
NULL
NULL
2222222222
153253468
NULL
NULL
NULL
2222222222
153253468
NULL
NULL

statement ok
create table testmore (a int, b clob)

statement ok
insert into testmore values (1, 'another'), (1, 'testing'), (1, 'todo'), (2, 'lets'), (3, 'get'), (2, 'harder'), (3, 'even'), (2, 'more'), (1, ''), (3, 'even'), (2, NULL), (1, '')

query ITTTT rowsort
select a, listagg(a) over (),
       listagg(a) over (order by a),
       listagg(a, min(b)) over (),
       listagg(a, min(b)) over (partition by max(b)) from testmore group by a
----
1
3,2,1
1
3harder21
1
2
3,2,1
1,2
3harder21
2
3
3,2,1
1,2,3
3harder21
3

statement ok
rollback

