statement ok
create table ranktest ( id int, k string)

statement ok
COPY 27 RECORDS INTO ranktest FROM stdin USING DELIMITERS '|',E'\n'
<COPY_INTO_DATA>
1061|varchar
1061|int
1061|varchar
1061|varchar
1061|int
1061|int
1061|varchar
1061|varchar
1061|boolean
1061|boolean
1061|int
1061|varchar
1061|char
1062|int
1062|char
1062|char
1062|int
1062|smallint
1062|boolean
1062|smallint
1061|int
1061|varchar
1061|int
1061|varchar
1061|int
1061|int
1061|smallint

query I rowsort
select count(*) from ranktest
----
27

query I nosort
select ROW_NUMBER() over () as foo from ranktest order by foo
----
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27

query II nosort
select ROW_NUMBER() over (PARTITION BY id) as foo, id from ranktest order by foo, id
----
1
1061
1
1062
2
1061
2
1062
3
1061
3
1062
4
1061
4
1062
5
1061
5
1062
6
1061
6
1062
7
1061
7
1062
8
1061
9
1061
10
1061
11
1061
12
1061
13
1061
14
1061
15
1061
16
1061
17
1061
18
1061
19
1061
20
1061

query II nosort
select ROW_NUMBER() over (PARTITION BY id ORDER BY id) as foo, id from ranktest order by foo, id
----
1
1061
1
1062
2
1061
2
1062
3
1061
3
1062
4
1061
4
1062
5
1061
5
1062
6
1061
6
1062
7
1061
7
1062
8
1061
9
1061
10
1061
11
1061
12
1061
13
1061
14
1061
15
1061
16
1061
17
1061
18
1061
19
1061
20
1061

query II nosort
select ROW_NUMBER() over (ORDER BY id) as foo, id from ranktest order by foo, id
----
1
1061
2
1061
3
1061
4
1061
5
1061
6
1061
7
1061
8
1061
9
1061
10
1061
11
1061
12
1061
13
1061
14
1061
15
1061
16
1061
17
1061
18
1061
19
1061
20
1061
21
1062
22
1062
23
1062
24
1062
25
1062
26
1062
27
1062

query I nosort
select RANK() over () as foo from ranktest order by foo
----
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1

query II nosort
select RANK() over (PARTITION BY id) as foo, id from ranktest order by foo, id
----
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1062
1
1062
1
1062
1
1062
1
1062
1
1062
1
1062

query II nosort
select RANK() over (PARTITION BY id ORDER BY id) as foo, id from ranktest order by foo, id
----
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1062
1
1062
1
1062
1
1062
1
1062
1
1062
1
1062

query II nosort
select RANK() over (ORDER BY id) as foo, id from ranktest order by foo, id
----
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
1
1061
21
1062
21
1062
21
1062
21
1062
21
1062
21
1062
21
1062

query IIT nosort
select RANK() over () as foo, id, k from ranktest order by foo, id, k
----
1
1061
boolean
1
1061
boolean
1
1061
char
1
1061
int
1
1061
int
1
1061
int
1
1061
int
1
1061
int
1
1061
int
1
1061
int
1
1061
int
1
1061
smallint
1
1061
varchar
1
1061
varchar
1
1061
varchar
1
1061
varchar
1
1061
varchar
1
1061
varchar
1
1061
varchar
1
1061
varchar
1
1062
boolean
1
1062
char
1
1062
char
1
1062
int
1
1062
int
1
1062
smallint
1
1062
smallint

query IIT nosort
select RANK() over (PARTITION BY id) as foo, id, k from ranktest order by foo, id, k
----
1
1061
boolean
1
1061
boolean
1
1061
char
1
1061
int
1
1061
int
1
1061
int
1
1061
int
1
1061
int
1
1061
int
1
1061
int
1
1061
int
1
1061
smallint
1
1061
varchar
1
1061
varchar
1
1061
varchar
1
1061
varchar
1
1061
varchar
1
1061
varchar
1
1061
varchar
1
1061
varchar
1
1062
boolean
1
1062
char
1
1062
char
1
1062
int
1
1062
int
1
1062
smallint
1
1062
smallint

query IIT nosort
select RANK() over (PARTITION BY id ORDER BY id, k) as foo, id, k from ranktest order by foo, id, k
----
1
1061
boolean
1
1061
boolean
1
1062
boolean
2
1062
char
2
1062
char
3
1061
char
4
1061
int
4
1061
int
4
1061
int
4
1061
int
4
1061
int
4
1061
int
4
1061
int
4
1061
int
4
1062
int
4
1062
int
6
1062
smallint
6
1062
smallint
12
1061
smallint
13
1061
varchar
13
1061
varchar
13
1061
varchar
13
1061
varchar
13
1061
varchar
13
1061
varchar
13
1061
varchar
13
1061
varchar

query IIT nosort
select RANK() over (ORDER BY id, k) as foo, id, k from ranktest order by foo, id, k
----
1
1061
boolean
1
1061
boolean
3
1061
char
4
1061
int
4
1061
int
4
1061
int
4
1061
int
4
1061
int
4
1061
int
4
1061
int
4
1061
int
12
1061
smallint
13
1061
varchar
13
1061
varchar
13
1061
varchar
13
1061
varchar
13
1061
varchar
13
1061
varchar
13
1061
varchar
13
1061
varchar
21
1062
boolean
22
1062
char
22
1062
char
24
1062
int
24
1062
int
26
1062
smallint
26
1062
smallint

query IIT nosort
select DENSE_RANK() over () as foo, id, k from ranktest order by k, foo, id
----
1
1061
boolean
1
1061
boolean
1
1062
boolean
1
1061
char
1
1062
char
1
1062
char
1
1061
int
1
1061
int
1
1061
int
1
1061
int
1
1061
int
1
1061
int
1
1061
int
1
1061
int
1
1062
int
1
1062
int
1
1061
smallint
1
1062
smallint
1
1062
smallint
1
1061
varchar
1
1061
varchar
1
1061
varchar
1
1061
varchar
1
1061
varchar
1
1061
varchar
1
1061
varchar
1
1061
varchar

query IIT nosort
select DENSE_RANK() over (PARTITION BY id) as foo, id, k from ranktest order by k, foo, id
----
1
1061
boolean
1
1061
boolean
1
1062
boolean
1
1061
char
1
1062
char
1
1062
char
1
1061
int
1
1061
int
1
1061
int
1
1061
int
1
1061
int
1
1061
int
1
1061
int
1
1061
int
1
1062
int
1
1062
int
1
1061
smallint
1
1062
smallint
1
1062
smallint
1
1061
varchar
1
1061
varchar
1
1061
varchar
1
1061
varchar
1
1061
varchar
1
1061
varchar
1
1061
varchar
1
1061
varchar

query IIT nosort
select DENSE_RANK() over (PARTITION BY id ORDER BY id, k) as foo, id, k from ranktest order by k, foo, id
----
1
1061
boolean
1
1061
boolean
1
1062
boolean
2
1061
char
2
1062
char
2
1062
char
3
1061
int
3
1061
int
3
1061
int
3
1061
int
3
1061
int
3
1061
int
3
1061
int
3
1061
int
3
1062
int
3
1062
int
4
1061
smallint
4
1062
smallint
4
1062
smallint
5
1061
varchar
5
1061
varchar
5
1061
varchar
5
1061
varchar
5
1061
varchar
5
1061
varchar
5
1061
varchar
5
1061
varchar

query IIT nosort
select DENSE_RANK() over (ORDER BY id, k) as foo, id, k from ranktest order by k, foo, id
----
1
1061
boolean
1
1061
boolean
6
1062
boolean
2
1061
char
7
1062
char
7
1062
char
3
1061
int
3
1061
int
3
1061
int
3
1061
int
3
1061
int
3
1061
int
3
1061
int
3
1061
int
8
1062
int
8
1062
int
4
1061
smallint
9
1062
smallint
9
1062
smallint
5
1061
varchar
5
1061
varchar
5
1061
varchar
5
1061
varchar
5
1061
varchar
5
1061
varchar
5
1061
varchar
5
1061
varchar

statement ok
drop table ranktest


