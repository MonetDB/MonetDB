START TRANSACTION;

CREATE TABLE all_dates (d_date date, month_code varchar(7));
CREATE TABLE book (code varchar(15));
CREATE TABLE category (id bigint, category_code varchar(30), subcategory_code varchar(30));
CREATE TABLE fact (s1_id varchar(25), s2_id varchar(25), s3_id varchar(25), s4_id varchar(25), book_code varchar(15), category_id bigint, location_id bigint, d_period date);
CREATE TABLE location (id bigint, code varchar(30));
CREATE TABLE segment1 (id varchar(150), code varchar(150));
CREATE TABLE segment2 (id varchar(150), code varchar(150));
CREATE TABLE segment3 (id varchar(150), code varchar(150));
CREATE TABLE segment4 (id varchar(150), code varchar(150));

COPY 431 RECORDS INTO category FROM STDIN DELIMITERS '|' , E'\n', '"';
3273|"70"|"430"
3274|"70"|"612"
3275|"70"|"565"
3276|"70"|"330"
3277|"70"|"616"
3278|"70"|"611"
3279|"70"|"420"
3280|"70"|"614"
3281|"70"|"443"
3282|"70"|"444"
3283|"70"|"442"
3284|"70"|"540"
3285|"70"|"620"
3286|"70"|"618"
3287|"70"|"330"
3288|"70"|"530"
3289|"70"|"473"
3290|"70"|"670"
3291|"70"|"442"
3292|"70"|"471"
3293|"70"|"444"
3294|"70"|"444"
3295|"70"|"460"
3296|"70"|"616"
3297|"70"|"655"
3298|"70"|"617"
3299|"70"|"540"
3300|"70"|"670"
3301|"70"|"430"
3302|"70"|"460"
3303|"70"|"560"
3304|"70"|"617"
3305|"70"|"560"
3306|"70"|"550"
3307|"70"|"450"
3308|"70"|"652"
3309|"70"|"614"
3310|"70"|"440"
3311|"70"|"540"
3312|"70"|"611"
3313|"70"|"611"
3314|"70"|"660"
3315|"70"|"612"
3316|"70"|"672"
3317|"70"|"551"
3318|"70"|"443"
3319|"70"|"672"
3320|"70"|"650"
3321|"70"|"513"
3322|"70"|"220"
3323|"70"|"420"
3324|"70"|"612"
3325|"70"|"516"
3326|"70"|"655"
3327|"70"|"660"
3328|"70"|"580"
3329|"70"|"472"
3330|"70"|"444"
3331|"70"|"441"
3332|"70"|"440"
3333|"70"|"440"
3334|"70"|"551"
3335|"70"|"610"
3336|"70"|"655"
3337|"70"|"580"
3338|"70"|"660"
3339|"70"|"565"
3340|"70"|"619"
3341|"70"|"610"
3342|"70"|"671"
3343|"70"|"910"
3344|"70"|"472"
3345|"70"|"650"
3346|"70"|"450"
3347|"70"|"220"
3348|"70"|"410"
3349|"70"|"210"
3350|"70"|"650"
3351|"70"|"410"
3352|"70"|"615"
3353|"70"|"613"
3354|"70"|"580"
3355|"70"|"472"
3356|"70"|"430"
3357|"70"|"530"
3358|"70"|"619"
3359|"70"|"442"
3360|"70"|"615"
3361|"70"|"513"
3362|"70"|"550"
3363|"70"|"618"
3364|"70"|"611"
3365|"70"|"672"
3366|"70"|"330"
3367|"70"|"654"
3368|"70"|"652"
3369|"70"|"450"
3370|"70"|"565"
3371|"70"|"651"
3372|"70"|"550"
3373|"70"|"430"
3374|"70"|"660"
3375|"70"|"471"
3376|"70"|"551"
3377|"70"|"420"
3378|"70"|"443"
3379|"70"|"619"
3380|"70"|"441"
3381|"70"|"616"
3382|"70"|"910"
3383|"70"|"472"
3384|"70"|"654"
3385|"70"|"621"
3386|"70"|"910"
3387|"70"|"653"
3388|"70"|"471"
3389|"70"|"617"
3390|"70"|"440"
3391|"70"|"310"
3392|"70"|"613"
3393|"70"|"510"
3394|"70"|"470"
3395|"70"|"575"
3396|"70"|"540"
3397|"70"|"672"
3398|"70"|"654"
3399|"70"|"441"
3400|"70"|"615"
3401|"70"|"530"
3402|"70"|"616"
3403|"70"|"654"
3404|"70"|"671"
3405|"70"|"614"
3406|"70"|"410"
3407|"70"|"610"
3408|"70"|"653"
3409|"70"|"530"
3410|"70"|"651"
3411|"70"|"651"
3412|"70"|"510"
3413|"70"|"671"
3414|"70"|"621"
3415|"70"|"420"
3416|"70"|"652"
3417|"70"|"670"
3418|"70"|"614"
3419|"70"|"551"
3420|"70"|"620"
3421|"70"|"320"
3422|"70"|"473"
3423|"20"|"236"
3424|"40"|"441"
3425|"40"|"441"
3426|"20"|"237"
3427|"40"|"424"
3428|"10"|"100"
3429|"10"|"100"
3430|"20"|"268"
3431|"40"|"413"
3432|"40"|"413"
3433|"40"|"414"
3434|"40"|"414"
3435|"30"|"365"
3436|"30"|"325"
3437|"30"|"326"
3438|"20"|"229"
3439|"20"|"226"
3440|"20"|"200"
3441|"30"|"366"
3442|"20"|"262"
3443|"20"|"261"
3444|"30"|"326"
3445|"20"|"251"
1001|"70"|"210"
3001|"10"|"110"
3003|"10"|"110"
3005|"10"|"120"
1|"30"|"301"
3007|"10"|"120"
3008|"10"|"130"
3009|"10"|"130"
3010|"10"|"140"
3011|"10"|"140"
3012|"10"|"140"
3013|"10"|"140"
3014|"10"|"150"
3015|"10"|"150"
3016|"10"|"160"
3017|"10"|"160"
3018|"30"|"350"
3021|"20"|"270"
3022|"20"|"270"
3023|"20"|"290"
3024|"20"|"290"
3025|"20"|"290"
3026|"20"|"290"
3027|"30"|"320"
3028|"30"|"320"
3029|"30"|"320"
3030|"30"|"320"
3034|"30"|"340"
3035|"30"|"340"
3036|"30"|"340"
3037|"30"|"340"
3038|"30"|"350"
3039|"30"|"350"
3040|"30"|"350"
3041|"40"|"420"
3042|"40"|"420"
3043|"40"|"420"
3044|"40"|"420"
3045|"40"|"430"
3046|"40"|"430"
3047|"40"|"430"
3048|"40"|"430"
3050|"20"|"200"
3051|"20"|"200"
3052|"20"|"210"
3053|"40"|"450"
3054|"40"|"450"
3055|"40"|"450"
3056|"40"|"450"
3057|"10"|"100"
3058|"10"|"100"
3059|"30"|"320"
3060|"40"|"420"
3061|"20"|"221"
3062|"20"|"221"
3063|"10"|"120"
3064|"10"|"120"
3065|"30"|"349"
3066|"20"|"229"
3067|"20"|"269"
3068|"40"|"401"
3069|"40"|"442"
3070|"40"|"442"
3071|"40"|"442"
3072|"20"|"221"
3074|"40"|"421"
3075|"40"|"421"
3076|"40"|"422"
3077|"40"|"422"
3078|"40"|"423"
3079|"40"|"423"
3080|"40"|"424"
3081|"20"|"226"
3082|"20"|"279"
3083|"20"|"283"
3084|"20"|"283"
3085|"20"|"284"
3086|"20"|"284"
3087|"30"|"301"
3088|"30"|"302"
3089|"30"|"302"
3090|"30"|"312"
3091|"30"|"312"
3092|"30"|"313"
3093|"30"|"313"
3094|"40"|"411"
3095|"40"|"411"
3096|"40"|"411"
3100|"30"|"330"
3101|"30"|"330"
2002|"20"|"220"
3102|"30"|"330"
3103|"30"|"330"
3104|"40"|"440"
3105|"40"|"440"
3106|"40"|"440"
3107|"40"|"440"
3108|"30"|"364"
3109|"70"|"516"
3110|"70"|"443"
3111|"70"|"575"
3112|"70"|"210"
3114|"70"|"473"
3115|"70"|"560"
3119|"70"|"613"
3120|"70"|"310"
3121|"70"|"612"
3122|"70"|"442"
3123|"70"|"671"
3124|"70"|"460"
3125|"70"|"651"
3126|"70"|"470"
3127|"70"|"617"
3128|"70"|"320"
3129|"70"|"621"
3130|"70"|"441"
3131|"70"|"653"
3132|"70"|"470"
3133|"70"|"510"
3134|"70"|"550"
3135|"70"|"575"
3136|"70"|"655"
3137|"70"|"650"
3138|"70"|"560"
3139|"70"|"513"
3140|"70"|"618"
3141|"70"|"575"
3142|"70"|"470"
3143|"70"|"670"
3144|"70"|"610"
3145|"70"|"620"
3146|"70"|"615"
3147|"70"|"565"
3148|"70"|"652"
3149|"70"|"460"
3150|"70"|"471"
3151|"70"|"516"
3152|"70"|"619"
3153|"70"|"613"
3154|"70"|"473"
3155|"70"|"910"
3156|"30"|"311"
3157|"30"|"311"
3158|"30"|"361"
3159|"30"|"361"
3160|"30"|"362"
3161|"30"|"362"
3162|"30"|"363"
3163|"30"|"363"
3164|"30"|"364"
3165|"30"|"364"
3166|"40"|"401"
3167|"40"|"401"
3168|"40"|"402"
3169|"40"|"402"
3170|"40"|"411"
3171|"40"|"411"
3172|"40"|"412"
3173|"40"|"412"
3174|"40"|"441"
3175|"40"|"441"
3176|"20"|"253"
3177|"20"|"253"
3178|"20"|"261"
3179|"20"|"261"
3180|"20"|"262"
3181|"20"|"262"
3182|"20"|"263"
3183|"20"|"263"
3184|"20"|"264"
3185|"20"|"264"
3186|"20"|"265"
3187|"20"|"265"
3188|"20"|"266"
3189|"20"|"266"
3190|"20"|"267"
3191|"20"|"267"
3192|"20"|"281"
3193|"20"|"281"
3194|"20"|"282"
3195|"20"|"282"
3196|"40"|"401"
3197|"20"|"251"
3198|"20"|"254"
3199|"10"|"120"
3200|"20"|"255"
3201|"40"|"412"
3202|"40"|"424"
3203|"20"|"256"
3204|"40"|"412"
3205|"30"|"362"
3206|"40"|"425"
3207|"40"|"425"
3208|"30"|"365"
3209|"20"|"251"
3210|"30"|"365"
3211|"40"|"412"
3212|"40"|"423"
3213|"40"|"423"
3214|"20"|"256"
3215|"40"|"424"
3216|"30"|"322"
3217|"30"|"324"
3218|"30"|"340"
3219|"30"|"340"
3220|"30"|"340"
3221|"30"|"340"
3222|"20"|"227"
3223|"30"|"303"
3224|"20"|"222"
3225|"20"|"222"
3226|"20"|"223"
3227|"20"|"223"
3228|"20"|"224"
3229|"20"|"224"
3230|"20"|"225"
3231|"20"|"225"
3232|"20"|"231"
3233|"20"|"231"
3234|"20"|"232"
3235|"20"|"232"
3236|"20"|"233"
3237|"20"|"233"
3238|"20"|"234"
3239|"20"|"234"
3240|"20"|"235"
3241|"20"|"235"
3242|"20"|"241"
3243|"20"|"241"
3244|"20"|"242"
3245|"20"|"242"
3246|"20"|"259"
3247|"40"|"411"
3248|"30"|"363"
3249|"30"|"363"
3250|"30"|"340"
3251|"30"|"340"
3252|"70"|"510"
3253|"70"|"653"
3254|"70"|"210"
3255|"70"|"220"
3256|"70"|"220"
3257|"70"|"310"
3258|"70"|"310"
3259|"70"|"320"
3260|"70"|"320"
3261|"70"|"330"
3262|"30"|"324"
3263|"20"|"236"
3264|"20"|"237"
3265|"70"|"516"
3266|"70"|"580"
3267|"70"|"620"
3268|"70"|"450"
3269|"70"|"621"
3270|"70"|"513"
3271|"70"|"410"
3272|"70"|"618"

COPY 5 RECORDS INTO book FROM STDIN DELIMITERS '|' , E'\n', '"';
"G1KORP"
"G2FIN"
"G3PARV"
"G4NEG"
"MVE"

COPY 22 RECORDS INTO fact FROM STDIN DELIMITERS '|' , E'\n', '"';
"10"|"3480"|"7443"|"00000"|"MVE"|1001|2002|2016-02-16
"10"|"3480"|"7443"|"00000"|"MVE"|1001|2002|2016-03-16
"10"|"3480"|"7443"|"00000"|"MVE"|1001|2002|2016-04-16
"10"|"3480"|"7443"|"00000"|"MVE"|1001|2002|2016-05-16
"10"|"3480"|"7443"|"00000"|"MVE"|1001|2002|2016-06-16
"10"|"3480"|"7443"|"00000"|"MVE"|1001|2002|2016-07-16
"10"|"3480"|"7443"|"00000"|"MVE"|1001|2002|2016-08-16
"10"|"3480"|"7443"|"00000"|"MVE"|1001|2002|2016-09-16
"10"|"3480"|"7443"|"00000"|"MVE"|1001|2002|2016-10-16
"10"|"3480"|"7443"|"00000"|"MVE"|1001|2002|2016-11-16
"10"|"1300"|"7422"|"00000"|"G2FIN"|1|3001|2016-02-16
"10"|"1300"|"7422"|"00000"|"G2FIN"|1|3001|2016-03-16
"10"|"1300"|"7422"|"00000"|"G2FIN"|1|3001|2016-04-16
"10"|"1300"|"7422"|"00000"|"G2FIN"|1|3001|2016-05-16
"10"|"1300"|"7422"|"00000"|"G2FIN"|1|3001|2016-06-16
"10"|"1300"|"7422"|"00000"|"G2FIN"|1|3001|2016-07-16
"10"|"1300"|"7422"|"00000"|"G2FIN"|1|3001|2016-08-16
"10"|"1300"|"7422"|"00000"|"G2FIN"|1|3001|2016-09-16
"10"|"1300"|"7422"|"00000"|"G2FIN"|1|3001|2016-10-16
"10"|"1300"|"7422"|"00000"|"G2FIN"|1|3001|2016-11-16
"10"|"3480"|"7443"|"00000"|"MVE"|1001|2002|2016-01-16
"10"|"1300"|"7422"|"00000"|"G2FIN"|1|3001|2016-01-16

COPY 729 RECORDS INTO location FROM STDIN DELIMITERS '|' , E'\n', '"';
12026|"(n/z)"
3001|"(n/z)"
10020|"0010093"
10045|"0010094"
10053|"0010094"
10082|"0010095"
10122|"0010095"
10123|"0130000"
10124|"(n/z)"
10132|"(n/z)"
8001|"(n/z)"
10146|"(n/z)"
10151|"(n/z)"
10152|"(n/z)"
10153|"(n/z)"
10157|"(n/z)"
10174|"(n/z)"
10186|"(n/z)"
10256|"0010094"
10271|"0170000"
9001|"0010094"
10274|"0170000"
10277|"(n/z)"
10298|"(n/z)"
10326|"0010094"
10339|"(n/z)"
10346|"(n/z)"
10348|"(n/z)"
10355|"(n/z)"
10360|"0010094"
10368|"(n/z)"
10372|"(n/z)"
10375|"0010094"
10376|"0406400"
10385|"(n/z)"
10386|"0406400"
10387|"0406400"
10388|"0010093"
10406|"0010094"
4001|"(n/z)"
10413|"0010094"
10420|"0130000"
10478|"0840286"
10489|"0941674"
10495|"0941615"
10501|"0010094"
10503|"0010094"
10509|"(n/z)"
10516|"0010094"
10527|"0010094"
10559|"0010094"
10657|"0406400"
10676|"0010094"
12001|"0780288"
12002|"(n/z)"
12003|"(n/z)"
12004|"(n/z)"
12005|"0806968"
12006|"(n/z)"
12007|"0566994"
12008|"0840286"
12009|"(n/z)"
12010|"(n/z)"
12011|"(n/z)"
12012|"(n/z)"
12013|"(n/z)"
12014|"(n/z)"
12015|"(n/z)"
12016|"0840625"
12017|"0566994"
12018|"0566994"
12019|"0540286"
12020|"0809200"
12021|"(n/z)"
12022|"0766362"
12023|"(n/z)"
12024|"(n/z)"
12025|"0766370"
12027|"0766376"
12028|"0780276"
12029|"(n/z)"
12030|"(n/z)"
5001|"(n/z)"
10001|"(n/z)"
10002|"0540270"
10003|"(n/z)"
10004|"0326146"
10005|"0440268"
10006|"0840296"
10007|"0800856"
10008|"0360288"
10009|"0540258"
10010|"0540262"
10011|"0460254"
10012|"0566994"
10013|"0806968"
10014|"0621278"
10015|"0806968"
10016|"0808400"
10017|"0806968"
10018|"0806968"
10019|"0806968"
10021|"0806968"
10022|"0801817"
10023|"0566994"
10024|"0460252"
10025|"0427372"
10026|"0806968"
10027|"0941674"
10028|"0806968"
10029|"0460254"
10030|"0460268"
10031|"0941674"
10032|"0740625"
10033|"0540270"
10034|"0840286"
10035|"0806968"
10036|"0326160"
10037|"0741433"
10038|"0964762"
10039|"0840296"
10040|"0840625"
10041|"0546778"
10042|"0326160"
10043|"0546744"
10044|"0090000"
10046|"(n/z)"
10047|"0740625"
10048|"0540252"
10049|"0130000"
10050|"0761266"
10051|"0540286"
10052|"0420290"
10054|"0360848"
10055|"0621278"
10056|"0760258"
10057|"0360288"
10058|"0801694"
10059|"0326160"
10060|"0964762"
10061|"0800856"
10062|"0460252"
10063|"0806968"
10064|"(n/z)"
10065|"0801231"
10066|"0641076"
10067|"0406400"
10068|"0641076"
10069|"0427776"
10070|"0806968"
10071|"0427776"
10072|"0809600"
10073|"0840286"
10074|"0760258"
10075|"0406400"
10076|"0640888"
10077|"0326146"
10078|"0941680"
10079|"0840605"
10080|"0941674"
10081|"0801864"
10083|"0809200"
10084|"0806968"
10085|"0801864"
10086|"0809200"
10087|"0801694"
10088|"(n/z)"
10089|"(n/z)"
10090|"0010094"
10091|"(n/z)"
10092|"(n/z)"
10093|"0801864"
10094|"(n/z)"
10095|"(n/z)"
10096|"(n/z)"
10097|"0130000"
10098|"(n/z)"
10099|"(n/z)"
10100|"(n/z)"
10101|"(n/z)"
10102|"(n/z)"
10103|"(n/z)"
10104|"(n/z)"
10105|"(n/z)"
10106|"(n/z)"
10107|"0806968"
10108|"0806968"
10109|"(n/z)"
10110|"(n/z)"
10111|"(n/z)"
10112|"(n/z)"
10113|"(n/z)"
10114|"(n/z)"
10115|"(n/z)"
10116|"0800856"
10117|"(n/z)"
10118|"0967190"
10119|"(n/z)"
10120|"0808400"
10121|"0806968"
10125|"0964762"
10126|"0809200"
10127|"(n/z)"
10128|"0801231"
10129|"(n/z)"
10130|"(n/z)"
10131|"(n/z)"
10133|"0806968"
10134|"(n/z)"
10135|"0809600"
8002|"(n/z)"
10136|"0360288"
10137|"(n/z)"
10138|"0806968"
10139|"0941674"
10140|"0806968"
10141|"0460252"
10142|"(n/z)"
10143|"0806968"
10144|"(n/z)"
10145|"0320244"
10147|"(n/z)"
10148|"(n/z)"
10149|"(n/z)"
10150|"(n/z)"
10154|"(n/z)"
10155|"0440268"
10156|"0170000"
10158|"(n/z)"
10159|"0360288"
10160|"0780252"
10161|"0741433"
10162|"0421262"
10163|"0424746"
10164|"0421262"
10165|"0780278"
10166|"0941670"
10167|"0360825"
10168|"0420290"
10169|"0801694"
10170|"0967190"
10171|"(n/z)"
10172|"(n/z)"
10173|"(n/z)"
10175|"(n/z)"
10176|"0967178"
10177|"0769190"
10178|"0967190"
10179|"0427364"
10180|"0967372"
10181|"0961658"
10182|"0320244"
10183|"0780278"
10184|"0360890"
10185|"(n/z)"
10187|"0427394"
10188|"0761266"
10189|"(n/z)"
10190|"0460268"
10191|"0809600"
10192|"0640668"
10193|"0800625"
10194|"(n/z)"
10195|"0621229"
10196|"(n/z)"
10197|"0769164"
10198|"(n/z)"
10199|"0424746"
10200|"(n/z)"
10201|"0621278"
10202|"0941670"
10203|"0740252"
10204|"(n/z)"
10205|"0566994"
10206|"0809200"
10207|"(n/z)"
10208|"(n/z)"
10209|"(n/z)"
10210|"(n/z)"
10211|"(n/z)"
10212|"0540270"
10213|"(n/z)"
10214|"0740280"
10215|"0809200"
10216|"0801864"
10217|"(n/z)"
10218|"0741464"
10219|"0641076"
10220|"0406400"
10221|"0808400"
10222|"(n/z)"
10223|"0900248"
10224|"(n/z)"
10225|"0360825"
10226|"0460254"
10227|"0566968"
10228|"0761211"
10229|"0801231"
10230|"0769164"
10231|"(n/z)"
10232|"0360288"
10233|"0326160"
10234|"0740625"
10235|"(n/z)"
10236|"0566996"
10237|"0809600"
10238|"0967178"
10239|"0840266"
10240|"0800625"
10241|"0321442"
10242|"0440268"
10243|"(n/z)"
10244|"0967372"
10245|"0806968"
10246|"0806968"
10247|"0766362"
10248|"0360288"
10249|"0769164"
10250|"0840266"
10251|"(n/z)"
10252|"(n/z)"
10253|"(n/z)"
10254|"0621229"
10255|"0801231"
10257|"(n/z)"
10258|"(n/z)"
10259|"0321458"
10260|"0320244"
10261|"0321442"
10262|"0427776"
10263|"(n/z)"
10264|"0769194"
10265|"0801231"
10266|"0427372"
10267|"0328200"
10268|"(n/z)"
10269|"0440262"
10270|"(n/z)"
10272|"(n/z)"
9002|"0460252"
10273|"0326146"
10275|"(n/z)"
10276|"(n/z)"
10278|"0566968"
10279|"0546778"
10280|"0460268"
10281|"(n/z)"
10282|"(n/z)"
10283|"(n/z)"
10284|"(n/z)"
10285|"(n/z)"
10286|"(n/z)"
10287|"(n/z)"
10288|"0801231"
10289|"0941648"
10290|"0427364"
10291|"(n/z)"
10292|"0421262"
10293|"0801231"
10294|"(n/z)"
10295|"0761211"
10296|"(n/z)"
10297|"0640850"
10299|"0769194"
10300|"0540256"
10301|"0546778"
10302|"0540282"
10303|"(n/z)"
10304|"(n/z)"
10305|"0740280"
10306|"0460268"
10307|"0320244"
10308|"(n/z)"
10309|"0801864"
10310|"(n/z)"
10311|"0406400"
10312|"0326146"
10313|"0546778"
10314|"0420290"
10315|"0621282"
10316|"0801864"
10317|"0941658"
10318|"0540270"
10319|"0800856"
10320|"0440268"
10321|"0967178"
10322|"(n/z)"
10323|"(n/z)"
10324|"0170000"
10325|"(n/z)"
10327|"(n/z)"
10328|"0421262"
10329|"0460268"
10330|"0840286"
10331|"(n/z)"
10332|"0427364"
10333|"0761266"
10334|"0840266"
10335|"0761286"
10336|"(n/z)"
10337|"(n/z)"
10338|"(n/z)"
10340|"(n/z)"
10341|"0840286"
10342|"0641076"
10343|"0967190"
10344|"(n/z)"
10345|"(n/z)"
10347|"0641076"
10349|"(n/z)"
10350|"0460260"
10351|"0360890"
10352|"0460268"
10353|"0769164"
10354|"0427394"
10356|"(n/z)"
10357|"(n/z)"
10358|"(n/z)"
10359|"(n/z)"
10361|"(n/z)"
10362|"(n/z)"
10363|"(n/z)"
10364|"(n/z)"
10365|"(n/z)"
10366|"(n/z)"
10367|"0406400"
10369|"(n/z)"
10370|"0546744"
10371|"0804988"
10373|"(n/z)"
10374|"0741084"
10377|"(n/z)"
10378|"(n/z)"
10379|"0320244"
10380|"(n/z)"
10381|"(n/z)"
10382|"(n/z)"
10383|"0840680"
10384|"0840266"
10389|"0640666"
10390|"(n/z)"
10391|"0769164"
10392|"0621282"
10393|"0427360"
10394|"0769194"
10395|"0090000"
10396|"0809600"
10397|"0741464"
10398|"0809200"
10399|"0320244"
10400|"0900248"
10401|"0210000"
10402|"0801231"
10403|"0566996"
10404|"0326160"
10405|"0806968"
10407|"0760258"
10408|"0800856"
6001|"(n/z)"
7001|"(n/z)"
10409|"0741464"
10410|"0740625"
10411|"0360288"
10412|"0806968"
10414|"0741433"
10415|"0440270"
10416|"0460252"
10417|"0740605"
10418|"0326160"
10419|"0621278"
10421|"0427364"
10422|"0900248"
10424|"0440270"
10425|"0804988"
10426|"(n/z)"
10427|"(n/z)"
10429|"0740280"
10431|"0427364"
10432|"(n/z)"
10433|"(n/z)"
10434|"0010094"
10435|"0427394"
10436|"0170000"
10437|"(n/z)"
10438|"(n/z)"
10439|"(n/z)"
10440|"(n/z)"
10441|"(n/z)"
10442|"0800625"
10443|"0427394"
10444|"0427776"
10445|"(n/z)"
10446|"0360890"
10447|"0967190"
10448|"0967148"
10449|"0427372"
10450|"0806968"
10451|"0800625"
10452|"(n/z)"
10453|"(n/z)"
10454|"0360288"
10455|"0360890"
10456|"0769194"
10457|"0740252"
10458|"0400260"
10459|"0400250"
10460|"0400250"
10461|"0941674"
10462|"0360288"
10463|"0800625"
10464|"0800625"
10465|"0421262"
10466|"0566994"
10467|"0320244"
10468|"0427360"
10469|"0800856"
10470|"0540252"
10471|"(n/z)"
10472|"(n/z)"
10473|"(n/z)"
10474|"0400252"
10475|"0400250"
10476|"0400250"
10477|"0406400"
10479|"0801694"
10480|"0806968"
10481|"0806968"
10482|"0760201"
10483|"(n/z)"
10485|"(n/z)"
10486|"0400252"
10487|"(n/z)"
10488|"0326146"
10490|"0801694"
10491|"(n/z)"
10492|"0400260"
10493|"0400250"
10494|"0400252"
10496|"(n/z)"
10497|"0809200"
10498|"0840286"
10499|"(n/z)"
10502|"0760201"
10504|"0010094"
10505|"0967190"
10506|"(n/z)"
10507|"0967190"
10508|"0806968"
10510|"0801694"
10511|"(n/z)"
10512|"(n/z)"
10513|"0010094"
10514|"0800870"
10515|"0400260"
10517|"(n/z)"
10518|"(n/z)"
10519|"0840625"
10520|"0427364"
10521|"0424746"
10522|"0010094"
10523|"0424746"
10524|"0050000"
10525|"(n/z)"
10526|"0427364"
10528|"0326160"
10529|"0440268"
10530|"(n/z)"
10531|"(n/z)"
10532|"(n/z)"
10533|"(n/z)"
10534|"(n/z)"
10535|"(n/z)"
10536|"(n/z)"
10537|"(n/z)"
10538|"(n/z)"
10539|"(n/z)"
10540|"(n/z)"
10541|"(n/z)"
10542|"(n/z)"
10543|"(n/z)"
10544|"(n/z)"
10545|"(n/z)"
10546|"(n/z)"
10547|"(n/z)"
10548|"(n/z)"
10549|"(n/z)"
10550|"(n/z)"
10551|"(n/z)"
10552|"(n/z)"
10553|"(n/z)"
10554|"(n/z)"
10555|"(n/z)"
10556|"(n/z)"
10557|"0740252"
10558|"0741433"
10560|"0905756"
10561|"0741084"
10562|"0328200"
10563|"(n/z)"
10564|"(n/z)"
10565|"(n/z)"
10566|"(n/z)"
10567|"(n/z)"
10568|"(n/z)"
10569|"(n/z)"
10570|"(n/z)"
10571|"0640888"
10572|"0641060"
10573|"0640642"
10574|"0800856"
10575|"0840296"
10576|"0321458"
10577|"0761286"
10578|"(n/z)"
10579|"(n/z)"
10580|"0130000"
10581|"(n/z)"
10582|"0130000"
10583|"(n/z)"
10584|"0321442"
10585|"0566996"
10586|"0566970"
10587|"0740280"
10588|"0326146"
10589|"0769164"
10590|"0440294"
10591|"0961658"
10592|"0321458"
10593|"0566970"
10594|"0809600"
10595|"0806000"
10596|"0360296"
10597|"0360884"
10598|"0360260"
10599|"0769190"
10600|"0360296"
10601|"0640668"
10602|"0360848"
10603|"0360260"
10604|"0640894"
10605|"0840680"
10606|"0640666"
10607|"0621282"
10608|"0540282"
10609|"0905756"
10610|"0440270"
10611|"0640850"
10612|"0806968"
10613|"0740252"
10614|"0741084"
10615|"0440270"
10616|"0801694"
10617|"0806000"
10618|"0420290"
10619|"0424746"
10620|"0421262"
10621|"0427372"
10622|"0941648"
10623|"0421262"
10624|"0941658"
10625|"0741464"
10626|"0540292"
10627|"0540256"
10628|"0540262"
10629|"0900248"
10630|"0540262"
10631|"0840605"
10632|"0840286"
10633|"0440294"
10634|"0440262"
10635|"0640888"
10636|"0640642"
10637|"0641009"
10638|"0641076"
10639|"0840286"
10640|"0640894"
10641|"0540292"
10642|"0840680"
10643|"0801817"
10644|"(n/z)"
10645|"0427372"
10646|"(n/z)"
10647|"0640888"
10648|"0809200"
10649|"(n/z)"
10650|"0840266"
10651|"(n/z)"
10652|"(n/z)"
10653|"0540270"
10654|"0546744"
10655|"0800625"
10656|"0801231"
10658|"(n/z)"
10659|"(n/z)"
10660|"(n/z)"
10661|"(n/z)"
10662|"(n/z)"
10663|"(n/z)"
10664|"(n/z)"
10665|"0809200"
10666|"0460252"
10667|"(n/z)"
10668|"(n/z)"
10669|"(n/z)"
10670|"0801211"
10671|"(n/z)"
10672|"(n/z)"
10673|"(n/z)"
10674|"(n/z)"
10675|"0740625"
10677|"(n/z)"
10678|"(n/z)"
10679|"(n/z)"
10680|"(n/z)"
10681|"0566996"
1|"(n/z)"
2002|"(n/z)"
11001|"(n/z)"
11004|"(n/z)"
11005|"(n/z)"
10423|"0741464"
10428|"0326160"
10430|"0740605"
10484|"0761211"
10500|"0801231"
1001|"(n/z)"
2001|"(n/z)"
11002|"0760258"
11003|"0421262"

COPY 1 RECORDS INTO segment1 FROM STDIN DELIMITERS '|' , E'\n', '"';
"10"|"10"

COPY 44 RECORDS INTO segment2 FROM STDIN DELIMITERS '|' , E'\n', '"';
"0000"|"0000"
"1000"|"1000"
"1100"|"1100"
"1200"|"1200"
"1300"|"1300"
"1400"|"1400"
"1500"|"1500"
"1600"|"1600"
"1900"|"1900"
"2000"|"2000"
"2100"|"2100"
"2200"|"2200"
"2300"|"2300"
"2400"|"2400"
"2500"|"2500"
"2600"|"2600"
"2900"|"2900"
"3000"|"3000"
"3110"|"3110"
"3120"|"3120"
"3300"|"3300"
"3310"|"3310"
"3320"|"3320"
"3330"|"3330"
"3390"|"3390"
"3410"|"3410"
"3420"|"3420"
"3430"|"3430"
"3440"|"3440"
"3450"|"3450"
"3460"|"3460"
"3470"|"3470"
"3480"|"3480"
"3490"|"3490"
"3500"|"3500"
"3510"|"3510"
"3520"|"3520"
"3530"|"3530"
"3610"|"3610"
"3611"|"3611"
"3612"|"3612"
"3613"|"3613"
"3630"|"3630"
"3640"|"3640"

COPY 143 RECORDS INTO segment3 FROM STDIN DELIMITERS '|' , E'\n', '"';
"7212"|"7212"
"7213"|"7213"
"7214"|"7214"
"7215"|"7215"
"7200"|"7200"
"7203"|"7203"
"7206"|"7206"
"7207"|"7207"
"7209"|"7209"
"7210"|"7210"
"5611"|"5611"
"7201"|"7201"
"7202"|"7202"
"7204"|"7204"
"7211"|"7211"
"2417"|"2417"
"7205"|"7205"
"7208"|"7208"
"3401"|"3401"
"8131"|"8131"
"1111"|"1111"
"1182"|"1182"
"1191"|"1191"
"1241"|"1241"
"1251"|"1251"
"1252"|"1252"
"1253"|"1253"
"2192"|"2192"
"2310"|"2310"
"2621"|"2621"
"2622"|"2622"
"2623"|"2623"
"2699"|"2699"
"3212"|"3212"
"5311"|"5311"
"5561"|"5561"
"5721"|"5721"
"6114"|"6114"
"7411"|"7411"
"7502"|"7502"
"7631"|"7631"
"7632"|"7632"
"7752"|"7752"
"8151"|"8151"
"8251"|"8251"
"8311"|"8311"
"8411"|"8411"
"FA03"|"FA03"
"FA04"|"FA04"
"FA05"|"FA05"
"2381"|"2381"
"5726"|"5726"
"5600"|"5600"
"5610"|"5610"
"5612"|"5612"
"5620"|"5620"
"5621"|"5621"
"5622"|"5622"
"5623"|"5623"
"5624"|"5624"
"5625"|"5625"
"5626"|"5626"
"5697"|"5697"
"5698"|"5698"
"5699"|"5699"
"7300"|"7300"
"7310"|"7310"
"7322"|"7322"
"7323"|"7323"
"7326"|"7326"
"7327"|"7327"
"7328"|"7328"
"7329"|"7329"
"7331"|"7331"
"7332"|"7332"
"7333"|"7333"
"7334"|"7334"
"7335"|"7335"
"7351"|"7351"
"7352"|"7352"
"2112"|"2112"
"7103"|"7103"
"5399"|"5399"
"5319"|"5319"
"6541"|"6541"
"7121"|"7121"
"5727"|"5727"
"5404"|"5404"
"5403"|"5403"
"2423"|"2423"
"2424"|"2424"
"2425"|"2425"
"7590"|"7590"
"7591"|"7591"
"7592"|"7592"
"7593"|"7593"
"7216"|"7216"
"7217"|"7217"
"7218"|"7218"
"7220"|"7220"
"7221"|"7221"
"7222"|"7222"
"7223"|"7223"
"2428"|"2428"
"2122"|"2122"
"2312"|"2312"
"1222"|"1222"
"2672"|"2672"
"2674"|"2674"
"5911"|"5911"
"5171"|"5171"
"9999"|"9999"
"1254"|"1254"
"1271"|"1271"
"7443"|"7443"
"1272"|"1272"
"5728"|"5728"
"1242"|"1242"
"1121"|"1121"
"1192"|"1192"
"1211"|"1211"
"1231"|"1231"
"1291"|"1291"
"1293"|"1293"
"7412"|"7412"
"7421"|"7421"
"7423"|"7423"
"7429"|"7429"
"8141"|"8141"
"0000"|"0000"
"7446"|"7446"
"7445"|"7445"
"7447"|"7447"
"7444"|"7444"
"5204"|"5204"
"2359"|"2359"
"2353"|"2353"
"1221"|"1221"
"1292"|"1292"
"3211"|"3211"
"7422"|"7422"
"7441"|"7441"
"7561"|"7561"

COPY 56 RECORDS INTO segment4 FROM STDIN DELIMITERS '|' , E'\n', '"';
"00000"|"00000"
"57001"|"57001"
"57002"|"57002"
"57003"|"57003"
"57004"|"57004"
"57005"|"57005"
"57007"|"57007"
"57008"|"57008"
"57009"|"57009"
"11001"|"11001"
"11002"|"11002"
"11003"|"11003"
"11004"|"11004"
"11005"|"11005"
"11006"|"11006"
"12001"|"12001"
"12002"|"12002"
"12003"|"12003"
"12004"|"12004"
"12005"|"12005"
"12006"|"12006"
"12007"|"12007"
"12008"|"12008"
"12009"|"12009"
"12010"|"12010"
"12039"|"12039"
"12049"|"12049"
"12061"|"12061"
"12069"|"12069"
"12079"|"12079"
"12089"|"12089"
"12099"|"12099"
"13001"|"13001"
"13002"|"13002"
"13003"|"13003"
"13004"|"13004"
"13005"|"13005"
"13006"|"13006"
"13007"|"13007"
"13019"|"13019"
"13029"|"13029"
"13059"|"13059"
"13079"|"13079"
"14001"|"14001"
"14002"|"14002"
"14003"|"14003"
"14004"|"14004"
"14005"|"14005"
"14006"|"14006"
"14029"|"14029"
"74401"|"74401"
"74402"|"74402"
"74403"|"74403"
"74405"|"74405"
"74406"|"74406"
"74404"|"74404"

COPY 49998 RECORDS INTO all_dates FROM E'$QTSTSRCDIR/all_dates.csv.gz' DELIMITERS '|' , E'\n', '"';

-- this works
SELECT loc.code
      ,cat.subcategory_code
      ,cat.category_code
      ,s1.code
      ,s2.code
      ,s3.code
      ,s4.code
      ,d.d_date
      ,d.month_code
  FROM category cat
      ,book b
      ,location loc
      ,all_dates d
      ,segment4 s4
      ,segment3 s3
      ,segment2 s2
      ,segment1 s1
      ,fact f
 WHERE  b.code = f.book_code
    AND d.d_date = f.d_period
    AND s4.id = f.s4_id
    AND s3.id = f.s3_id
    AND s2.id = f.s2_id
    AND s1.id = f.s1_id
    AND loc.id = f.location_id
    AND b.code = 'G2FIN'
    AND cat.id = f.category_id
    AND f.book_code = 'G2FIN'
    AND ( cat.subcategory_code = 200 OR cat.subcategory_code = 301 OR cat.subcategory_code >= 221 )
    AND ( cat.subcategory_code = 200 OR cat.subcategory_code = 301 OR cat.subcategory_code <= 290 )
    AND d.month_code BETWEEN '2016.01' AND '2016.10'
 ORDER BY d.d_date;

SELECT loc.code
      ,cat.subcategory_code
      ,cat.category_code
      ,s1.code
      ,s2.code
      ,s3.code
      ,s4.code
      ,d.d_date
      ,d.month_code
  FROM category cat
      ,book b
      ,location loc
      ,all_dates d
      ,segment4 s4
      ,segment3 s3
      ,segment2 s2
      ,segment1 s1
      ,fact f
 WHERE  b.code = f.book_code
    AND d.d_date = f.d_period
    AND s4.id = f.s4_id
    AND s3.id = f.s3_id
    AND s2.id = f.s2_id
    AND s1.id = f.s1_id
    AND loc.id = f.location_id
    AND b.code = 'G2FIN'
    AND cat.id = f.category_id
    AND f.book_code = 'G2FIN'
    AND ( cat.subcategory_code = 200 OR cat.subcategory_code = 301 OR cat.subcategory_code >= 221 )
    AND ( cat.subcategory_code = 200 OR cat.subcategory_code = 301 OR cat.subcategory_code <= 290 )
    AND ( s1.code = '03' OR cat.subcategory_code = 25 )
    AND d.month_code BETWEEN '2016.01' AND '2016.10'
 ORDER BY d.d_date;

SELECT 1 FROM location loc,segment1 s1,fact f WHERE s1.id = f.s1_id AND loc.id = f.location_id;

SELECT 1 FROM location loc,segment1 s1,fact f WHERE s1.id = f.s1_id AND loc.id = f.location_id AND ( s1.code = '03' OR loc.code = '0010094' );

ROLLBACK;
