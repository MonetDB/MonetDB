stdout of test 'WITH-alias-DELETE-2.deletes-too-many-tuples.Bug-7133` in directory 'sql/test/BugTracker-2021` itself:


# 14:49:53 >  
# 14:49:53 >  "mserver5" "--debug=10" "--set" "gdk_nr_threads=0" "--set" "mapi_listenaddr=all" "--set" "mapi_port=36922" "--set" "mapi_usock=/var/tmp/mtest-711376/.s.monetdb.36922" "--forcemito" "--dbpath=/export/scratch1/home/zhang/monetdb/mdb-nst/Oct2020/var/MonetDB/mTests_sql_test_BugTracker-2021" "--set" "embedded_r=yes" "--set" "embedded_c=true"
# 14:49:53 >  

# MonetDB 5 server v11.39.18 (hg id: d9135c8dafb2)
# This is an unreleased version
# Serving database 'mTests_sql_test_BugTracker-2021', using 12 threads
# Compiled for x86_64-pc-linux-gnu/64bit with 128bit integers
# Found 62.658 GiB available main-memory of which we use 51.067 GiB
# Copyright (c) 1993 - July 2008 CWI.
# Copyright (c) August 2008 - 2021 MonetDB B.V., all rights reserved
# Visit https://www.monetdb.org/ for further information
# Listening for connection requests on mapi:monetdb://rocks202.scilens.private:36922/
# Listening for UNIX domain connection requests on mapi:monetdb:///var/tmp/mtest-711376/.s.monetdb.36922
# MonetDB/GIS module loaded
# MonetDB/R   module loaded
# MonetDB/SQL module loaded

# 14:49:55 >  
# 14:49:55 >  "mclient" "-lsql" "-ftest" "-tnone" "-Eutf-8" "-i" "-e" "--host=/var/tmp/mtest-711376" "--port=36922"
# 14:49:55 >  

#CREATE TABLE test (ID BIGINT, UUID STRING, sec BIGINT, data VARCHAR(1000));
#INSERT INTO test VALUES
#  (1000000, 'uuid0000', 1621539934, 'a0' )
#, (1000003, 'uuid0003', 1621539934, 'a3' );
[ 2	]
#CREATE TABLE extra (ID BIGINT, UUID STRING, sec BIGINT, extra VARCHAR(1000));
#INSERT INTO extra VALUES
#  (1000009, 'uuid0009', 1621539934, 'a9' )
#, (1000009, 'uuid0009', 1621539934, 'a9' )
#, (1000009, 'uuid0009', 1621539934, 'a9' )
#, (1000009, 'uuid0009', 1621539934, 'a9' )
#
#, (1000000, 'uuid0000', 1621539934, 'a0' )
#, (1000000, 'uuid0000', 1621539934, 'a0' )
#, (1000000, 'uuid0000', 1621539934, 'a0' )
#, (1000000, 'uuid0000', 1621539934, 'a0' )
#
#, (1000003, 'uuid0003', 1621539934, 'a3' )
#, (1000003, 'uuid0003', 1621539934, 'a3' )
#, (1000003, 'uuid0003', 1621539934, 'a3' )
#, (1000003, 'uuid0003', 1621539934, 'a3' );
[ 12	]
#SELECT id, COUNT(*) as cnt FROM extra GROUP BY id ORDER BY id;
% sys.extra,	sys. # table_name
% id,	cnt # name
% bigint,	bigint # type
% 7,	1 # length
[ 1000000,	4	]
[ 1000003,	4	]
[ 1000009,	4	]
#WITH ca AS
#(
#        SELECT e.ID as id
#             , e.UUID as uuid
#             , e.sec as sec
#          FROM extra AS e
#LEFT OUTER JOIN test AS t
#            ON t.ID = e.ID
#           AND t.UUID = e.UUID
#           AND t.sec = e.sec
#         WHERE t.ID IS NULL
#           AND t.UUID IS NULL
#           AND t.sec IS NULL
#)
#DELETE
#FROM extra AS i
#WHERE i.id = ca.id
#  AND i.sec = ca.sec
#  AND i.uuid = ca.uuid
#; -- 16 affected rows!
[ 4	]
#SELECT COUNT(*) FROM extra;
% .%1 # table_name
% %1 # name
% bigint # type
% 2 # length
[ 8	]
#select table, column, type, count from sys.storage() where table = 'extra';
% .%1,	.%1,	.%1,	.%1 # table_name
% table,	column,	type,	count # name
% varchar,	varchar,	varchar,	bigint # type
% 5,	5,	7,	2 # length
[ "extra",	"id",	"bigint",	8	]
[ "extra",	"uuid",	"clob",	8	]
[ "extra",	"sec",	"bigint",	8	]
[ "extra",	"extra",	"varchar",	8	]

# 14:50:05 >  
# 14:50:05 >  "Done."
# 14:50:05 >  

