statement ok
drop table if exists v0

-- 01.sql
statement ok
CREATE TABLE v0 (v1 SMALLINT)

statement ok
INSERT INTO v0 SELECT 0 FROM generate_series(1, 1000000)

statement ok
SELECT NULL, v1 FROM v0 v0 ORDER BY v1+v1, v1, -1 LIMIT 2147483645

statement ok
drop table v0

-- 02.sql
statement ok
CREATE TABLE v0(v1 VARCHAR(30))

query TTI
SELECT DISTINCT v1 v1, v1, abs(v1)=10 FROM v0 WHERE lower (v1) IS NOT NULL
----

statement ok
drop table v0

-- 03.sql
statement ok
CREATE VIEW v0 AS SELECT CAST (NULL AS INT) INTERSECT SELECT CAST (NULL AS INT)

query I
SELECT * FROM v0
----
NULL

query I
SELECT row_number ( ) OVER ( ORDER BY 10 * 10 , ( CASE WHEN ( 10 IS NULL ) THEN 4 ELSE 10 END ) DESC NULLS FIRST ) FROM v0;
----
1

query IIT
SELECT 2, row_number() OVER (ORDER BY 10*10, (CASE WHEN (10 IS NULL) THEN 4 ELSE 10 END) DESC NULLS FIRST), '.125e+3' FROM v0 LIMIT 1
----
2
1
.125e+3

statement ok
drop view v0

-- 04.sql
statement ok
CREATE TABLE v0 (v1 VARCHAR(255))

statement ok
INSERT INTO v0 VALUES (2),(8),(10),(1),(0),(1),(2)

statement ok
INSERT INTO v0 SELECT row_number () OVER (ORDER BY 2) FROM v0, v0 AS c3_null, v0 AS t2

statement ok
INSERT INTO v0 SELECT row_number () OVER (ORDER BY 2 NULLS LAST) AS c0 FROM v0, v0 AS contains

query I
SELECT count(*) as cnt FROM v0
----
122850

statement ok
SELECT FIRST_VALUE(v1) OVER (PARTITION BY v1=5 ORDER BY 3003*v1 DESC NULLS FIRST, v1) FROM v0 LIMIT 1000000000

query T rowsort
SELECT distinct FIRST_VALUE(v1) OVER (PARTITION BY v1=5 ORDER BY 3003*v1 DESC NULLS FIRST, v1) FROM v0 LIMIT 1000000000
----
122500
5

statement ok
drop table v0;

-- 05.sql
statement ok
CREATE TABLE v0 (v1 INT)

statement ok
INSERT INTO v0 VALUES (NULL),(1),(0),(1),(2),(10),(10),(400),(1)

statement ok
INSERT INTO v0 SELECT row_number () OVER (ORDER BY 3) FROM v0, v0 AS c3_null, v0 AS t2

statement ok
INSERT INTO v0 SELECT row_number () OVER (ORDER BY 100 NULLS LAST) FROM v0, v0 AS contains

query I
SELECT count(*) as cnt FROM v0
----
545382

statement ok
SELECT FIRST_VALUE (v1) OVER (PARTITION BY 'HASHED' ORDER BY v1<=10 DESC NULLS FIRST, v1 DESC) FROM v0 LIMIT 300000

query T rowsort
SELECT distinct FIRST_VALUE ( v1 ) OVER ( PARTITION BY 'HASHED' ORDER BY v1 <= 10 DESC NULLS FIRST , v1 DESC ) FROM v0 WHERE v1 IS NOT NULL LIMIT 300000
----
10

statement ok
drop table v0

-- 06.sql
statement error HY013!Could not allocate space
CREATE TEMP TABLE Table0 (Col0 INT, PRIMARY KEY(Col0), FOREIGN KEY (Col0) REFERENCES Table0)

statement ok
drop table if exists Table0

-- 07.sql
statement ok
CREATE VIEW v0 AS SELECT CAST (NULL AS INT) EXCEPT SELECT CAST (NULL AS INT) GROUP BY NULL

statement ok
drop view if exists v0

-- 08.sql
statement ok
CREATE TABLE v0 (v1 INT NULL)

statement ok
INSERT INTO v0 VALUES (3),(10),(1),(200),(5)

statement ok
INSERT INTO v0 SELECT v0.v1 FROM v0, v0 AS c3_null, v0 AS a

statement ok
INSERT INTO v0 SELECT v0.v1 FROM v0, v0 AS c3_null, v0 AS col2

query I
SELECT count(*) as cnt FROM v0
----
2197130

statement ok
SELECT v1, row_number() OVER (ORDER BY v1 * 3 NULLS LAST, NULL*0 DESC NULLS FIRST), 3 FROM v0 LIMIT 300000

statement ok
drop table v0

-- 09.sql
statement ok
CREATE TABLE v0 (v1 INT, v2 REAL)

statement error 42000!Table expression without table name
SELECT * FROM v0 ORDER BY (SELECT *)

statement error 42000!SELECT: subquery must return only one column
SELECT * FROM v0 ORDER BY ( SELECT * FROM v0 )

query IR
SELECT * FROM v0 ORDER BY (SELECT -1)
----

statement ok
drop table v0

-- TODO: add remaining 10.sql to 40.sql tests and fix bugs

