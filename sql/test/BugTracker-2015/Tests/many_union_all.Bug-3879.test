statement ok
START TRANSACTION

statement ok
CREATE TABLE foo (a INT)

query I rowsort
SELECT 1
FROM (SELECT a FROM foo
      UNION ALL
      SELECT 0 FROM foo
      UNION ALL
      SELECT 0 FROM foo
      UNION ALL
      SELECT 0 FROM foo
      UNION ALL
      SELECT 0 FROM foo
      UNION ALL
      SELECT 0 FROM foo
      UNION ALL
      SELECT 0 FROM foo
      UNION ALL
      SELECT 0 FROM foo
      UNION ALL
      SELECT 0 FROM foo
      UNION ALL
      SELECT 0 FROM foo
      UNION ALL
      SELECT 0 FROM foo
      UNION ALL
      SELECT 0 FROM foo) AS t
----

statement ok
INSERT INTO foo VALUES (3), (6), (7)

query I rowsort
SELECT DISTINCT a
FROM (
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo) t
----
3
6
7

query I rowsort
SELECT DISTINCT a
FROM (
SELECT a FROM foo UNION ALL
SELECT 0 FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT 0 FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT 0 FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT 0 FROM foo UNION ALL
SELECT 0 FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT 0 FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT 0 FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT 0 FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT 0 FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT 0 FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT 0 FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT 0 FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT a FROM foo UNION ALL
SELECT 0 FROM foo) t
----
0
3
6
7

statement ok
DROP TABLE foo

statement ok
ROLLBACK

