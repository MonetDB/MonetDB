
statement ok
CREATE table arr_tbl (f1 int[])

statement ok
insert into arr_tbl values ('{1,2,3}')

statement ok
insert into arr_tbl values ('{2,3,4}')

query T nosort
select * from arr_tbl
----
{1,2,3}
{2,3,4}


query TI nosort
select f1, f.elements from arr_tbl, unnest(f1) f
----
{1,2,3}
1
{1,2,3}
2
{1,2,3}
3
{2,3,4}
2
{2,3,4}
3
{2,3,4}
4

query TI nosort
select f1, avg(f.elements) from arr_tbl, unnest(f1) f group by f1;
----
{1,2,3}
2
{2,3,4}
3

query I nosort
select a from unnest(Array[1,2]) a(a);
----
1
2

query T nosort
select array[1,2,3]
----
{1,2,3}

query T nosort
select array[1,2,3] union all select array[4,5,6,7]
----
{1,2,3}
{4,5,6,7}

query T nosort
select a from unnest(Array['11','2']) a(a);
----
11
2
