
statement ok
CREATE table arr_tbl (f1 int[])

statement ok
insert into arr_tbl values ('{1,2,3}')

statement ok
insert into arr_tbl values ('{2,3,4}')

query T nosort
select * from arr_tbl
----
{1,2,3}
{2,3,4}


query TI nosort
select f1, f.elements from arr_tbl, unnest(f1) f
----
{1,2,3}
1
{1,2,3}
2
{1,2,3}
3
{2,3,4}
2
{2,3,4}
3
{2,3,4}
4

query TI nosort
select f1, avg(f.elements) from arr_tbl, unnest(f1) f group by f1;
----
{1,2,3}
2
{2,3,4}
3
