## fixed-length type array

query T nosort array_literal_single
select array[10, 11]
----
{10,11}

query T nosort array_literal_single
select (values (array[10, 11]))
----
{10,11}

query T nosort array_literal_single
select * from (values (array[10, 11]))
----
{10,11}

query T nosort
select * from (values (array[10, 11]), (array[20, 21]))
----
{10,11}
{20,21}

query I nosort unnest_elements
select elements from (select array[10, 11] a), unnest(a)
----
10
11

query I nosort unnest_elements
select u.elements from (select array[10, 11] a) sq, unnest(sq.a) u
----
10
11

query III nosort 
select u.* from (select array[10, 11] a) sq, unnest(sq.a) u
----
10
11

query TIII nosort unnest_all
select * from (select array[10, 11] a) sq, unnest(sq.a) u
----
{10,11}
10
{10,11}
11

query TIII nosort unnest_all
select sq.*, u.* from (select array[10, 11] a) sq, unnest(sq.a) u
----
{10,11}
10
{10,11}
11

query T nosort
select sq.* from (select array[10, 11] a) sq, unnest(sq.a) u
----
{10,11}
{10,11}

statement ok
create table flent_arr (n int[])

query I nosort
select * from flent_arr
----

statement ok
insert into flent_arr values ('{10, 11}')

query T nosort
select * from flent_arr
----
{10,11}

query TI nosort table_unnest_all
select * from flent_arr, unnest(flent_arr.n)
----
{10,11}
10
{10,11}
11

query I nosort
select elements from flent_arr, unnest(flent_arr.n)
----
10
11

query I nosort
select u.* from flent_arr, unnest(flent_arr.n) u
----
10
11

query I nosort
select u.elements from flent_arr, unnest(flent_arr.n) u
----
10
11

query IT nosort
select u.*, fa.* from flent_arr fa, unnest(fa.n) u
----
10
{10,11}
11
{10,11}

query TIII nosort unnest_all
select fa.*, u.* from flent_arr fa, unnest(fa.n) u
----
{10,11}
10
{10,11}
11

query T nosort
select fa.* from flent_arr fa, unnest(fa.n) u
----
{10,11}
{10,11}

query TI nosort unnest_all
select * from flent_arr fa, unnest(fa.n) u
----
{10,11}
10
{10,11}
11

query TI nosort unnest_all
select * from flent_arr, unnest(flent_arr.n)
----
{10,11}
10
{10,11}
11

statement ok
insert into flent_arr values (array[20, 21])

query T nosort
select * from flent_arr
----
{10,11}
{20,21}

statement ok
insert into flent_arr values ('{30, 31}'), ('{40}'), ('{50, 51, 52}')

query T nosort
select * from flent_arr
----
{10,11}
{20,21}
{30,31}
{40}
{50,51,52}

statement ok
insert into flent_arr values (array[60]), (array[70, 71])

query T nosort
select * from flent_arr
----
{10,11}
{20,21}
{30,31}
{40}
{50,51,52}
{60}
{70,71}

## ambiguous col elements (table vs unnest())

statement ok
create table amb (elements int[])

statement ok
insert into amb values (array[10, 11]), (array[20, 21])

statement error SELECT: identifier 'elements' ambiguous
select elements from amb, unnest(elements)

query T nosort 
select elements from amb, unnest(elements) u
----
{10,11}
{20,21}

## variable-length type array

statement ok
create table vlent_arr (s text[])

query I nosort
select * from vlent_arr
----

statement ok
insert into vlent_arr values ('{"left", "right"}')

query T nosort
select * from vlent_arr
----
{"left","right"}

statement ok
insert into vlent_arr values ('{"l2", "r2"}')

query T nosort
select * from vlent_arr
----
{"left","right"}
{"l2","r2"}

statement ok
insert into vlent_arr values ('{"single"}'), ('{"a", "b", "c"}'), ('{"one", "two"}');

query T nosort
select * from vlent_arr
----
{"left","right"}
{"l2","r2"}
{"single"}
{"a","b","c"}
{"one","two"}

