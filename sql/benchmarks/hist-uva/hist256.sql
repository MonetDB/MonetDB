SELECT h2.Name, SUM(1-MIN(h1.Bin1, h2.Bin1)-MIN(h1.Bin2, h2.Bin2)-MIN(h1.Bin3, h2.Bin3)-MIN(h1.Bin4, h2.Bin4)-MIN(h1.Bin5, h2.Bin5)-MIN(h1.Bin6, h2.Bin6)-MIN(h1.Bin7, h2.Bin7)-MIN(h1.Bin8, h2.Bin8)-MIN(h1.Bin9, h2.Bin9)-
MIN(h1.Bin10, h2.Bin10)-MIN(h1.Bin11, h2.Bin11)-MIN(h1.Bin12, h2.Bin12)-MIN(h1.Bin13, h2.Bin13)-MIN(h1.Bin14, h2.Bin14)-MIN(h1.Bin15, h2.Bin15)-MIN(h1.Bin16, h2.Bin16)-MIN(h1.Bin17, h2.Bin17)-MIN(h1.Bin18, h2.Bin18)-
MIN(h1.Bin19, h2.Bin19)-MIN(h1.Bin20, h2.Bin20)-MIN(h1.Bin21, h2.Bin21)-MIN(h1.Bin22, h2.Bin22)-MIN(h1.Bin23, h2.Bin23)-MIN(h1.Bin24, h2.Bin24)-MIN(h1.Bin25, h2.Bin25)-MIN(h1.Bin26, h2.Bin26)-MIN(h1.Bin27, h2.Bin27)-
MIN(h1.Bin28, h2.Bin28)-MIN(h1.Bin29, h2.Bin29)-MIN(h1.Bin30, h2.Bin30)-MIN(h1.Bin31, h2.Bin31)-MIN(h1.Bin32, h2.Bin32)-MIN(h1.Bin33, h2.Bin33)-MIN(h1.Bin34, h2.Bin34)-MIN(h1.Bin35, h2.Bin35)-MIN(h1.Bin36, h2.Bin36)-
MIN(h1.Bin37, h2.Bin37)-MIN(h1.Bin38, h2.Bin38)-MIN(h1.Bin39, h2.Bin39)-MIN(h1.Bin40, h2.Bin40)-MIN(h1.Bin41, h2.Bin41)-MIN(h1.Bin42, h2.Bin42)-MIN(h1.Bin43, h2.Bin43)-MIN(h1.Bin44, h2.Bin44)-MIN(h1.Bin45, h2.Bin45)-
MIN(h1.Bin46, h2.Bin46)-MIN(h1.Bin47, h2.Bin47)-MIN(h1.Bin48, h2.Bin48)-MIN(h1.Bin49, h2.Bin49)-MIN(h1.Bin50, h2.Bin50)-MIN(h1.Bin51, h2.Bin51)-MIN(h1.Bin52, h2.Bin52)-MIN(h1.Bin53, h2.Bin53)-MIN(h1.Bin54, h2.Bin54)-
MIN(h1.Bin55, h2.Bin55)-MIN(h1.Bin56, h2.Bin56)-MIN(h1.Bin57, h2.Bin57)-MIN(h1.Bin58, h2.Bin58)-MIN(h1.Bin59, h2.Bin59)-MIN(h1.Bin60, h2.Bin60)-MIN(h1.Bin61, h2.Bin61)-MIN(h1.Bin62, h2.Bin62)-MIN(h1.Bin63, h2.Bin63)-
MIN(h1.Bin64, h2.Bin64)-MIN(h1.Bin65, h2.Bin65)-MIN(h1.Bin66, h2.Bin66)-MIN(h1.Bin67, h2.Bin67)-MIN(h1.Bin68, h2.Bin68)-MIN(h1.Bin69, h2.Bin69)-MIN(h1.Bin70, h2.Bin70)-MIN(h1.Bin71, h2.Bin71)-MIN(h1.Bin72, h2.Bin72)-
MIN(h1.Bin73, h2.Bin73)-MIN(h1.Bin74, h2.Bin74)-MIN(h1.Bin75, h2.Bin75)-MIN(h1.Bin76, h2.Bin76)-MIN(h1.Bin77, h2.Bin77)-MIN(h1.Bin78, h2.Bin78)-MIN(h1.Bin79, h2.Bin79)-MIN(h1.Bin80, h2.Bin80)-MIN(h1.Bin81, h2.Bin81)-
MIN(h1.Bin82, h2.Bin82)-MIN(h1.Bin83, h2.Bin83)-MIN(h1.Bin84, h2.Bin84)-MIN(h1.Bin85, h2.Bin85)-MIN(h1.Bin86, h2.Bin86)-MIN(h1.Bin87, h2.Bin87)-MIN(h1.Bin88, h2.Bin88)-MIN(h1.Bin89, h2.Bin89)-MIN(h1.Bin90, h2.Bin90)-
MIN(h1.Bin91, h2.Bin91)-MIN(h1.Bin92, h2.Bin92)-MIN(h1.Bin93, h2.Bin93)-MIN(h1.Bin94, h2.Bin94)-MIN(h1.Bin95, h2.Bin95)-MIN(h1.Bin96, h2.Bin96)-MIN(h1.Bin97, h2.Bin97)-MIN(h1.Bin98, h2.Bin98)-MIN(h1.Bin99, h2.Bin99)-
MIN(h1.Bin100, h2.Bin100)-MIN(h1.Bin101, h2.Bin101)-MIN(h1.Bin102, h2.Bin102)-MIN(h1.Bin103, h2.Bin103)-MIN(h1.Bin104, h2.Bin104)-MIN(h1.Bin105, h2.Bin105)-MIN(h1.Bin106, h2.Bin106)-MIN(h1.Bin107, h2.Bin107)-MIN(h1.Bin108, h2.Bin108)-
MIN(h1.Bin109, h2.Bin109)-MIN(h1.Bin110, h2.Bin110)-MIN(h1.Bin111, h2.Bin111)-MIN(h1.Bin112, h2.Bin112)-MIN(h1.Bin113, h2.Bin113)-MIN(h1.Bin114, h2.Bin114)-MIN(h1.Bin115, h2.Bin115)-MIN(h1.Bin116, h2.Bin116)-MIN(h1.Bin117, h2.Bin117)-
MIN(h1.Bin118, h2.Bin118)-MIN(h1.Bin119, h2.Bin119)-MIN(h1.Bin120, h2.Bin120)-MIN(h1.Bin121, h2.Bin121)-MIN(h1.Bin122, h2.Bin122)-MIN(h1.Bin123, h2.Bin123)-MIN(h1.Bin124, h2.Bin124)-MIN(h1.Bin125, h2.Bin125)-MIN(h1.Bin126, h2.Bin126)-
MIN(h1.Bin127, h2.Bin127)-MIN(h1.Bin128, h2.Bin128)-MIN(h1.Bin129, h2.Bin129)-MIN(h1.Bin130, h2.Bin130)-MIN(h1.Bin131, h2.Bin131)-MIN(h1.Bin132, h2.Bin132)-MIN(h1.Bin133, h2.Bin133)-MIN(h1.Bin134, h2.Bin134)-MIN(h1.Bin135, h2.Bin135)-MIN(h1.Bin136, h2.Bin136)-MIN(h1.Bin137, h2.Bin137)-MIN(h1.Bin138, h2.Bin138)-
MIN(h1.Bin139, h2.Bin139)-MIN(h1.Bin140, h2.Bin140)-MIN(h1.Bin141, h2.Bin141)-MIN(h1.Bin142, h2.Bin142)-MIN(h1.Bin143, h2.Bin143)-MIN(h1.Bin144, h2.Bin144)-MIN(h1.Bin145, h2.Bin145)-MIN(h1.Bin146, h2.Bin146)-MIN(h1.Bin147, h2.Bin147)-
MIN(h1.Bin148, h2.Bin148)-MIN(h1.Bin149, h2.Bin149)-MIN(h1.Bin150, h2.Bin150)-MIN(h1.Bin151, h2.Bin151)-MIN(h1.Bin152, h2.Bin152)-MIN(h1.Bin153, h2.Bin153)-MIN(h1.Bin154, h2.Bin154)-MIN(h1.Bin155, h2.Bin155)-MIN(h1.Bin156, h2.Bin156)-
MIN(h1.Bin157, h2.Bin157)-MIN(h1.Bin158, h2.Bin158)-MIN(h1.Bin159, h2.Bin159)-MIN(h1.Bin160, h2.Bin160)-MIN(h1.Bin161, h2.Bin161)-MIN(h1.Bin162, h2.Bin162)-MIN(h1.Bin163, h2.Bin163)-MIN(h1.Bin164, h2.Bin164)-MIN(h1.Bin165, h2.Bin165)-
MIN(h1.Bin166, h2.Bin166)-MIN(h1.Bin167, h2.Bin167)-MIN(h1.Bin168, h2.Bin168)-MIN(h1.Bin169, h2.Bin169)-MIN(h1.Bin170, h2.Bin170)-MIN(h1.Bin171, h2.Bin171)-MIN(h1.Bin172, h2.Bin172)-MIN(h1.Bin173, h2.Bin173)-MIN(h1.Bin174, h2.Bin174)-
MIN(h1.Bin175, h2.Bin175)-MIN(h1.Bin176, h2.Bin176)-MIN(h1.Bin177, h2.Bin177)-MIN(h1.Bin178, h2.Bin178)-MIN(h1.Bin179, h2.Bin179)-MIN(h1.Bin180, h2.Bin180)-MIN(h1.Bin181, h2.Bin181)-MIN(h1.Bin182, h2.Bin182)-MIN(h1.Bin183, h2.Bin183)-
MIN(h1.Bin184, h2.Bin184)-MIN(h1.Bin185, h2.Bin185)-MIN(h1.Bin186, h2.Bin186)-MIN(h1.Bin187, h2.Bin187)-MIN(h1.Bin188, h2.Bin188)-MIN(h1.Bin189, h2.Bin189)-MIN(h1.Bin190, h2.Bin190)-MIN(h1.Bin191, h2.Bin191)-MIN(h1.Bin192, h2.Bin192)-
MIN(h1.Bin193, h2.Bin193)-MIN(h1.Bin194, h2.Bin194)-MIN(h1.Bin195, h2.Bin195)-MIN(h1.Bin196, h2.Bin196)-MIN(h1.Bin197, h2.Bin197)-MIN(h1.Bin198, h2.Bin198)-MIN(h1.Bin199, h2.Bin199)-MIN(h1.Bin200, h2.Bin200)-MIN(h1.Bin201, h2.Bin201)-
MIN(h1.Bin202, h2.Bin202)-MIN(h1.Bin203, h2.Bin203)-MIN(h1.Bin204, h2.Bin204)-MIN(h1.Bin205, h2.Bin205)-MIN(h1.Bin206, h2.Bin206)-MIN(h1.Bin207, h2.Bin207)-MIN(h1.Bin208, h2.Bin208)-MIN(h1.Bin209, h2.Bin209)-MIN(h1.Bin210, h2.Bin210)-
MIN(h1.Bin211, h2.Bin211)-MIN(h1.Bin212, h2.Bin212)-MIN(h1.Bin213, h2.Bin213)-MIN(h1.Bin214, h2.Bin214)-MIN(h1.Bin215, h2.Bin215)-MIN(h1.Bin216, h2.Bin216)-MIN(h1.Bin217, h2.Bin217)-MIN(h1.Bin218, h2.Bin218)-MIN(h1.Bin219, h2.Bin219)-
MIN(h1.Bin220, h2.Bin220)-MIN(h1.Bin221, h2.Bin221)-MIN(h1.Bin222, h2.Bin222)-MIN(h1.Bin223, h2.Bin223)-MIN(h1.Bin224, h2.Bin224)-MIN(h1.Bin225, h2.Bin225)-MIN(h1.Bin226, h2.Bin226)-MIN(h1.Bin227, h2.Bin227)-MIN(h1.Bin228, h2.Bin228)-
MIN(h1.Bin229, h2.Bin229)-MIN(h1.Bin230, h2.Bin230)-MIN(h1.Bin231, h2.Bin231)-MIN(h1.Bin232, h2.Bin232)-MIN(h1.Bin233, h2.Bin233)-MIN(h1.Bin234, h2.Bin234)-MIN(h1.Bin235, h2.Bin235)-MIN(h1.Bin236, h2.Bin236)-MIN(h1.Bin237, h2.Bin237)-
MIN(h1.Bin238, h2.Bin238)-MIN(h1.Bin239, h2.Bin239)-MIN(h1.Bin240, h2.Bin240)-MIN(h1.Bin241, h2.Bin241)-MIN(h1.Bin242, h2.Bin242)-MIN(h1.Bin243, h2.Bin243)-MIN(h1.Bin244, h2.Bin244)-MIN(h1.Bin245, h2.Bin245)-MIN(h1.Bin246, h2.Bin246)-
MIN(h1.Bin247, h2.Bin247)-MIN(h1.Bin248, h2.Bin248)-MIN(h1.Bin249, h2.Bin249)-MIN(h1.Bin250, h2.Bin250)-MIN(h1.Bin251, h2.Bin251)-MIN(h1.Bin252, h2.Bin252)-MIN(h1.Bin253, h2.Bin253)-MIN(h1.Bin254, h2.Bin254)-MIN(h1.Bin255, h2.Bin255)-
MIN(h1.Bin256, h2.Bin256)) / COUNT(*) dist 
FROM Histogram256_tab h1, Histogram256_tab h2, HistogramSet_tab s 
WHERE (h1.setId = s.Id) 
	AND (h2.setId = s.Id) 
	AND (s.Name = ?) 
	AND (h1.Name = ?)       
	AND (h1.HistoName =  h2.HistoName) 
GROUP BY h2.Name 
ORDER BY dist
