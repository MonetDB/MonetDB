stdout of test '02-explain` in directory 'sql/benchmarks/tpch` itself:


# 22:53:25 >  
# 22:53:25 >  "mserver5" "--debug=10" "--set" "gdk_nr_threads=0" "--set" "mapi_open=true" "--set" "mapi_port=34581" "--set" "mapi_usock=/var/tmp/mtest-9096/.s.monetdb.34581" "--set" "monet_prompt=" "--forcemito" "--set" "mal_listing=2" "--dbpath=/ufs/manegold/_/Monet/HG/Feb2013/prefix/--disable-debug_--enable-assert_--enable-optimize/var/MonetDB/mTests_sql_benchmarks_tpch" "--set" "mal_listing=0"
# 22:53:25 >  

# MonetDB 5 server v11.15.12
# This is an unreleased version
# Serving database 'mTests_sql_benchmarks_tpch', using 8 threads
# Compiled for x86_64-unknown-linux-gnu/64bit with 64bit OIDs dynamically linked
# Found 15.591 GiB available main-memory.
# Copyright (c) 1993-July 2008 CWI.
# Copyright (c) August 2008-2014 MonetDB B.V., all rights reserved
# Visit http://www.monetdb.org/ for further information
# Listening for connection requests on mapi:monetdb://rome.ins.cwi.nl:34581/
# Listening for UNIX domain connection requests on mapi:monetdb:///var/tmp/mtest-9096/.s.monetdb.34581
# MonetDB/GIS module loaded
# MonetDB/JAQL module loaded
# MonetDB/SQL module loaded

Ready.

# 22:53:25 >  
# 22:53:25 >  "/usr/bin/python2" "02-explain.SQL.py" "02-explain"
# 22:53:25 >  

#set optimizer = 'sequential_pipe';
#explain select
#	s_acctbal,
#	s_name,
#	n_name,
#	p_partkey,
#	p_mfgr,
#	s_address,
#	s_phone,
#	s_comment
#from
#	part,
#	supplier,
#	partsupp,
#	nation,
#	region
#where
#	p_partkey = ps_partkey
#	and s_suppkey = ps_suppkey
#	and p_size = 15
#	and p_type like '%BRASS'
#	and s_nationkey = n_nationkey
#	and n_regionkey = r_regionkey
#	and r_name = 'EUROPE'
#	and ps_supplycost = (
#		select
#			min(ps_supplycost)
#		from
#			partsupp,
#			supplier,
#			nation,
#			region
#		where
#			p_partkey = ps_partkey
#			and s_suppkey = ps_suppkey
#			and s_nationkey = n_nationkey
% .explain # table_name
% mal # name
% clob # type
% 823 # length
function user.s2_1{autoCommit=true}(A0:int,A1:str,A2:str,A3:str):void;
    X_6 := sql.mvc();
    X_7:bat[:oid,:oid]  := sql.tid(X_6,"sys","nation");
    X_10 := sql.bind_idxbat(X_6,"sys","nation","nation_n_regionkey_fkey",0);
    (X_13,r1_13) := sql.bind_idxbat(X_6,"sys","nation","nation_n_regionkey_fkey",2);
    X_16 := sql.bind_idxbat(X_6,"sys","nation","nation_n_regionkey_fkey",1);
    X_18 := sql.projectdelta(X_7,X_10,X_13,r1_13,X_16);
    X_21 := sql.bind(X_6,"sys","region","r_name",0);
    X_19:bat[:oid,:oid]  := sql.tid(X_6,"sys","region");
    X_336 := algebra.subselect(X_21,X_19,A3,A3,true,true,false);
    (X_23,r1_24) := sql.bind(X_6,"sys","region","r_name",2);
    X_337 := algebra.subselect(r1_24,A3,A3,true,true,false);
    X_25 := sql.bind(X_6,"sys","region","r_name",1);
    X_338 := algebra.subselect(X_25,X_19,A3,A3,true,true,false);
    X_26 := sql.subdelta(X_336,X_19,X_23,X_337,X_338);
    X_28 := X_26;
    (X_29,r1_33) := algebra.join(X_18,X_28);
    X_31 := algebra.leftfetchjoin(X_29,X_7);
    X_32:bat[:oid,:oid]  := sql.tid(X_6,"sys","supplier");
    X_34 := sql.bind_idxbat(X_6,"sys","supplier","supplier_s_nationkey_fkey",0);
    (X_36,r1_40) := sql.bind_idxbat(X_6,"sys","supplier","supplier_s_nationkey_fkey",2);
    X_39 := sql.bind_idxbat(X_6,"sys","supplier","supplier_s_nationkey_fkey",1);
    X_40 := sql.projectdelta(X_32,X_34,X_36,r1_40,X_39);
    (X_41,r1_46) := algebra.join(X_31,X_40);
    X_43 := algebra.leftfetchjoin(r1_46,X_32);
    X_44:bat[:oid,:oid]  := sql.tid(X_6,"sys","partsupp");
    X_46 := sql.bind_idxbat(X_6,"sys","partsupp","partsupp_ps_suppkey_fkey",0);
    (X_49,r1_54) := sql.bind_idxbat(X_6,"sys","partsupp","partsupp_ps_suppkey_fkey",2);
    X_52 := sql.bind_idxbat(X_6,"sys","partsupp","partsupp_ps_suppkey_fkey",1);
    X_54 := sql.projectdelta(X_44,X_46,X_49,r1_54,X_52);
    (X_55,r1_61) := algebra.join(X_43,X_54);
    X_57 := sql.bind(X_6,"sys","partsupp","ps_partkey",0);
    (X_59,r1_65) := sql.bind(X_6,"sys","partsupp","ps_partkey",2);
    X_61 := sql.bind(X_6,"sys","partsupp","ps_partkey",1);
    X_62 := sql.projectdelta(X_44,X_57,X_59,r1_65,X_61);
    X_63 := algebra.leftfetchjoin(r1_61,X_62);
    X_64 := sql.bind_idxbat(X_6,"sys","partsupp","partsupp_ps_partkey_fkey",0);
    (X_66,r1_74) := sql.bind_idxbat(X_6,"sys","partsupp","partsupp_ps_partkey_fkey",2);
    X_69 := sql.bind_idxbat(X_6,"sys","partsupp","partsupp_ps_partkey_fkey",1);
    X_70 := sql.projectdelta(X_44,X_64,X_66,r1_74,X_69);
    X_73 := sql.bind(X_6,"sys","part","p_type",0);
    X_79 := sql.bind(X_6,"sys","part","p_size",0);
    X_71:bat[:oid,:oid]  := sql.tid(X_6,"sys","part");
    X_339 := algebra.subselect(X_79,X_71,A0,A0,true,true,false);
    (X_82,r1_95) := sql.bind(X_6,"sys","part","p_size",2);
    X_340 := algebra.subselect(r1_95,A0,A0,true,true,false);
    X_85 := sql.bind(X_6,"sys","part","p_size",1);
    X_341 := algebra.subselect(X_85,X_71,A0,A0,true,true,false);
    X_87 := sql.subdelta(X_339,X_71,X_82,X_340,X_341);
    X_342 := algebra.likesubselect(X_73,X_87,A1,"",false);
    (X_75,r1_84) := sql.bind(X_6,"sys","part","p_type",2);
    X_343 := algebra.likesubselect(r1_84,A1,"",false);
    X_77 := sql.bind(X_6,"sys","part","p_type",1);
    X_344 := algebra.likesubselect(X_77,X_87,A1,"",false);
    X_90 := sql.subdelta(X_342,X_87,X_75,X_343,X_344);
    X_91 := X_90;
    (X_92,r1_108) := algebra.join(X_70,X_91);
    X_95 := algebra.leftfetchjoin(X_92,X_54);
    (X_96,r1_122) := algebra.join(X_95,X_32);
    X_98 := algebra.leftfetchjoin(r1_122,X_40);
    X_99:bat[:oid,:oid]  := sql.tid(X_6,"sys","nation");
    (X_101,r1_134) := algebra.join(X_98,X_99);
    X_103 := sql.bind_idxbat(X_6,"sys","nation","nation_n_regionkey_fkey",0);
    (X_106,r1_139) := sql.bind_idxbat(X_6,"sys","nation","nation_n_regionkey_fkey",2);
    X_109 := sql.bind_idxbat(X_6,"sys","nation","nation_n_regionkey_fkey",1);
    X_111 := sql.projectdelta(X_99,X_103,X_106,r1_139,X_109);
    X_112 := algebra.leftfetchjoin(r1_134,X_111);
    X_116 := sql.bind(X_6,"sys","region","r_name",0);
    X_113:bat[:oid,:oid]  := sql.tid(X_6,"sys","region");
    X_345 := algebra.subselect(X_116,X_113,A2,A2,true,true,false);
    (X_118,r1_152) := sql.bind(X_6,"sys","region","r_name",2);
    X_346 := algebra.subselect(r1_152,A2,A2,true,true,false);
    X_120 := sql.bind(X_6,"sys","region","r_name",1);
    X_347 := algebra.subselect(X_120,X_113,A2,A2,true,true,false);
    X_121 := sql.subdelta(X_345,X_113,X_118,X_346,X_347);
    X_124 := X_121;
    (X_125,r1_162) := algebra.join(X_112,X_124);
    X_348 := algebra.leftfetchjoin(X_125,X_101);
    X_127 := sql.bind(X_6,"sys","part","p_partkey",0);
    (X_130,r1_167) := sql.bind(X_6,"sys","part","p_partkey",2);
    X_132 := sql.bind(X_6,"sys","part","p_partkey",1);
    X_133 := sql.projectdelta(X_90,X_127,X_130,r1_167,X_132);
    X_134:bat[:oid,:int]  := algebra.leftfetchjoinPath(X_348,X_96,r1_108,X_133);
    (X_135,r1_177) := algebra.join(X_63,X_134);
    X_137:bat[:oid,:oid]  := batcalc.identity(X_134);
    X_138 := algebra.leftfetchjoin(r1_177,X_137);
    (X_139,r1_183,r2_183) := group.subgroupdone(X_138);
    X_349 := algebra.leftfetchjoin(r1_183,r1_177);
    X_142 := sql.bind(X_6,"sys","partsupp","ps_supplycost",0);
    (X_147,r1_191) := sql.bind(X_6,"sys","partsupp","ps_supplycost",2);
    X_150 := sql.bind(X_6,"sys","partsupp","ps_supplycost",1);
    X_152 := sql.projectdelta(X_44,X_142,X_147,r1_191,X_150);
    X_154:bat[:oid,:lng]  := algebra.leftfetchjoinPath(X_135,r1_61,X_152);
    X_155:bat[:oid,:lng]  := aggr.submin(X_154,X_139,r1_183,true);
    X_153:bat[:oid,:lng]  := algebra.leftfetchjoinPath(X_349,X_125,X_101,X_96,X_92,X_152);
    X_157:bat[:oid,:bit]  := batcalc.==(X_153,X_155);
    X_158 := algebra.subselect(X_157,true,true,true,true,false);
    X_350 := algebra.leftfetchjoin(X_158,r1_183);
    r1_285:bat[:oid,:int]  := algebra.leftfetchjoinPath(X_350,r1_177,X_134);
    X_161 := sql.bind(X_6,"sys","supplier","s_name",0);
    (X_166,r1_227) := sql.bind(X_6,"sys","supplier","s_name",2);
    X_169 := sql.bind(X_6,"sys","supplier","s_name",1);
    X_171 := sql.projectdelta(X_32,X_161,X_166,r1_227,X_169);
    X_172:bat[:oid,:str]  := algebra.leftfetchjoinPath(X_350,r1_177,X_125,X_101,r1_122,X_171);
    X_173 := sql.bind(X_6,"sys","nation","n_name",0);
    (X_176,r1_243) := sql.bind(X_6,"sys","nation","n_name",2);
    X_178 := sql.bind(X_6,"sys","nation","n_name",1);
    X_179 := sql.projectdelta(X_99,X_173,X_176,r1_243,X_178);
    X_180:bat[:oid,:str]  := algebra.leftfetchjoinPath(X_350,r1_177,X_125,r1_134,X_179);
    X_181 := sql.bind(X_6,"sys","supplier","s_acctbal",0);
    (X_183,r1_255) := sql.bind(X_6,"sys","supplier","s_acctbal",2);
    X_187 := sql.bind(X_6,"sys","supplier","s_acctbal",1);
    X_188 := sql.projectdelta(X_32,X_181,X_183,r1_255,X_187);
    X_189:bat[:oid,:lng]  := algebra.leftfetchjoinPath(X_350,r1_177,X_125,X_101,r1_122,X_188);
    (X_190,r1_273) := pqueue.topn_min(X_189,100:wrd);
    (X_192,r1_277) := pqueue.topn_max(X_180,X_190,r1_273,100:wrd);
    (X_194,r1_281) := pqueue.topn_max(X_172,X_192,r1_277,100:wrd);
    X_196 := pqueue.topn_max(r1_285,X_194,r1_281,100:wrd);
    X_223 := sql.bind(X_6,"sys","part","p_mfgr",0);
    (X_228,r1_325) := sql.bind(X_6,"sys","part","p_mfgr",2);
    X_231 := sql.bind(X_6,"sys","part","p_mfgr",1);
    X_232 := sql.projectdelta(X_90,X_223,X_228,r1_325,X_231);
    X_197 := algebra.leftfetchjoin(X_196,r1_285);
    X_198 := algebra.leftfetchjoin(X_196,X_172);
    X_199 := algebra.leftfetchjoin(X_196,X_180);
    X_200 := algebra.leftfetchjoin(X_196,X_189);
    (X_201,r1_290,r2_290) := algebra.subsort(X_200,true,false);
    (X_206,r1_295,r2_295) := algebra.subsort(X_199,r1_290,r2_290,false,false);
    (X_209,r1_298,r2_298) := algebra.subsort(X_198,r1_295,r2_295,false,false);
    (X_212,r1_301,r2_301) := algebra.subsort(X_197,r1_298,r2_298,false,false);
    X_215 := algebra.leftfetchjoin(r1_301,X_200);
    X_218 := algebra.subslice(X_215,0:wrd,99:wrd);
    X_351 := algebra.leftfetchjoin(X_218,r1_301);
    X_233:bat[:oid,:str]  := algebra.leftfetchjoinPath(X_351,X_196,X_158,r1_183,r1_177,X_125,X_101,X_96,r1_108,X_232);
    X_234 := sql.bind(X_6,"sys","supplier","s_address",0);
    (X_237,r1_345) := sql.bind(X_6,"sys","supplier","s_address",2);
    X_239 := sql.bind(X_6,"sys","supplier","s_address",1);
    X_241 := sql.projectdelta(X_32,X_234,X_237,r1_345,X_239);
    X_242:bat[:oid,:str]  := algebra.leftfetchjoinPath(X_351,X_196,X_158,r1_183,r1_177,X_125,X_101,r1_122,X_241);
    X_243 := sql.bind(X_6,"sys","supplier","s_phone",0);
    (X_247,r1_364) := sql.bind(X_6,"sys","supplier","s_phone",2);
    X_250 := sql.bind(X_6,"sys","supplier","s_phone",1);
    X_251 := sql.projectdelta(X_32,X_243,X_247,r1_364,X_250);
    X_252:bat[:oid,:str]  := algebra.leftfetchjoinPath(X_351,X_196,X_158,r1_183,r1_177,X_125,X_101,r1_122,X_251);
    X_253 := sql.bind(X_6,"sys","supplier","s_comment",0);
    (X_256,r1_382) := sql.bind(X_6,"sys","supplier","s_comment",2);
    X_258 := sql.bind(X_6,"sys","supplier","s_comment",1);
    X_260 := sql.projectdelta(X_32,X_253,X_256,r1_382,X_258);
    X_261:bat[:oid,:str]  := algebra.leftfetchjoinPath(X_351,X_196,X_158,r1_183,r1_177,X_125,X_101,r1_122,X_260);
    X_219 := algebra.leftfetchjoin(X_218,X_215);
    X_222:bat[:oid,:int]  := algebra.leftfetchjoin(X_351,X_197);
    X_221:bat[:oid,:str]  := algebra.leftfetchjoin(X_351,X_199);
    X_220:bat[:oid,:str]  := algebra.leftfetchjoin(X_351,X_198);
    X_262 := sql.resultSet(8,1,X_219);
    sql.rsColumn(X_262,"sys.supplier","s_acctbal","decimal",15,2,X_219);
    sql.rsColumn(X_262,"sys.supplier","s_name","varchar",25,0,X_220);
    sql.rsColumn(X_262,"sys.nation","n_name","varchar",25,0,X_221);
    sql.rsColumn(X_262,"sys.part","p_partkey","int",32,0,X_222);
    sql.rsColumn(X_262,"sys.part","p_mfgr","varchar",25,0,X_233);
    sql.rsColumn(X_262,"sys.supplier","s_address","varchar",40,0,X_242);
    sql.rsColumn(X_262,"sys.supplier","s_phone","varchar",15,0,X_252);
    sql.rsColumn(X_262,"sys.supplier","s_comment","varchar",101,0,X_261);
    X_293 := io.stdout();
    sql.exportResult(X_293,X_262);
end s2_1;
# querylog.define("explain select\n\ts_acctbal,\n\ts_name,\n\tn_name,\n\tp_partkey,\n\tp_mfgr,\n\ts_address,\n\ts_phone,\n\ts_comment\nfrom\n\tpart,\n\tsupplier,\n\tpartsupp,\n\tnation,\n\tregion\nwhere\n\tp_partkey = ps_partkey\n\tand s_suppkey = ps_suppkey\n\tand p_size = 15\n\tand p_type like \\'%BRASS\\'\n\tand s_nationkey = n_nationkey\n\tand n_regionkey = r_regionkey\n\tand r_name = \\'EUROPE\\'\n\tand ps_supplycost = (\n\t\tselect\n\t\t\tmin(ps_supplycost)\n\t\tfrom\n\t\t\tpartsupp,\n\t\t\tsupplier,\n\t\t\tnation,\n\t\t\tregion\n\t\twhere\n\t\t\tp_partkey = ps_partkey\n\t\t\tand s_suppkey = ps_suppkey\n\t\t\tand s_nationkey = n_nationkey\n\t\t\tand n_regionkey = r_regionkey\n\t\t\tand r_name = \\'EUROPE\\'\n\t)\norder by\n\ts_acctbal desc,\n\tn_name,\n\ts_name,\n\tp_partkey\nlimit 100;","sequential_pipe")

# 22:53:25 >  
# 22:53:25 >  "Done."
# 22:53:25 >  

