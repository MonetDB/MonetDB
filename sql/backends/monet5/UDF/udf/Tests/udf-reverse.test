statement ok
set optimizer = 'sequential_pipe'

statement ok
create table udf_reverse ( x string )

statement ok
insert into udf_reverse values ('MonetDB')

statement ok
insert into udf_reverse values ('Database Architecture')

statement ok
insert into udf_reverse values ('Information Systems')

statement ok
insert into udf_reverse values ('Centrum Wiskunde & Informatica')

query T rowsort
select * from udf_reverse
----
Centrum Wiskunde & Informatica
Database Architecture
Information Systems
MonetDB

query T rowsort
trace
select reverse('MonetDB')
----
BDtenoM

query I rowsort
select count(*) from sys.tracelog() where stmt like '% batudf.reverse%'
----
0

query I rowsort
select count(*) from sys.tracelog() where stmt like '% udf.reverse%'
----
1

query T rowsort
select reverse('MonetDB')
----
BDtenoM

query T rowsort
trace
select reverse(x) from udf_reverse
----
BDtenoM
acitamrofnI & ednuksiW murtneC
erutcetihcrA esabataD
smetsyS noitamrofnI

query I rowsort
select count(*) from sys.tracelog() where stmt like '% batudf.reverse%'
----
1

query I rowsort
select count(*) from sys.tracelog() where stmt like '% udf.reverse%'
----
0

query T rowsort
select reverse(x) from udf_reverse
----
BDtenoM
acitamrofnI & ednuksiW murtneC
erutcetihcrA esabataD
smetsyS noitamrofnI

statement ok
drop table udf_reverse

statement ok
set optimizer = 'default_pipe'

