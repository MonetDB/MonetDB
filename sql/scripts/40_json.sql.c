/*
* This Source Code Form is subject to the terms of the Mozilla Public
* License, v. 2.0.  If a copy of the MPL was not distributed with this
* file, You can obtain one at http://mozilla.org/MPL/2.0/.
*
* Copyright 1997 - July 2008 CWI, August 2008 - 2019 MonetDB B.V.
*/

// This file was generated automatically through bootstrap.py.
// Do not edit this file directly.

#include "monetdb_config.h"

#include "40_json.sql.h"
#include "gdk.h"
#include "mal_client.h"
#include "sql_catalog.h"

#include <assert.h>

extern str SQLstatementIntern(Client c, str *expr, str nme, bit execute, bit output, res_table **result);

str
sql_install_40_json(Client c)
{
	size_t bufsize = 16384, pos = 0;
	char *buf = GDKmalloc(bufsize), *err = NULL;

	if (buf == NULL)
		throw(SQL, "sql.install_40_json", SQLSTATE(HY001) MAL_MALLOC_FAIL);
	pos += snprintf(buf + pos, bufsize - pos, "  create schema json; create type json external name json; create function json.filter(js json, pathexpr string) returns json external name json.filter; GRANT EXECUTE ON FUNCTION json.filter(json, string) TO PUBLIC; create function json.filter(js json, name tinyint) returns json external name json.filter; GRANT EXECUTE ON FUNCTION json.filter(json, tinyint) TO PUBLIC; create function json.filter(js json, name integer) returns json external name json.filter; GRANT EXECUTE ON FUNCTION json.filter(json, integer) TO PUBLIC; create function json.filter(js json, name bigint) returns json external name json.filter; GRANT EXECUTE ON FUNCTION json.filter(json, bigint) TO PUBLIC; create function json.text(js json, e string) returns string external name json.text; GRANT EXECUTE ON FUNCTION json.text(json, string) TO PUBLIC; create function json.number(js json) returns float external name json.number; GRANT EXECUTE ON FUNCTION json.number(json) TO PUBLIC; create function json.\"integer\"(js json) returns bigint external name json.\"integer\"; GRANT EXECUTE ON FUNCTION json.\"integer\"(json) TO PUBLIC; create function json.isvalid(js string) returns bool external name json.isvalid; GRANT EXECUTE ON FUNCTION json.isvalid(string) TO PUBLIC; create function json.isobject(js string) returns bool external name json.isobject; GRANT EXECUTE ON FUNCTION json.isobject(string) TO PUBLIC; create function json.isarray(js string) returns bool external name json.isarray; GRANT EXECUTE ON FUNCTION json.isarray(string) TO PUBLIC; create function json.isvalid(js json) returns bool external name json.isvalid; GRANT EXECUTE ON FUNCTION json.isvalid(json) TO PUBLIC; create function json.isobject(js json) returns bool external name json.isobject; GRANT EXECUTE ON FUNCTION json.isobject(json) TO PUBLIC; create function json.isarray(js json) returns bool external name json.isarray; GRANT EXECUTE ON FUNCTION json.isarray(json) TO PUBLIC; create function json.length(js json) returns integer external name json.length; GRANT EXECUTE ON FUNCTION json.length(json) TO PUBLIC; create function json.keyarray(js json) returns json external name json.keyarray; GRANT EXECUTE ON FUNCTION json.keyarray(json) TO PUBLIC; create function json.valuearray(js json) returns json external name json.valuearray; GRANT EXECUTE ON FUNCTION json.valuearray(json) TO PUBLIC; create function json.text(js json) returns string external name json.text; GRANT EXECUTE ON FUNCTION json.text(json) TO PUBLIC; create function json.text(js string) returns string external name json.text; GRANT EXECUTE ON FUNCTION json.text(string) TO PUBLIC; create function json.text(js int) returns string external name json.text; GRANT EXECUTE ON FUNCTION json.text(int) TO PUBLIC;  create aggregate json.output(js json) returns string external name json.output; GRANT EXECUTE ON AGGREGATE json.output(json) TO PUBLIC;        create aggregate json.tojsonarray( x string ) returns string external name aggr.jsonaggr; GRANT EXECUTE ON AGGREGATE json.tojsonarray( string ) TO PUBLIC; create aggregate json.tojsonarray( x double ) returns string external name aggr.jsonaggr; GRANT EXECUTE ON AGGREGATE json.tojsonarray( double ) TO PUBLIC;");

	pos += snprintf(buf + pos, bufsize - pos, "commit;\n");

	assert(pos < bufsize);
	printf("#Loading: 40_json.sql\n");
	err = SQLstatementIntern(c, &buf, "install", 1, 0, NULL);
	GDKfree(buf);
	return err;
}
