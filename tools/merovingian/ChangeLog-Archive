# DO NOT EDIT THIS FILE -- MAINTAINED AUTOMATICALLY
# This file contains past ChangeLog entries

* Fri Jul 14 2017 Sjoerd Mullender <sjoerd@acm.org> - 11.27.3-20170725
- monetdbd was leaking open file descriptors to the mserver5 process
  it started.  This has been fixed.

* Thu May 11 2017 Panagiotis Koutsourakis <kutsurak@monetdbsolutions.com> - 11.27.1-20170705
- Added handling of a dbextra property per database at the daemon
  level. The user can set the dbextra property for a database using the
  command:  $ monetdb set dbextra=<path> <database> and the daemon will
  make sure to start the new server using the correct
  --dbextra parameter.

* Sun Feb 16 2014 Fabian Groffen <fabian@monetdb.org> - 11.19.1-20141024
- monetdb create: add -p flag to set monetdb user password on creation,
  and therefore allow creating the database in unlocked state

* Sun Feb 16 2014 Fabian Groffen <fabian@monetdb.org> - 11.17.11-20140303
- monetdb destroy -f now also works on running databases

* Fri Nov 15 2013 Fabian Groffen <fabian@monetdb.org> - 11.15.19-20131120
- monetdbd(1) now refuses to startup if it cannot read the properties
  from the dbfarm, bug #3398

* Tue Jul 30 2013 Fabian Groffen <fabian@monetdb.org> - 11.15.13-20130920
- monetdb now no longer compresses output when not connected to a terminal,
  bug #3292

* Sat Dec  1 2012 Fabian Groffen <fabian@monetdb.org> - 11.15.1-20130212
- Upgrade support for dbfarms from Mar2011 and Aug2011 was dropped

* Fri Nov 30 2012 Fabian Groffen <fabian@monetdb.org> - 11.15.1-20130212
- monetdb status now uses a more condensed output, to cater for the uris
  being shown, and prints how long a database is stopped, or how long
  ago it crashed

* Wed Nov 21 2012 Fabian Groffen <fabian@monetdb.org> - 11.15.1-20130212
- monetdb status now prints the connection uri for each database,
  when available.  The connections and database path properties have
  been dropped.

* Tue Nov 20 2012 Fabian Groffen <fabian@cwi.nl> - 11.15.1-20130212
- monetdb status now prints last crash date only if the database has
  not been started since.

* Tue Oct  9 2012 Fabian Groffen <fabian@cwi.nl> - 11.13.1-20121010
- Fixed problem where monetdbd would refuse to startup when discovery
  was set to false, bug #3155

* Fri Aug 31 2012 Fabian Groffen <fabian@cwi.nl> - 11.11.9-20120911
- Resolved a problem where monetdb could fail to start a database with
  the message "database 'X' started up, but failed to open up a
  communication channel".  Bug #3134, comment #7.

* Thu Aug  2 2012 Fabian Groffen <fabian@cwi.nl> - 11.11.7-20120813
- Starting a server now waits for as long as the server needs to possibly
  recover, bug #3134.  In case of a long wait, the monetdbd logfile
  gives extra information on what the server is doing to recover.
- Fixed a crash of monetdbd when local databases were unshared, bug #3135

* Wed Jul 18 2012 Fabian Groffen <fabian@cwi.nl> - 11.11.7-20120813
- Resolved a problem where automatic starting of a database initiated by
  multiple clients at the same time could cause failed starts.  Bug #3107

* Sat Jul  7 2012 Fabian Groffen <fabian@cwi.nl> - 11.11.3-20120709
- Fixed misc memory leaks, which caused monetdbd to grow in memory size
  over time.

* Wed Jun 13 2012 Fabian Groffen <fabian@cwi.nl> - 11.11.1-20120706
- Removed erroneously (re-)added master and slave properties, this
  functionality is currently not working.

* Tue May 15 2012 Fabian Groffen <fabian@cwi.nl> - 11.9.5-20120516
- Fixed a bug where connecting to a stopped multiplex-funnel would result
  in a 'there are no available connections' error.

* Fri Mar  9 2012 Fabian Groffen <fabian@cwi.nl> - 11.9.1-20120418
- The logfile and pidfile monetdbd properties are now displayed with
  dbfarm path when relative

* Fri Feb 17 2012 Fabian Groffen <fabian@cwi.nl> - 11.7.7-20120224
- Fixed a bug in the multiplex-funnel where certain clients would abort
  on responses for update queries.

* Mon Jan 30 2012 Fabian Groffen <fabian@cwi.nl> - 11.7.7-20120224
- Fixed problem where version and mserver properties for monetdbd were
  not always successfully retrieved.  Bug #2982.
- Fixed problem where shutdown of monetdbd would lead to shutting down
  database 'control' which does not exist.  Bug #2983.
- Fixed issue causing (harmless) 'error reading from control channel'
  messages.  Bug #2984.
- Resolved problem where remote start/stop/etc. commands with monetdb
  would report error 'OK'.  Bug #2984.

* Tue Dec 27 2011 Fabian Groffen <fabian@cwi.nl> - 11.7.1-20120111
- Fixed crash in monetdb when an invalid property was retrieved using
  the get command, bug #2953.

* Sat Oct  8 2011 Fabian Groffen <fabian@cwi.nl> - 11.7.1-20120111
- monetdb get output is now grouped by database instead of by property

* Fri Oct  7 2011 Fabian Groffen <fabian@cwi.nl> - 11.7.1-20120111
- Unlike in previous releases, 'monetdbd get mserver' now returns the path
  to the mserver5 binary only for dbfarms that have a running monetdbd,
  instead of only for those that are not served by a monetdbd.

* Fri Sep 23 2011 Fabian Groffen <fabian@cwi.nl> - 11.7.1-20120111
- Add nclients property that controls the maximum number of concurrent
  clients allowed to access the database

* Wed Aug 31 2011 Fabian Groffen <fabian@cwi.nl> - 11.7.1-20120111
- Starting monetdbd without any arguments or without dbfarm is no longer
  supported.  A dbfarm now must be provided for each command.
- The control passphrase has been turned into a hash of the password, for
  a more stronger authorisation model as used by mclients.  On upgrade,
  any existing passphrase is converted to the hashed version of the
  passphrase.
- The monetdbd controlport option has been removed in favour of a
  boolean control option.  On upgrade, when controlport was set to
  a non-zero value and a passphrase was set, control is set to true,
  or false otherwise.

* Fri Aug 19 2011 Fabian Groffen <fabian@cwi.nl> - 11.7.1-20120111
- The monetdbd discoveryport option has been removed in favour of a
  boolean discovery option.  On upgrade, when discoveryport was set to
  a non-zero value, discovery is set to true, or false otherwise.

* Sun Nov  6 2011 Fabian Groffen <fabian@cwi.nl> - 11.5.9-20111115
- Fixed a bug where monetdbd's socket files from /tmp were removed when
  a second monetdbd was attempted to be started using the same port.

* Sun Oct  9 2011 Fabian Groffen <fabian@cwi.nl> - 11.5.5-20111018
- Resolved problem where monetdbd would terminate abnormally when
  databases named 'control', 'discovery' or 'merovingian' were stopped.

* Fri Oct  7 2011 Fabian Groffen <fabian@cwi.nl> - 11.5.5-20111018
- monetdbd get status now also reports the version of the running monetdbd

* Thu Oct  6 2011 Fabian Groffen <fabian@cwi.nl> - 11.5.5-20111018
- Improved response time of 'monetdb start' when the database fails
  to start.

* Wed Oct  5 2011 Fabian Groffen <fabian@cwi.nl> - 11.5.5-20111018
- Fixed a bug in monetdbd where starting a failing database could
  incorrectly be reported as a 'running but dead' database.

* Fri Sep 30 2011 Fabian Groffen <fabian@cwi.nl> - 11.5.5-20111018
- To avoid confusion, all occurrences of merovingian were changed into
  monetdbd for error messages sent to a client.

* Tue Aug 23 2011 Fabian Groffen <fabian@cwi.nl> - 11.5.1-20110907
- Fixed confusing 'Success' error message for monetdb commands where an
  invalid hostname was given

* Fri Aug 19 2011 Fabian Groffen <fabian@cwi.nl> - 11.5.1-20110907
- The path to the mserver5 binary is no longer returned for the mserver
  property with monetdbd get for a dbfarm which is currently served by
  a monetdbd.  Since the called monetdbd needs not to be the same as
  the running monetdbd, the reported mserver5 binary may be incorrect,
  and obviously lead to confusing situations.  Refer to the running
  monetdbd's logfile to determine the mserver5 binary location instead.

* Wed Aug 17 2011 Fabian Groffen <fabian@cwi.nl> - 11.5.1-20110907
- Added -n option to monetdbd start command, which prevents monetdbd
  from forking into the background.

* Sat Aug  6 2011 Fabian Groffen <fabian@cwi.nl> - 11.5.1-20110907
- Fix incorrect (misleading) path for pidfile in pidfile error message,
  bug #2851

* Fri Apr 29 2011 Fabian Groffen <fabian@cwi.nl> - 11.5.1-20110907
- added status property to get command

* Mon Apr 18 2011 Fabian Groffen <fabian@cwi.nl> - 11.3.1-20110421
- Fix monetdb return code upon failure to start/stop a database

* Wed Feb 16 2011 Fabian Groffen <fabian@cwi.nl> - 11.3.1-20110414
- The forward property for databases has been removed.  Instead, only
  a global proxy or redirect mode can be set using monetdbd.

* Tue Feb 15 2011 Fabian Groffen <fabian@cwi.nl> - 11.3.1-20110414
- monetdbd can no longer log error and normal messages to separate
  logfiles, logging to stdout and stderr is no longer possible either.
- The .merovingian_pass file is no longer in use, and replaced by the
  .merovingian_properties file.  Use monetdbd (get|set) passphrase to
  view/edit the control passphrase.  Existing .merovingian_pass files
  will automatically be migrated upon startup of monetdbd.
- monetdbd now understands commands that allow to create, start, stop,
  get and set properties on a given dbfarm.  This behaviour is intended
  as primary way to start a MonetDB Database Server, on a given location
  of choice.  monetdbd get and set are the replacement of editing the
  monetdb5.conf file (which is no longer in use as of the Apr2011
  release).  See monetdbd(1).

* Mon Dec 20 2010 Fabian Groffen <fabian@cwi.nl> - 11.1.1-20110317
- Allow use of globs with all commands that accept database names as
  their parameters

* Mon Sep 20 2010 Fabian Groffen <fabian@cwi.nl> - 11.1.1-20110317
- merovingian has been renamed into monetdbd.  Internally, monetdbd keeps
  referring to merovingian for e.g. settings and logfiles.  Merovingian
  has been renamed to make the process more recognisable as part of the
  MonetDB suite.

* Wed Nov 17 2010 Sjoerd Mullender <sjoerd@acm.org> - 2.40.3-20101215
- Fixed off-by-one error when abbreviating long database names in the
  monetdb status command.

* Thu Oct 21 2010 Fabian Groffen <fabian@cwi.nl> - 2.40.1-20101029
- Report a stopped and locked database as under maintenance, instead of
  without connections, bug #2685

* Fri Jul 16 2010 Arjen de Rijke <arjen.de.rijke@cwi.nl> - 2.40.1-20101029
- Add readonly property for databases to monetdb and merovingian.

* Mon Jul 26 2010 Fabian Groffen <fabian@cwi.nl> - 2.38.5-20100823
- On installs with (very) long prefixes, the UNIX domain sockets could get
  truncated, causing merovingian to become unavailable to monetdb and mclient.
  Similarly, a fall back to a regular TCP socket for mapi connections is
  used for forked mservers in this case.

* Wed Jul 21 2010 Fabian Groffen <fabian@cwi.nl> - 2.38.5-20100823
- Really shutdown when an argument to merovingian was given, instead of
  ending up in some inconsistent state.  This solves all weird behaviour
  observed in bug #2628.
- Report MonetDB release on --version flags and in the logs.

* Fri Jul 16 2010 Fabian Groffen <fabian@cwi.nl> - 2.38.5-20100823
- Remove references to master/slave settings, since replication isn't yet
  fully implemented in Jun2010 branch.

* Thu Jul 01 2010 Fabian Groffen <fabian@cwi.nl> - Jun2010-SP1
- When a startup failure causes a shutdown, make sure we log this
  incident in the logfile, together with a message that the deamon was
  shut down due to this fatal condition.

* Tue Jun 01 2010 Fabian Groffen <fabian@cwi.nl> - Jun2010
- Fixed an issue where Merovingian's strict umask was applied too early
  causing files to be inaccessible.  Now the .merovingian_control socket
  file is accessible to both user and group of the merovingian process,
  and the .mapi_socket file is accessible to everyone like a TCP socket
  is.  Fixes bug #2550.

* Tue Jun 01 2010 Fabian Groffen <fabian@cwi.nl> - Jun2010
- Properly clean up .merovingian_control file in dbfarm.

* Tue Jun 01 2010 Fabian Groffen <fabian@cwi.nl> - Jun2010
- Removed database pre-starting (mis-)feature, any argument to
  merovingian now yields in a version message followed by a server exit.

* Wed Apr 07 2010 Fabian Groffen <fabian@cwi.nl> - Feb2010-SP2
- Fix logic in buffer enlargments, causing bug #2982104.  These bug
  became visible when receiving more data from merovingian(1) than would
  fit in the originally allocated buffers.  This could happen quite
  easily for instance with `monetdb status` when there are many
  databases.

* Wed Apr 07 2010 Fabian Groffen <fabian@cwi.nl> - Jun2010
- Sort output returned by discover, status and get commands based on url
  or dbname.

* Mon Mar 29 2010 Fabian Groffen <fabian@cwi.nl> - Feb2010-SP2
- Fixed an issue where merovingian(1) would lock up or crash when
  destroying a database failed.

* Wed Mar 24 2010 Fabian Groffen <fabian@cwi.nl> - Jun2010
- Implemented UNIX domain socket listener for Merovingian, found as
  mapi_socket in the dbfarm.  Client connections can be made over it
  like normal TCP connections.

* Wed Mar 17 2010 Fabian Groffen <fabian@cwi.nl> - Jun2010
- When a proxy connection is made to a local UNIX domain socket, pass
  on the filedescriptor instead of proxying.

* Tue Mar 16 2010 Fabian Groffen <fabian@cwi.nl> - Feb2010-SP1
- Enlarged buffer to avoid incomplete output being sent to monetdb(1),
  causing commands like status and get to fail on certain
  configurations.

* Tue Mar 16 2010 Fabian Groffen <fabian@cwi.nl> - Jun2010
- Use mserver5's UNIX domain socket support when Merovingian is supposed
  to proxy the connection to the database.

* Fri Mar 05 2010 Fabian Groffen <fabian@cwi.nl> - Feb2010-SP1
- Avoid running over the allocated buffer space resulting in crashes
  when a client connects which IP address cannot be resolved into a
  hostname, bug #2964247

* Thu Jan 21 2010 Fabian Groffen <fabian@cwi.nl> - Nov2009-SP2
- Changed wording of monetdb status -l for last crash to indicate the time
  reported is not the crash time, but the time the server was started which
  eventually crashed, bug #2900355

* Wed Jan 13 2010 Fabian Groffen <fabian@cwi.nl> - Nov2009-SP2
- Strip trailing newlines from the control channel password, bug #2931392

* Fri Dec 11 2009 Fabian Groffen <fabian@cwi.nl> - Nov2009-SP1
- The master property of a database now contains an id that is used to
  identify the master to the slaves. The id can be given using monetdb set, or
  one is generated when no id is supplied (when just setting it to 'yes')

* Mon Oct 26 2009 Fabian Groffen <fabian@cwi.nl> - Nov2009
- Fix bug that caused monetdb status to list an incorrect uptime in
  cases where the uptime was longer than 7 days.

* Thu Oct 08 2009 Fabian Groffen <fabian@cwi.nl> - Nov2009
- Add optpipe setting to control the SQL optimiser pipeline, useful for
  experimentation per database

* Thu Oct 08 2009 Fabian Groffen <fabian@cwi.nl> - Nov2009
- Export the URI the database is reachable from remotely to the database via
  merovingian_uri GDKenvironment setting. This can be used by applications
  inside the database that need to give a pointer back to themselves.

* Wed Sep 30 2009 Fabian Groffen <fabian@cwi.nl> - Nov2009
- Add slave property for databases

* Fri Sep 25 2009 Fabian Groffen <fabian@cwi.nl> - Nov2009
- Implemented global -q option to monetdb to suppress status messages when
  performing commands, Feature Request #2855846.

* Fri Sep 25 2009 Fabian Groffen <fabian@cwi.nl> - Nov2009
- Improved globbing to support escapes, such that the literal asterisk symbol
  can be matched using \*

* Fri Sep 25 2009 Fabian Groffen <fabian@cwi.nl> - Nov2009
- Remote controllable merovingians now announce their controlport. These
  control entries show up in monetdb discover output marked with an asterisk.

* Wed Sep 23 2009 Fabian Groffen <fabian@cwi.nl> - Nov2009
- Implemented Feature Request #2830754. monetdb can now control a remote
  merovingian using the -h -p and -P global options to monetdb. The password
  used is stored at the merovingian site in the .merovingian_pass file in the
  controlled dbfarm.

* Fri Sep 18 2009 Fabian Groffen <fabian@cwi.nl> - Nov2009
- monetdb now requires merovingian to be running to perform any
  operation

* Wed Sep 09 2009 Fabian Groffen <fabian@cwi.nl> - Nov2009
- No longer announce databases that are under maintenance, this allows them to
  be pulled out of the cluster easily

* Fri Sep 04 2009 Fabian Groffen <fabian@cwi.nl> - Nov2009
- Add master property of boolean value that translates into
  replication_master for mserver5 to trigger storing replication logs

* Tue Aug 25 2009 Fabian Groffen <fabian@cwi.nl> - Aug2009-SP1
- Properly recognise mero_port option from config file, bug #2844202

* Thu Aug 20 2009 Fabian Groffen <fabian@cwi.nl> - Nov2009
- Always put created databases under maintenance, they have to be explicitly
  released after creating and performing the initialisation steps by the DBA

* Fri Jul 31 2009 Fabian Groffen <fabian@cwi.nl> - Aug2009
- monetdb destroy now allows to remove a database under maintenance. This way
  an administrator can prevent users connecting to the database and hence
  starting it on demand, which in turn prevents removal of the database.

* Tue Jul 21 2009 Fabian Groffen <fabian@cwi.nl> - Aug2009
- Implemented sharing of databases with tags. Using these tags, extra
  information is available on a remote merovingian to select a database during
  connect. For this, a client can now connect to a database using a glob
  expression, which is matched on the database plus tag.  When multiple
  databases match such expression, a load-balancing technique is
  applied.

* Thu Jul 02 2009 Fabian Groffen <fabian@cwi.nl> - Aug2009
- Allow expression matches for 'monetdb status' command.

* Wed Jul 01 2009 Fabian Groffen <fabian@cwi.nl> - Aug2009
- Allow an expression to be used to match against the list of discovered
  databases for future convenience.

* Fri Jun 19 2009 Fabian Groffen <fabian@cwi.nl> - Aug2009
- Allow setting the name of a database (a.k.a. renaming it), doing all the
  logic to keep the logdir aligned in case it's absolute.

* Fri Jun 19 2009 Fabian Groffen <fabian@cwi.nl> - Aug2009
- Increase the default mero_exittimeout from 7 to 60 seconds.

* Fri Jun 19 2009 Fabian Groffen <fabian@cwi.nl> - Aug2009
- Restrict database names created by monetdb to the pattern [A-Za-z0-9-_]+.

* Wed Jun 17 2009 Fabian Groffen <fabian@cwi.nl> - Aug2009
- Implemented full per-database property support.  monetdb now can
  manage the following per-database properties: logdir, forward, shared,
  nthreads.  Feature Request #1837591.

* Tue Jun 16 2009 Fabian Groffen <fabian@cwi.nl> - Aug2009
- Fixed bug where destroying multiple databases without -f would abort after
  the first database.

* Mon Jun 08 2009 Fabian Groffen <fabian@cwi.nl> - Aug2009
- Avoid multiple questions by merging them into a single confirmation for the
  destroy command.  This accidently fixes a bug where a response such as 'yes'
  would abort the next database removal.

* Thu Jun 04 2009 Fabian Groffen <fabian@cwi.nl> - Aug2009
- Implemented a configurable port for the neighbour discovery service. This
  also allows to entirely disable neighbour discovery by setting
  mero_discoveryport to 0.  Feature request #2800964

* Tue Jun 02 2009 Fabian Groffen <fabian@cwi.nl> - Aug2009
- Implemented dynamic width of monetdb status output. If a database name is
  wider than 14 chars, the name column is made wider as long as the
  terminal window allows.  If a column cannot be made any wider this
  way, it is abbreviated as before.

* Fri May 15 2009 Fabian Groffen <fabian@cwi.nl> - May2009
- Implemented Feature Request #2705670.  Reopen logfiles when SIGHUP is
  received.

* Wed May 13 2009 Fabian Groffen <fabian@cwi.nl> - May2009
- Implemented Feature Request #2782776. All logged messages are now prefixed
  with a timestamp.

* Tue Apr 21 2009 Fabian Groffen <fabian@cwi.nl> - Feb2009-SP2
- Instead of sending SIGTERM and immediately returning, call the
  terminateProcess function such that we nicely wait for the process to have
  died, and eventually send a SIGKILL if that fails. Fixes bug #2747661

* Mon Mar 30 2009 Sjoerd Mullender <sjoerd@cwi.nl> - Feb2009-SP2
- If the logdir argument to logger_create is a relative path name, the
  logdir will be located inside the dbfarm/dbname directory.  If it is
  an absolute path name, that path is used.  Fixed monetdb destroy with
  regard to this new behaviour.

* Mon Mar 23 2009 Fabian Groffen <fabian@cwi.nl> - Feb2009-SP1
- Remove the pid file upon shutdown, fixes bug #2705666

* Mon Mar 02 2009 Fabian Groffen <fabian@cwi.nl> - Feb2009-SP1
- Small cosmetic fix not to overflow the uptime in monetdb status display

* Mon Feb 23 2009 Fabian Groffen <fabian@cwi.nl> - Feb2009-SP1
- Fix hang on Linux when shutting down. select() calls are not interrupted on
  Linux, so make sure they time out. Fixes bug #2623838

* Thu Feb 19 2009 Fabian Groffen <fabian@cwi.nl> - Feb2009-SP1
- Fixed crash of merovingian when a to be started database terminates
  immediately after startup (such as when it crashes)

* Mon Feb 16 2009 Fabian Groffen <fabian@cwi.nl> - Feb2009-SP1
- Fixed crash when using monetdb stop on a non-started database.  Bug #2605105

* Mon Feb 16 2009 Fabian Groffen <fabian@cwi.nl> - Feb2009-SP1
- Protect shared linked list structures from being accessed and/or modified by
  two or more threads concurrently. This resolves random crashes. Fixes bug

* Mon Feb 02 2009 Fabian Groffen <fabian@cwi.nl> - Feb2009-SP1
- Create logfiles when they do not exist.  Bug #2556973

* Sun Dec 28 2008 Fabian Groffen <fabian@cwi.nl> - Feb2009
- Properly handle SIGHUP, such that merovingian does not silently terminate

* Sun Dec 28 2008 Fabian Groffen <fabian@cwi.nl> - Feb2009
- Switched internally to select() calls instead of non-blocking IO loops. This
  reduces the CPU usage in idlestate considerably.

* Mon Dec 08 2008 Fabian Groffen <fabian@cwi.nl> - Feb2009
- Fix manpage header

